{
  "version": 3,
  "sources": ["../../../src/pages/permissions/Permissions_Template.js", "../../../src/common/utilities.js", "../../../src/pages/permissions/permissions.js"],
  "sourcesContent": ["\uFEFFconst html = String.raw;\r\n\r\nexport const permissionsTemplate = html`\r\n  <link\r\n    rel=\"stylesheet\"\r\n    type=\"text/css\"\r\n    href=\"/sites/CGFS/Style Library/apps/audit/lib/jquery-ui-1.13.2/jquery-ui.theme.min.css\"\r\n  />\r\n  <link\r\n    rel=\"stylesheet\"\r\n    type=\"text/css\"\r\n    href=\"/sites/CGFS/Style Library/apps/audit/lib/tablesorter-2.31.3/css/theme.default.min.css\"\r\n  />\r\n\r\n  <div class=\"audit\">\r\n    <iframe id=\"CsvExpFrame\" style=\"display: none\"></iframe>\r\n\r\n    <div style=\"padding-bottom: 10px\">\r\n      <a\r\n        id=\"btnRefresh\"\r\n        title=\"Refresh this page\"\r\n        style=\"display: none\"\r\n        href=\"javascript:void(0)\"\r\n        onclick=\"Audit.Permissions.Report.Refresh()\"\r\n        ><span class=\"ui-icon ui-icon-refresh\"></span>Refresh</a\r\n      >\r\n    </div>\r\n\r\n    <div id=\"divLoading\" style=\"color: green; padding-bottom: 10px\">\r\n      Please Wait... Loading\r\n    </div>\r\n\r\n    <div id=\"divErrorMsg\" style=\"color: red; padding-bottom: 10px\"></div>\r\n\r\n    <div id=\"tabs\" style=\"display: none; margin-top: 20px\">\r\n      <ul>\r\n        <li><a href=\"#tabs-0\">Action Office Groups and Users</a></li>\r\n        <li><a href=\"#tabs-1\">Site Groups and Users</a></li>\r\n        <li style=\"display: none\"><a href=\"#tabs-2\">Request Permissions</a></li>\r\n        <li style=\"display: none\">\r\n          <a href=\"#tabs-3\">Response Permissions</a>\r\n        </li>\r\n        <li style=\"display: none\">\r\n          <a href=\"#tabs-4\">Response Folder Permissions</a>\r\n        </li>\r\n      </ul>\r\n\r\n      <div id=\"tabs-0\">\r\n        <fieldset style=\"width: 300px\">\r\n          <legend>Actions</legend>\r\n          <a\r\n            style=\"display: none\"\r\n            id=\"btnPrint\"\r\n            title=\"Click here to Print\"\r\n            href=\"javascript:void(0)\"\r\n            class=\"hideOnPrint\"\r\n            ><span class=\"ui-icon ui-icon-print\">Print</span></a\r\n          >\r\n          <a\r\n            style=\"display: none\"\r\n            class=\"export hideOnPrint\"\r\n            title=\"Export to CSV\"\r\n            href=\"#\"\r\n            ><span class=\"ui-icon ui-icon-disk\">Export to CSV</span></a\r\n          >\r\n\r\n          <div>\r\n            <a\r\n              id=\"linkGetVerification\"\r\n              title=\"Select Action Office(s) to Obtain Verification of User\"\r\n              disabled=\"disabled\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-gear\"></span>Obtain Action Office\r\n              Verification</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              id=\"linkEmailHistory\"\r\n              title=\"View Email History\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-search\"></span>View Email History</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              id=\"linkUploadPermissions\"\r\n              title=\"Import Users to SharePoint Groups\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-person\"></span>Import Users into\r\n              Groups</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              id=\"linkViewAO\"\r\n              title=\"View Action Offices\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-search\"></span>View Action Office\r\n              Details</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              title=\"Add Action Office\"\r\n              href=\"#\"\r\n              id=\"linkAddAO\"\r\n              title=\"Add Action Office\"\r\n              ><span class=\"ui-icon ui-icon-circle-plus\"></span>Add Action\r\n              Office</a\r\n            >\r\n          </div>\r\n        </fieldset>\r\n        <div id=\"divTblOutput\" style=\"width: 100%; padding-bottom: 10px\">\r\n          <table id=\"table_Groups\" class=\"tablesorter\">\r\n            <thead>\r\n              <tr>\r\n                <th class=\"removeOnExport\">\r\n                  <input\r\n                    class=\"cbAOAll\"\r\n                    id=\"cbAOAll\"\r\n                    type=\"checkbox\"\r\n                    style=\"cursor: pointer\"\r\n                  />\r\n                  Check All?\r\n                </th>\r\n                <th>Action Office</th>\r\n                <th>SharePoint Group Name</th>\r\n                <th>\r\n                  Users<a\r\n                    id=\"linkViewExportFriendly\"\r\n                    style=\"float: right\"\r\n                    title=\"View Export Friendly\"\r\n                    href=\"javascript:void(0)\"\r\n                    ><span class=\"ui-icon ui-icon-gear\"></span>View Export\r\n                    Friendly</a\r\n                  >\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody id=\"fbody\"></tbody>\r\n            <tfoot>\r\n              <tr>\r\n                <th colspan=\"4\" style=\"text-align: left; white-space: nowrap\">\r\n                  Total: <span id=\"spanTotalAOS\">0</span>\r\n                </th>\r\n              </tr>\r\n            </tfoot>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <div id=\"tabs-1\">\r\n        <div\r\n          id=\"divTblSiteUsersOutput\"\r\n          style=\"width: 100%; padding-bottom: 10px\"\r\n        >\r\n          <table id=\"table_SiteGroups\" class=\"tablesorter\">\r\n            <thead>\r\n              <tr>\r\n                <th>SharePoint Group Name</th>\r\n                <th>Users</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody id=\"fbodySPGroups\"></tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <div id=\"tabs-2\">\r\n        <table id=\"tblRequestsPermissions\" class=\"tablesorter\">\r\n          <thead>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                <select id=\"ddlRequestID\"></select>\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n            </tr>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Request Number</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Status</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Action Offices(s)</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Special Perms?</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Permissions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody></tbody>\r\n          <tfoot>\r\n            <tr valign=\"top\">\r\n              <th nowrap=\"nowrap\" colspan=\"5\">\r\n                Total: <span id=\"tblRequestsPermsTotal\">0</span>\r\n              </th>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n\r\n      <div id=\"tabs-3\" style=\"display: none\">\r\n        <table id=\"tblResponsePermissions\" class=\"tablesorter\">\r\n          <thead>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                <select id=\"ddlResponseRequestID\"></select>\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n            </tr>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Request Number</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Response ID</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Status</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Action Offices(s)\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Action Office\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Permissions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody></tbody>\r\n          <tfoot>\r\n            <tr valign=\"top\">\r\n              <th nowrap=\"nowrap\" colspan=\"8\">\r\n                Total: <span id=\"tblResponsePermsTotal\">0</span>\r\n              </th>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n\r\n      <div id=\"tabs-4\" style=\"display: none\">\r\n        <table id=\"tblResponseFolderPermissions\" class=\"tablesorter\">\r\n          <thead>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                <select id=\"ddlResponseFolderResponseID\"></select>\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n            </tr>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Request Number</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Response ID</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Folder Name</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Response Status</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Action Offices(s)\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Action Office\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Folder Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Permissions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody></tbody>\r\n          <tfoot>\r\n            <tr valign=\"top\">\r\n              <th nowrap=\"nowrap\" colspan=\"10\">\r\n                Total: <span id=\"tblResponseFolderPermsTotal\">0</span>\r\n              </th>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n`;\r\n", "\uFEFFwindow.Audit = window.Audit || {};\r\nAudit.Common = Audit.Common || {};\r\n\r\nfunction InitReport() {\r\n  Audit.Common.Utilities = new Audit.Common.NewUtilities();\r\n  Audit.Common.Init();\r\n}\r\n\r\nAudit.Common.Init = function () {};\r\n\r\nAudit.Common.NewUtilities = function () {\r\n  var m_siteUrl = _spPageContextInfo.webServerRelativeUrl; //IE11 in sp 2013 does not recognize L_Menu_BaseUrl\r\n\r\n  var m_listTitleRequests = \"AuditRequests\";\r\n  var m_listNameRequests = \"AuditRequests\";\r\n\r\n  var m_listTitleRequestsInternal = \"AuditRequestsInternal\";\r\n  var m_listNameRequestsInternal = \"AuditRequestsInternal\";\r\n\r\n  var m_listTitleResponses = \"AuditResponses\";\r\n  var m_listNameResponses = \"AuditResponses\";\r\n\r\n  var m_libTitleRequestDocs = \"AuditRequestDocs\";\r\n  var m_libNameRequestDocs = \"AuditRequestDocs\";\r\n\r\n  var m_libTitleCoverSheet = \"AuditCoverSheets\";\r\n  var m_libNameCoverSheet = \"AuditCoverSheets\";\r\n\r\n  var m_libTitleResponseDocs = \"AuditResponseDocs\";\r\n  var m_libNameResponseDocs = \"AuditResponseDocs\";\r\n\r\n  var m_libTitleResponseDocsEA = \"AuditResponseDocsEA\";\r\n  var m_libNameResponseDocsEA = \"AuditResponseDocsEA\";\r\n\r\n  var m_listTitleActionOffices = \"AuditOrganizations\";\r\n  var m_listNameActionOffices = \"AuditOrganizations\";\r\n\r\n  var m_listTitleEmailHistory = \"AuditEmails\";\r\n  var m_listNameEmailHistory = \"AuditEmails\";\r\n\r\n  var m_listTitleBulkResponses = \"AuditBulkResponses\";\r\n  var m_listNameBulkResponses = \"AuditBulkResponses\";\r\n\r\n  var m_listTitleBulkPermissions = \"AuditBulkPermissions\";\r\n  var m_listNameBulkPermissions = \"AuditBulkPermissions\";\r\n\r\n  var m_groupNameSpecialPermName1 = \"CGFS Special Access1\";\r\n  var m_groupNameSpecialPermName2 = \"CGFS Special Access2\";\r\n  var m_groupNameQA = \"Quality Assurance\";\r\n  var m_groupNameEA = \"External Auditors\";\r\n\r\n  var m_libResponseDocsLibraryGUID = null;\r\n\r\n  var m_arrSiteGroups = null;\r\n  var m_arrAOs = null;\r\n  /**\r\n   * Reloads the page, trys to preserve current path\r\n   * @param {bool} hard flag to remove all url params\r\n   * @returns\r\n   */\r\n  function m_fnRefresh(hard = false) {\r\n    if (hard) {\r\n      location.href = location.pathname;\r\n      return;\r\n    }\r\n    var curPath = location.pathname;\r\n\r\n    if ($(\"#tabs\").html() != null && $(\"#tabs\").html() != \"\") {\r\n      var tabIndex = 0;\r\n      try {\r\n        tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n      } catch (ex) {}\r\n\r\n      curPath += \"?Tab=\" + tabIndex;\r\n\r\n      if (tabIndex == 0 && $(\"#ddlResponseName\").val() != \"\") {\r\n        curPath += \"&ResNum=\" + $(\"#ddlResponseName\").val();\r\n      } else if (tabIndex == 1) {\r\n        var responseNumOpen = $(\"#ddlResponsesOpen\").val();\r\n        var responseNumProcessed = $(\"#ddlResponsesProcessed\").val();\r\n\r\n        if (responseNumOpen != null && responseNumOpen != \"\")\r\n          curPath += \"&ResNum=\" + responseNumOpen;\r\n        else if (responseNumProcessed != null && responseNumProcessed != \"\")\r\n          curPath += \"&ResNum=\" + responseNumProcessed;\r\n      }\r\n\r\n      location.href = curPath;\r\n    } else {\r\n      location.reload();\r\n    }\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTimeStamp() {\r\n    var curDate = new Date();\r\n    $(\"#divLoading\").text(\"Loaded at \" + curDate.format(\"MM/dd/yyyy hh:mm tt\"));\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTabAndResponse() {\r\n    var paramTabIndex = GetUrlKeyValue(\"Tab\");\r\n    if (paramTabIndex != null && paramTabIndex != \"\") {\r\n      $(\"#tabs\").tabs(\"option\", \"active\", paramTabIndex);\r\n    }\r\n\r\n    var bFiltered = false;\r\n\r\n    var paramResponseNum = GetUrlKeyValue(\"ResNum\");\r\n    if (paramResponseNum != null && paramResponseNum != \"\") {\r\n      if (paramTabIndex == 0) {\r\n        if (\r\n          $(\"#ddlResponseName option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponseName\").val(paramResponseNum).change();\r\n          bFiltered = true;\r\n        }\r\n      } else {\r\n        if (\r\n          $(\"#ddlResponsesOpen option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponsesOpen\").val(paramResponseNum).change();\r\n        } else if (\r\n          $(\"#ddlResponsesProcessed option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponsesProcessed\").val(paramResponseNum).change();\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!bFiltered) {\r\n      $(\".sr-response-item\").show(); //hiding rows by default\r\n    }\r\n  }\r\n\r\n  function m_fnOnLoadFilterResponses(responseStatus1, responseStatus2) {\r\n    var count = 0;\r\n    var cntOpen = 0;\r\n    var cntReOpened = 0;\r\n    var resStatus1 = 0;\r\n    var resStatus2 = 0;\r\n\r\n    var eacher = $(\".sr-response-item\");\r\n\r\n    eacher.each(function () {\r\n      var reqStatus = $.trim($(this).find(\".sr-response-requestStatus\").text());\r\n      var resStatus = $.trim($(this).find(\".sr-response-status\").text());\r\n\r\n      if (\r\n        (resStatus == responseStatus1 || resStatus == responseStatus2) &&\r\n        (reqStatus == \"Open\" || reqStatus == \"ReOpened\")\r\n      ) {\r\n        $(this).addClass(\"highlighted\");\r\n        count++;\r\n\r\n        if (resStatus == responseStatus1) resStatus1++;\r\n        else if (resStatus == responseStatus2) resStatus2++;\r\n\r\n        if (reqStatus == \"Open\") cntOpen++;\r\n        else if (reqStatus == \"ReOpened\") cntReOpened++;\r\n      }\r\n    });\r\n\r\n    if (count > 0) {\r\n      $(\"#lblStatusReportResponsesMsg\").html(\r\n        \"<span class='ui-icon ui-icon-alert'></span>There are \" +\r\n          count +\r\n          \" Responses pending your review\"\r\n      );\r\n\r\n      if (resStatus1 > 0 && resStatus2 == 0)\r\n        $(\"#ddlResponseStatus\").val(responseStatus1).change();\r\n      else if (resStatus2 > 0 && resStatus1 == 0)\r\n        $(\"#ddlResponseStatus\").val(responseStatus2).change();\r\n    } else\r\n      $(\"#lblStatusReportResponsesMsg\").html(\r\n        \"<span class='ui-icon ui-icon-circle-check'></span>There are 0 Responses pending your review\"\r\n      );\r\n  }\r\n\r\n  function m_fnLoadSiteGroups(itemColl) {\r\n    m_arrSiteGroups = new Array();\r\n\r\n    var listItemEnumerator = itemColl.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_id();\r\n      var loginName = oListItem.get_loginName();\r\n      var title = oListItem.get_title();\r\n\r\n      var groupObject = new Object();\r\n      groupObject[\"ID\"] = id;\r\n      groupObject[\"loginName\"] = loginName;\r\n      groupObject[\"title\"] = title;\r\n      groupObject[\"group\"] = oListItem;\r\n\r\n      m_arrSiteGroups.push(groupObject);\r\n    }\r\n  }\r\n\r\n  function m_fnGetSPSiteGroup(groupName) {\r\n    var userGroup = null;\r\n    if (m_arrSiteGroups != null) {\r\n      for (var x = 0; x < m_arrSiteGroups.length; x++) {\r\n        if (m_arrSiteGroups[x].title == groupName) {\r\n          userGroup = m_arrSiteGroups[x].group;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return userGroup;\r\n  }\r\n\r\n  function m_fnLoadActionOffices(itemColl) {\r\n    m_arrAOs = new Array();\r\n\r\n    var listItemEnumerator = itemColl.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var title = oListItem.get_item(\"Title\");\r\n      var userGroup = oListItem.get_item(\"UserGroup\");\r\n      if (userGroup != null) {\r\n        userGroup = userGroup.get_lookupValue();\r\n      } else userGroup = \"\";\r\n\r\n      var aoObject = new Object();\r\n      aoObject[\"ID\"] = id;\r\n      aoObject[\"title\"] = title;\r\n      aoObject[\"userGroup\"] = userGroup;\r\n\r\n      m_arrAOs.push(aoObject);\r\n    }\r\n  }\r\n\r\n  function m_fnGetAOSPGroupName(groupName) {\r\n    //finds the group name corresponding to the lookup field selected\r\n    var userGroup = null;\r\n    if (m_arrAOs != null) {\r\n      for (var x = 0; x < m_arrAOs.length; x++) {\r\n        var oGroup = m_arrAOs[x];\r\n        if (oGroup.title == groupName) {\r\n          userGroup = oGroup.userGroup;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return userGroup;\r\n  }\r\n\r\n  function m_fnCheckSPItemHasGroupPermission(item, groupName, permissionLevel) {\r\n    if (\r\n      item == null ||\r\n      groupName == \"\" ||\r\n      groupName == null ||\r\n      permissionLevel == null\r\n    )\r\n      return false;\r\n\r\n    var match = false;\r\n    var roleAssignments = item.get_roleAssignments();\r\n    if (roleAssignments == null) {\r\n      alert(\"Error retrieving role assignments\");\r\n      return false;\r\n    }\r\n\r\n    var rolesEnumerator = roleAssignments.getEnumerator();\r\n    while (rolesEnumerator.moveNext()) {\r\n      var role = rolesEnumerator.get_current();\r\n      if (role != null) {\r\n        var roleMember = role.get_member();\r\n        if (roleMember.isPropertyAvailable(\"Title\")) {\r\n          var memberTitleName = roleMember.get_title();\r\n\r\n          var roleDefs = role.get_roleDefinitionBindings();\r\n          if (roleDefs != null) {\r\n            var roleDefsEnumerator = roleDefs.getEnumerator();\r\n            while (roleDefsEnumerator.moveNext()) {\r\n              var rd = roleDefsEnumerator.get_current();\r\n              var rdName = rd.get_name();\r\n\r\n              if (\r\n                memberTitleName == groupName &&\r\n                rd.get_basePermissions().has(permissionLevel)\r\n              ) {\r\n                match = true;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return match;\r\n  }\r\n\r\n  function m_fnGoToResponse(responseTitle, isIA) {\r\n    if (!isIA) {\r\n      var bFound = false;\r\n      $(\"#ddlResponsesOpen > option\").each(function () {\r\n        if ($(this).text() == responseTitle) {\r\n          bFound = true;\r\n          notifyId = SP.UI.Notify.addNotification(\r\n            \"Displaying Response (\" + responseTitle + \")\",\r\n            false\r\n          );\r\n          $(\"#ddlResponsesOpen\").val(responseTitle).change();\r\n\r\n          return false;\r\n        }\r\n      });\r\n      if (!bFound) {\r\n        $(\"#ddlResponsesProcessed > option\").each(function () {\r\n          if ($(this).text() == responseTitle) {\r\n            bFound = true;\r\n            notifyId = SP.UI.Notify.addNotification(\r\n              \"Displaying Response (\" + responseTitle + \")\",\r\n              false\r\n            );\r\n            $(\"#ddlResponsesProcessed\").val(responseTitle).change();\r\n\r\n            return false;\r\n          }\r\n        });\r\n      }\r\n\r\n      $(\"#tabs\").tabs({ active: 1 });\r\n    }\r\n  }\r\n\r\n  function m_fnGetResponseDocStyleTag2(documentStatus) {\r\n    var styleTag = {};\r\n    if (documentStatus == \"Archived\")\r\n      styleTag = { \"background-color\": \"Gainsboro\" };\r\n    else if (documentStatus == \"Approved\")\r\n      styleTag = { \"background-color\": \"PaleGreen\" };\r\n    else if (documentStatus == \"Rejected\")\r\n      styleTag = { \"background-color\": \"LightSalmon\" };\r\n    else if (documentStatus == \"Sent to QA\")\r\n      styleTag = { \"background-color\": \"LightCyan\" };\r\n    else if (documentStatus == \"Submitted\")\r\n      styleTag = { \"background-color\": \"LemonChiffon\" };\r\n    else if (documentStatus == \"Marked for Deletion\")\r\n      styleTag = {\r\n        \"background-color\": \"Gainsboro\",\r\n        \"font-style\": \"italic\",\r\n      };\r\n    return styleTag;\r\n    //\t\t\tstyleTag = \" style='background-color:Gainsboro; font-style:italic' title='Marked for Deletion by the Action Office' \";\r\n  }\r\n\r\n  function m_fnGetResponseDocStyleTag(documentStatus) {\r\n    var styleTag = \"\";\r\n\r\n    if (documentStatus == \"Archived\")\r\n      styleTag = \" style='background-color:Gainsboro;' \";\r\n    else if (documentStatus == \"Approved\")\r\n      styleTag = \" style='background-color:PaleGreen;' \";\r\n    else if (documentStatus == \"Rejected\")\r\n      styleTag = \" style='background-color:LightSalmon;' \";\r\n    else if (documentStatus == \"Sent to QA\")\r\n      styleTag = \" style='background-color:LightCyan;' \";\r\n    else if (documentStatus == \"Submitted\")\r\n      styleTag = \" style='background-color:LemonChiffon;' \";\r\n    else if (documentStatus == \"Marked for Deletion\")\r\n      styleTag =\r\n        \" style='background-color:Gainsboro; font-style:italic' title='Marked for Deletion by the Action Office' \";\r\n\r\n    return styleTag;\r\n  }\r\n\r\n  function m_fnCheckIfEmailFolderExists(items, requestNumber) {\r\n    //Check if folder exists in email library\r\n    var bFolderExists = false;\r\n    var listItemEnumerator = items.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var folderItem = listItemEnumerator.get_current();\r\n      var itemName = folderItem.get_displayName();\r\n      if (itemName == requestNumber) {\r\n        var bFolderExists = true;\r\n        break;\r\n      }\r\n    }\r\n    return bFolderExists;\r\n  }\r\n\r\n  var m_cntAddToEmailFolder = 0;\r\n  var m_cntAddedToEmailFolder = 0;\r\n\r\n  function m_fnCreateEmailFolder(list, requestNumber, requestItem, OnComplete) {\r\n    m_cntAddToEmailFolder = 0;\r\n    m_cntAddedToEmailFolder = 0;\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var itemCreateInfo = new SP.ListItemCreationInformation();\r\n    itemCreateInfo.set_underlyingObjectType(SP.FileSystemObjectType.folder);\r\n    itemCreateInfo.set_leafName(requestNumber);\r\n    oNewEmailFolder = list.addItem(itemCreateInfo);\r\n    oNewEmailFolder.set_item(\"Title\", requestNumber);\r\n    oNewEmailFolder.update();\r\n\r\n    this.currentUser = web.get_currentUser();\r\n    this.ownerGroup = web.get_associatedOwnerGroup();\r\n    this.memberGroup = web.get_associatedMemberGroup();\r\n    this.visitorGroup = web.get_associatedVisitorGroup();\r\n\r\n    oNewEmailFolder.resetRoleInheritance();\r\n    oNewEmailFolder.breakRoleInheritance(false, false);\r\n\r\n    var roleDefBindingCollAdmin =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollAdmin.add(\r\n      web.get_roleDefinitions().getByType(SP.RoleType.administrator)\r\n    );\r\n\r\n    var roleDefBindingCollContribute =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollContribute.add(\r\n      web.get_roleDefinitions().getByType(SP.RoleType.contributor)\r\n    );\r\n\r\n    var roleDefBindingCollRestrictedRead =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollRestrictedRead.add(\r\n      web.get_roleDefinitions().getByName(\"Restricted Read\")\r\n    );\r\n\r\n    var roleDefBindingCollRestrictedContribute =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollRestrictedContribute.add(\r\n      web.get_roleDefinitions().getByName(\"Restricted Contribute\")\r\n    );\r\n\r\n    //add associated site groups\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(ownerGroup, roleDefBindingCollAdmin);\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(memberGroup, roleDefBindingCollContribute);\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(visitorGroup, roleDefBindingCollRestrictedRead);\r\n\r\n    var spGroupQA = Audit.Common.Utilities.GetSPSiteGroup(\r\n      Audit.Common.Utilities.GetGroupNameQA()\r\n    );\r\n    if (spGroupQA != null)\r\n      oNewEmailFolder\r\n        .get_roleAssignments()\r\n        .add(spGroupQA, roleDefBindingCollRestrictedContribute);\r\n\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .getByPrincipal(currentUser)\r\n      .deleteObject();\r\n\r\n    //Need to break up adding AOs because it exceeds the resource limit (request uses too many resources)\r\n    function onUpdatePermsSucceeded() {\r\n      if (this.requestItem) {\r\n        //this will be null when sending from permissions page\r\n        //add action offices\r\n        var arrActionOffice = this.requestItem.get_item(\"ActionOffice\");\r\n        if (arrActionOffice == null || arrActionOffice.length == 0) {\r\n          if (this.OnComplete) this.OnComplete(true);\r\n          return;\r\n        }\r\n\r\n        for (var x = 0; x < arrActionOffice.length; x++) {\r\n          var actionOfficeName = arrActionOffice[x].get_lookupValue();\r\n\r\n          var actionOfficeGroupName =\r\n            Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n          var actionOfficeGroup = Audit.Common.Utilities.GetSPSiteGroup(\r\n            actionOfficeGroupName\r\n          );\r\n\r\n          if (actionOfficeGroup != null) {\r\n            m_cntAddToEmailFolder++;\r\n\r\n            var currCtx2 = new SP.ClientContext.get_current();\r\n            var web2 = currCtx2.get_web();\r\n\r\n            var roleDefBindingCollRestrictedContribute =\r\n              SP.RoleDefinitionBindingCollection.newObject(currCtx2);\r\n            roleDefBindingCollRestrictedContribute.add(\r\n              web2.get_roleDefinitions().getByName(\"Restricted Contribute\")\r\n            );\r\n\r\n            this.oNewEmailFolder\r\n              .get_roleAssignments()\r\n              .add(actionOfficeGroup, roleDefBindingCollRestrictedContribute);\r\n\r\n            function onUpdateAOPermsSucceeded() {\r\n              m_cntAddedToEmailFolder++;\r\n              if (m_cntAddedToEmailFolder == m_cntAddToEmailFolder) {\r\n                if (this.OnComplete) this.OnComplete(true);\r\n              }\r\n            }\r\n            function onUpdateAOPermsFailed(sender, args) {\r\n              m_cntAddedToEmailFolder++;\r\n              if (m_cntAddedToEmailFolder == m_cntAddToEmailFolder) {\r\n                if (this.OnComplete) this.OnComplete(true);\r\n              }\r\n            }\r\n            var data = { OnComplete: this.OnComplete };\r\n            currCtx2.executeQueryAsync(\r\n              Function.createDelegate(data, onUpdateAOPermsSucceeded),\r\n              Function.createDelegate(data, onUpdateAOPermsFailed)\r\n            );\r\n          }\r\n        }\r\n      } else {\r\n        if (this.OnComplete) this.OnComplete(true);\r\n      }\r\n    }\r\n\r\n    function onUpdatePermsFailed(sender, args) {\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n    }\r\n\r\n    var data = {\r\n      /*item: oListItem, */ requestItem: requestItem,\r\n      oNewEmailFolder: oNewEmailFolder,\r\n      OnComplete: OnComplete,\r\n    };\r\n    currCtx.executeQueryAsync(\r\n      Function.createDelegate(data, onUpdatePermsSucceeded),\r\n      Function.createDelegate(data, onUpdatePermsFailed)\r\n    );\r\n  }\r\n\r\n  function m_fnSortResponseTitleNoCase(a, b) {\r\n    var aTitle = a;\r\n    var bTitle = b;\r\n    let newA, newB;\r\n\r\n    if (aTitle == null) aTitle = \"\";\r\n    if (bTitle == null) bTitle = \"\";\r\n\r\n    var aIndex = aTitle.lastIndexOf(\"-\");\r\n    if (aIndex >= 0) {\r\n      var subA = aTitle.substring(0, aIndex + 1);\r\n      var lastA = aTitle.replace(subA, \"\");\r\n      var intA = parseInt(lastA, 10);\r\n      var newIntA = Audit.Common.Utilities.PadDigits(intA, 5);\r\n      newA = subA + newIntA;\r\n    } else newA = aTitle;\r\n\r\n    var bIndex = bTitle.lastIndexOf(\"-\");\r\n    if (bIndex >= 0) {\r\n      var subB = bTitle.substring(0, bIndex + 1);\r\n      var lastB = bTitle.replace(subB, \"\");\r\n      var intB = parseInt(lastB, 10);\r\n      var newIntB = Audit.Common.Utilities.PadDigits(intB, 5);\r\n      newB = subB + newIntB;\r\n    } else newB = bTitle;\r\n\r\n    return newA.toLowerCase().localeCompare(newB.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortResponseObjectNoCase(a, b) {\r\n    var aTitle = a.title;\r\n    var bTitle = b.title;\r\n    var newA;\r\n    var newB;\r\n    if (aTitle == null) aTitle = \"\";\r\n    if (bTitle == null) bTitle = \"\";\r\n\r\n    var aIndex = aTitle.lastIndexOf(\"-\");\r\n    if (aIndex >= 0) {\r\n      var subA = aTitle.substring(0, aIndex + 1);\r\n      var lastA = aTitle.replace(subA, \"\");\r\n      var intA = parseInt(lastA, 10);\r\n      var newIntA = Audit.Common.Utilities.PadDigits(intA, 5);\r\n      newA = subA + newIntA;\r\n    } else newA = aTitle;\r\n\r\n    var bIndex = bTitle.lastIndexOf(\"-\");\r\n    if (bIndex >= 0) {\r\n      var subB = bTitle.substring(0, bIndex + 1);\r\n      var lastB = bTitle.replace(subB, \"\");\r\n      var intB = parseInt(lastB, 10);\r\n      var newIntB = Audit.Common.Utilities.PadDigits(intB, 5);\r\n      newB = subB + newIntB;\r\n    } else newB = bTitle;\r\n\r\n    return newA.toLowerCase().localeCompare(newB.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortNoCase(a, b) {\r\n    return a.toLowerCase().localeCompare(b.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortDate(a, b) {\r\n    if (a == \"\") return -1;\r\n    if (b == \"\") return 1;\r\n    return new Date(a).getTime() - new Date(b).getTime();\r\n  }\r\n\r\n  //Adds the values in the arr array to the drop down with the specified id\r\n  function m_fnAddOptions(arr, ddlID, dateSort, responseSort) {\r\n    if (arr == null) return;\r\n    if (responseSort) arr.sort(m_fnSortResponseTitleNoCase);\r\n    else if (!dateSort) arr.sort(m_fnSortNoCase);\r\n    else arr.sort(m_fnSortDate);\r\n\r\n    var rOptions = new Array(),\r\n      j = -1;\r\n    rOptions[++j] = \"<option value=''>-Select-</option>\";\r\n\r\n    var arrLength = arr.length;\r\n\r\n    /*\tvar fragment = document.createDocumentFragment();\r\n\t\t\tvar choice = document.createElement('option');\r\n\t\t\tchoice.value = \"\";\r\n\t\t\tchoice.innerHTML = \"-Select-\";\r\n\t\t\tfragment.appendChild(choice);\r\n\t\t*/\r\n    for (var x = 0; x < arrLength; x++) {\r\n      var option = $.trim(arr[x]);\r\n\r\n      rOptions[++j] = \"<option value='\" + option + \"'>\" + option + \"</option>\";\r\n\r\n      /*\t\r\n\t\t\tvar choice = document.createElement('option');\r\n\t        choice.value = option;\r\n\t        choice.innerHTML = option;\r\n\t        fragment.appendChild(choice);*/\r\n    }\r\n\r\n    //ddlID = ddlID.replace(\"#\", \"\");\r\n    //document.getElementById(ddlID).innerHTML = rOptions.join('');\r\n\r\n    var thisDDL = $(ddlID);\r\n    thisDDL.empty().append(rOptions.join(\"\"));\r\n    /*var thisDDL = $(ddlID);\r\n\t\tthisDDL.empty().html( fragment );*/\r\n  }\r\n\r\n  function m_fnExistsInArr(arr, val) {\r\n    if (arr == null) return false;\r\n\r\n    var arrLength = arr.length;\r\n    for (var x = 0; x < arrLength; x++) {\r\n      if (arr[x] == val) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function m_fnGetTrueFalseIcon(val) {\r\n    if (val == true)\r\n      return \"<span class='ui-icon ui-icon-check'>\" + val + \"</span>\";\r\n    else return \"<span class='ui-icon ui-icon-close'>\" + val + \"</span>\";\r\n  }\r\n\r\n  function m_fnGetFriendlyDisplayName(oListItem, fieldName) {\r\n    var user = oListItem.get_item(fieldName);\r\n    if (user == null) return \"\";\r\n    else return user.get_lookupValue();\r\n  }\r\n\r\n  function m_fnPadDigits(n, totalDigits) {\r\n    n = n.toString();\r\n    var pd = \"\";\r\n    if (totalDigits > n.length) {\r\n      for (let i = 0; i < totalDigits - n.length; i++) {\r\n        pd += \"0\";\r\n      }\r\n    }\r\n    return pd + n.toString();\r\n  }\r\n\r\n  function m_fnPreciseRound(num, decimals) {\r\n    var sign = num >= 0 ? 1 : -1;\r\n    return (\r\n      Math.round(num * Math.pow(10, decimals) + sign * 0.001) /\r\n      Math.pow(10, decimals)\r\n    ).toFixed(decimals);\r\n  }\r\n\r\n  function m_fnGetFriendlyFileSize(fileSize) {\r\n    if (fileSize == null || fileSize == \"\") return \"\";\r\n\r\n    if (fileSize > 1048576) {\r\n      fileSize =\r\n        Audit.Common.Utilities.PreciseRound(fileSize / 1048576, 2) + \" MB\";\r\n    } else if (fileSize > 1024) {\r\n      fileSize =\r\n        Audit.Common.Utilities.PreciseRound(fileSize / 1024, 2) + \" KB\";\r\n    } else {\r\n      fileSize += \" B\";\r\n    }\r\n    return fileSize;\r\n  }\r\n\r\n  function m_fnISODateString(d) {\r\n    function pad(n) {\r\n      return n < 10 ? \"0\" + n : n;\r\n    }\r\n\r\n    return (\r\n      d.getUTCFullYear() +\r\n      \"-\" +\r\n      pad(d.getUTCMonth() + 1) +\r\n      \"-\" +\r\n      pad(d.getUTCDate()) +\r\n      \"T\" +\r\n      pad(d.getUTCHours()) +\r\n      \":\" +\r\n      pad(d.getUTCMinutes()) +\r\n      \":\" +\r\n      pad(d.getUTCSeconds()) +\r\n      \"Z\"\r\n    );\r\n  }\r\n\r\n  function m_fnBindHandlerResponseDoc() {\r\n    $(\".requestInfo-response-doc img\").click(function (event) {\r\n      event.preventDefault();\r\n      var curIcon = $(this).attr(\"src\");\r\n      if (curIcon == \"/_layouts/images/minus.gif\")\r\n        $(this).attr(\"src\", \"/_layouts/images/plus.gif\");\r\n      else $(this).attr(\"src\", \"/_layouts/images/minus.gif\");\r\n\r\n      //$(this).nextUntil('tr.Grouping').slideToggle(200);\r\n      $(this)\r\n        .parent()\r\n        .parent()\r\n        .nextUntil(\"tr.requestInfo-response-doc\")\r\n        .each(function () {\r\n          $(this).toggleClass(\"collapsed\");\r\n        });\r\n    });\r\n  }\r\n\r\n  /************\r\n\tNotice - for some reason, when the list item opens in a dialog or not in the dialog, it renders differently causing the values to get back data differently\r\n\t********/\r\n  /*\r\n\tfunction m_fnGetLookupFieldText( fieldName )\r\n\t{\r\n\t\tvar field = $( \"select[title='\" + fieldName  + \"']\" );\r\n\t\t\r\n\t\tif( field == null || field.html() == null ) //more than 20 items in the lookup\r\n\t\t{\r\n\t\t\tfield = $( \"input[title='\" + fieldName  + \"']\" );\r\n\t\t\treturn field.val();\r\n\t\t}\r\n\t\telse return $(\"select[title='\" + fieldName  + \"'] option:selected\").text();\r\n\t}\r\n\r\n\t*/\r\n\r\n  function m_fnGetLookupFormField(fieldTitle) {\r\n    if ($(\"select[title='\" + fieldTitle + \"']\").html() !== null) {\r\n      return $(\"select[title='\" + fieldTitle + \"']\");\r\n    } else {\r\n      return $(\"input[title='\" + fieldTitle + \"']\");\r\n    }\r\n  }\r\n\r\n  function m_fnGetLookupDisplayText(fieldTitle) {\r\n    //Set default value for lookups with less that 20 items\r\n    if ($(\"select[title='\" + fieldTitle + \"']\").html() !== null) {\r\n      return $(\"select[title='\" + fieldTitle + \"'] option:selected\").text();\r\n    } else {\r\n      return $(\"input[title='\" + fieldTitle + \"']\").val();\r\n    }\r\n  }\r\n\r\n  function m_fnSetLookupFromFieldNameByText(fieldName, text) {\r\n    try {\r\n      if (text == undefined) return;\r\n      var theSelect = m_fnGetTagFromIdentifierAndTitle(\"select\", \"\", fieldName);\r\n\r\n      if (theSelect == null) {\r\n        var theInput = m_fnGetTagFromIdentifierAndTitle(\"input\", \"\", fieldName);\r\n        //builtin\r\n        ShowDropdown(theInput.id);\r\n        var opt = document.getElementById(theInput.opt);\r\n        m_fnSetSelectedOptionByText(opt, text);\r\n        //builtin\r\n        OptLoseFocus(opt);\r\n      } else {\r\n        m_fnSetSelectedOptionByText(theSelect, text);\r\n      }\r\n    } catch (ex) {}\r\n  }\r\n\r\n  function m_fnSetSelectedOptionByText(select, text) {\r\n    var opts = select.options;\r\n    var optLength = opts.length;\r\n    if (select == null) return;\r\n\r\n    for (var i = 0; i < optLength; i++) {\r\n      if (opts[i].text == text) {\r\n        select.selectedIndex = i;\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function m_fnGetTagFromIdentifierAndTitle(tagName, identifier, title) {\r\n    var idLength = identifier.length;\r\n    var tags = document.getElementsByTagName(tagName);\r\n    for (var i = 0; i < tags.length; i++) {\r\n      var tagID = tags[i].id;\r\n      if (\r\n        tags[i].title == title &&\r\n        (identifier == \"\" ||\r\n          tagID.indexOf(identifier) == tagID.length - idLength)\r\n      ) {\r\n        return tags[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function m_fnViewUserManuals(docType) {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"User Manual\";\r\n    options.height = 250;\r\n    //options.dialogReturnValueCallback = OnCallbackForm;\r\n    if (docType != null)\r\n      options.url =\r\n        Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/pages/AuditUserManuals.aspx?FilterField1=DocType&FilterValue1=\" +\r\n        docType;\r\n    else\r\n      options.url =\r\n        Audit.Common.Utilities.GetSiteUrl() + \"/pages/AuditUserManuals.aspx\";\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnPrintPage(pageTitle, divTbl) {\r\n    var curDate = new Date();\r\n    var siteUrl = Audit.Common.Utilities.GetSiteUrl();\r\n    var cssLink1 =\r\n      siteUrl +\r\n      \"/siteassets/css/tablesorter/style.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink2 =\r\n      siteUrl +\r\n      \"/siteAssets/css/audit_styles.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n\r\n    var divOutput = $(divTbl).html();\r\n\r\n    //remove hyperlinks pointing to the job codes\r\n    var updatedDivOutput = $(\"<div>\").append(divOutput);\r\n    updatedDivOutput.find(\".sr-response-title a\").each(function () {\r\n      $(this).removeAttr(\"onclick\");\r\n      $(this).removeAttr(\"href\");\r\n    });\r\n\r\n    divOutput = updatedDivOutput.html();\r\n\r\n    var printDateString = curDate.format(\"MM/dd/yyyy hh:mm tt\");\r\n    printDateString =\r\n      \"<div style='padding-bottom:10px;'>\" + printDateString + \"</div>\";\r\n    divOutput = printDateString + divOutput;\r\n\r\n    var cssFile1 = $(\"<div></div>\");\r\n    var cssFile2 = $(\"<div></div>\");\r\n\r\n    var def1 = $.Deferred();\r\n    var def2 = $.Deferred();\r\n\r\n    var cssFileText = \"\";\r\n    cssFile1.load(cssLink1, function () {\r\n      cssFileText += \"<style>\" + cssFile1.html() + \"</style>\";\r\n      def1.resolve();\r\n    });\r\n    cssFile2.load(cssLink2, function () {\r\n      cssFileText += \"<style>\" + cssFile2.html() + \"</style>\";\r\n      def2.resolve();\r\n    });\r\n\r\n    //gets called asynchronously after the css files have been loaded\r\n    $.when(def1, def2).done(function () {\r\n      var html =\r\n        \"<HTML>\\n\" +\r\n        \"<HEAD>\\n\\n\" +\r\n        \"<Title>\" +\r\n        pageTitle +\r\n        \"</Title>\\n\" +\r\n        cssFileText +\r\n        \"\\n\" +\r\n        \"<style>\" +\r\n        \".hideOnPrint, .rowFilters {display:none}\" +\r\n        \"</style>\\n\" +\r\n        \"</HEAD>\\n\" +\r\n        \"<BODY>\\n\" +\r\n        divOutput +\r\n        \"\\n\" +\r\n        \"</BODY>\\n\" +\r\n        \"</HTML>\";\r\n\r\n      var printWP = window.open(\"\", \"printWebPart\");\r\n      printWP.document.open();\r\n      //insert content\r\n      printWP.document.write(html);\r\n\r\n      printWP.document.close();\r\n      //open print dialog\r\n      printWP.print();\r\n    });\r\n  }\r\n\r\n  //make sure iframe with id csvexprframe is added to page up top\r\n  //http://stackoverflow.com/questions/18185660/javascript-jquery-exporting-data-in-csv-not-working-in-ie\r\n  function m_fnExportToCsv(fileName, tableName, removeHeader) {\r\n    var data = m_fnGetCellValues(tableName);\r\n\r\n    if (removeHeader == true) data = data.slice(1);\r\n\r\n    var csv = m_fnConvertToCsv(data);\r\n    //\tconsole.log( csv );\r\n    if (navigator.userAgent.search(\"Trident\") >= 0) {\r\n      window.CsvExpFrame.document.open(\"text/html\", \"replace\");\r\n      //\t\twindow.CsvExpFrame.document.open(\"application/csv\", \"replace\");\r\n      //\t\twindow.CsvExpFrame.document.charset = \"utf-8\";\r\n      //\t\twindow.CsvExpFrame.document.open(\"application/ms-excel\", \"replace\");\r\n      window.CsvExpFrame.document.write(csv);\r\n      window.CsvExpFrame.document.close();\r\n      window.CsvExpFrame.focus();\r\n      window.CsvExpFrame.document.execCommand(\r\n        \"SaveAs\",\r\n        true,\r\n        fileName + \".csv\"\r\n      );\r\n    } else {\r\n      var uri = \"data:text/csv;charset=utf-8,\" + escape(csv);\r\n      var downloadLink = document.createElement(\"a\");\r\n      downloadLink.href = uri;\r\n      downloadLink.download = fileName + \".csv\";\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n    }\r\n  }\r\n\r\n  function m_fnGetCellValues(tableName) {\r\n    var table = document.getElementById(tableName);\r\n\r\n    //remove headers and footers\r\n    if (table.innerHTML.indexOf(\"rowFilters\") >= 0) {\r\n      var deets = $(\"<div>\").append(table.outerHTML);\r\n      deets.find(\".rowFilters\").each(function () {\r\n        $(this).remove();\r\n      });\r\n      table = deets.find(\"table\")[0];\r\n    }\r\n    if (table.innerHTML.indexOf(\"footer\") >= 0) {\r\n      var deets = $(\"<div>\").append(table.outerHTML);\r\n      deets.find(\".footer\").each(function () {\r\n        $(this).remove();\r\n      });\r\n      table = deets.find(\"table\")[0];\r\n    }\r\n\r\n    var tableArray = [];\r\n    for (var r = 0, n = table.rows.length; r < n; r++) {\r\n      tableArray[r] = [];\r\n      for (var c = 0, m = table.rows[r].cells.length; c < m; c++) {\r\n        var text =\r\n          table.rows[r].cells[c].textContent ||\r\n          table.rows[r].cells[c].innerText;\r\n        tableArray[r][c] = text.trim();\r\n      }\r\n    }\r\n    return tableArray;\r\n  }\r\n\r\n  function m_fnConvertToCsv(objArray) {\r\n    var array = typeof objArray != \"object\" ? JSON.parse(objArray) : objArray;\r\n    var str = \"sep=,\\r\\n\";\r\n    var line = \"\";\r\n    var index;\r\n    var value;\r\n    for (var i = 0; i < array.length; i++) {\r\n      line = \"\";\r\n      var array1 = array[i];\r\n      for (index in array1) {\r\n        if (array1.hasOwnProperty(index)) {\r\n          value = array1[index] + \"\";\r\n          line += '\"' + value.replace(/\"/g, '\"\"') + '\",';\r\n        }\r\n      }\r\n      line = line.slice(0, -1);\r\n      str += line + \"\\r\\n\";\r\n    }\r\n    return str;\r\n  }\r\n\r\n  var publicMembers = {\r\n    GetSiteUrl: function () {\r\n      if (m_siteUrl == \"/\") return \"\";\r\n      else return m_siteUrl;\r\n    },\r\n    GetListTitleRequests: function () {\r\n      return m_listTitleRequests;\r\n    },\r\n    GetListNameRequests: function () {\r\n      return m_listNameRequests;\r\n    },\r\n    GetListTitleRequestsInternal: function () {\r\n      return m_listTitleRequestsInternal;\r\n    },\r\n    GetListNameRequestsInternal: function () {\r\n      return m_listNameRequestsInternal;\r\n    },\r\n    GetListTitleResponses: function () {\r\n      return m_listTitleResponses;\r\n    },\r\n    GetListNameResponses: function () {\r\n      return m_listNameResponses;\r\n    },\r\n    GetLibTitleRequestDocs: function () {\r\n      return m_libTitleRequestDocs;\r\n    },\r\n    GetLibNameRequestDocs: function () {\r\n      return m_libNameRequestDocs;\r\n    },\r\n    GetLibTitleCoverSheets: function () {\r\n      return m_libTitleCoverSheet;\r\n    },\r\n    GetLibNameCoverSheets: function () {\r\n      return m_libNameCoverSheet;\r\n    },\r\n    GetLibTitleResponseDocs: function () {\r\n      return m_libTitleResponseDocs;\r\n    },\r\n    GetLibNameResponseDocs: function () {\r\n      return m_libNameResponseDocs;\r\n    },\r\n    GetLibTitleResponseDocsEA: function () {\r\n      return m_libTitleResponseDocsEA;\r\n    },\r\n    GetLibNameResponseDocsEA: function () {\r\n      return m_libNameResponseDocsEA;\r\n    },\r\n    GetListTitleActionOffices: function () {\r\n      return m_listTitleActionOffices;\r\n    },\r\n    GetListNameActionOffices: function () {\r\n      return m_listNameActionOffices;\r\n    },\r\n    GetListTitleEmailHistory: function () {\r\n      return m_listTitleEmailHistory;\r\n    },\r\n    GetListNameEmailHistory: function () {\r\n      return m_listNameEmailHistory;\r\n    },\r\n    GetListTitleBulkResponses: function () {\r\n      return m_listTitleBulkResponses;\r\n    },\r\n    GetListNameBulkResponses: function () {\r\n      return m_listNameBulkResponses;\r\n    },\r\n    GetListTitleBulkPermissions: function () {\r\n      return m_listTitleBulkPermissions;\r\n    },\r\n    GetListNameBulkPermissions: function () {\r\n      return m_listNameBulkPermissions;\r\n    },\r\n    GetGroupNameSpecialPerm1: function () {\r\n      return m_groupNameSpecialPermName1;\r\n    },\r\n    GetGroupNameSpecialPerm2: function () {\r\n      return m_groupNameSpecialPermName2;\r\n    },\r\n    GetGroupNameQA: function () {\r\n      return m_groupNameQA;\r\n    },\r\n    GetGroupNameEA: function () {\r\n      return m_groupNameEA;\r\n    },\r\n    Refresh: m_fnRefresh,\r\n    OnLoadDisplayTimeStamp: m_fnOnLoadDisplayTimeStamp,\r\n    OnLoadDisplayTabAndResponse: m_fnOnLoadDisplayTabAndResponse,\r\n    OnLoadFilterResponses: function (responseStatus1, responseStatus2) {\r\n      m_fnOnLoadFilterResponses(responseStatus1, responseStatus2);\r\n    },\r\n    SetResponseDocLibGUID: function (libGUID) {\r\n      m_libResponseDocsLibraryGUID = libGUID;\r\n    },\r\n    GetResponseDocLibGUID: function () {\r\n      return m_libResponseDocsLibraryGUID;\r\n    },\r\n    LoadSiteGroups: function (itemColl) {\r\n      m_fnLoadSiteGroups(itemColl);\r\n    },\r\n    GetSPSiteGroup: function (groupName) {\r\n      return m_fnGetSPSiteGroup(groupName);\r\n    },\r\n    LoadActionOffices: function (itemColl) {\r\n      m_fnLoadActionOffices(itemColl);\r\n    },\r\n    GetActionOffices: function () {\r\n      return m_arrAOs;\r\n    },\r\n    GetAOSPGroupName: function (groupName) {\r\n      return m_fnGetAOSPGroupName(groupName);\r\n    },\r\n    CheckSPItemHasGroupPermission: function (item, groupName, permissionLevel) {\r\n      return m_fnCheckSPItemHasGroupPermission(\r\n        item,\r\n        groupName,\r\n        permissionLevel\r\n      );\r\n    },\r\n    GoToResponse: function (responseTitle, isIA) {\r\n      m_fnGoToResponse(responseTitle, isIA);\r\n    },\r\n    GetResponseDocStyleTag: function (documentStatus) {\r\n      return m_fnGetResponseDocStyleTag(documentStatus);\r\n    },\r\n    GetResponseDocStyleTag2: function (documentStatus) {\r\n      return m_fnGetResponseDocStyleTag2(documentStatus);\r\n    },\r\n    CheckIfEmailFolderExists: function (items, requestNumber) {\r\n      return m_fnCheckIfEmailFolderExists(items, requestNumber);\r\n    },\r\n    CreateEmailFolder: function (list, requestNumber, requestItem, OnComplete) {\r\n      return m_fnCreateEmailFolder(\r\n        list,\r\n        requestNumber,\r\n        requestItem,\r\n        OnComplete\r\n      );\r\n    },\r\n    AddOptions: function (arr, ddlID, dateSort, responseSort) {\r\n      m_fnAddOptions(arr, ddlID, dateSort, responseSort);\r\n    },\r\n    ExistsInArr: function (arr, val) {\r\n      return m_fnExistsInArr(arr, val);\r\n    },\r\n    GetTrueFalseIcon: function (val) {\r\n      return m_fnGetTrueFalseIcon(val);\r\n    },\r\n    PadDigits: function (n, totalDigits) {\r\n      return m_fnPadDigits(n, totalDigits);\r\n    },\r\n    PreciseRound: function (num, decimals) {\r\n      return m_fnPreciseRound(num, decimals);\r\n    },\r\n    GetFriendlyFileSize: function (fileSize) {\r\n      return m_fnGetFriendlyFileSize(fileSize);\r\n    },\r\n    GetISODateString: function (d) {\r\n      return m_fnISODateString(d);\r\n    },\r\n    GetFriendlyDisplayName: function (oListItem, fieldName) {\r\n      return m_fnGetFriendlyDisplayName(oListItem, fieldName);\r\n    },\r\n    BindHandlerResponseDoc: m_fnBindHandlerResponseDoc,\r\n    PrintStatusReport: function (pageTitle, divTbl) {\r\n      m_fnPrintPage(pageTitle, divTbl);\r\n    },\r\n    ExportToCsv: function (fileName, tableName, removeHeader) {\r\n      m_fnExportToCsv(fileName, tableName, removeHeader);\r\n    },\r\n    ViewUserManuals: function (docType) {\r\n      m_fnViewUserManuals(docType);\r\n    },\r\n    //GetLookupFieldText: function( fieldName ){ return m_fnGetLookupFieldText( fieldName); },\r\n    GetLookupDisplayText: function (fieldName) {\r\n      return m_fnGetLookupDisplayText(fieldName);\r\n    },\r\n    GetLookupFormField: function (fieldName) {\r\n      return m_fnGetLookupFormField(fieldName);\r\n    },\r\n    SetLookupFromFieldNameByText: function (fieldName, text) {\r\n      return m_fnSetLookupFromFieldNameByText(fieldName, text);\r\n    },\r\n    SortResponseObjects: function (a, b) {\r\n      return m_fnSortResponseObjectNoCase(a, b);\r\n    },\r\n    SortResponseTitles: m_fnSortResponseTitleNoCase,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n\r\n// ExecuteOrDelayUntilScriptLoaded(InitReport, \"sp.js\");\r\nInitReport();\r\n", "\uFEFFimport { permissionsTemplate } from \"./Permissions_Template.js\";\r\nimport \"../../common/utilities.js\";\r\n\r\nwindow.Audit = window.Audit || {};\r\nAudit.Permissions = Audit.Permissions || {};\r\n\r\ndocument.getElementById(\"app\").innerHTML = permissionsTemplate;\r\n\r\nif (document.readyState === \"ready\" || document.readyState === \"complete\") {\r\n  InitPermissions();\r\n} else {\r\n  document.onreadystatechange = () => {\r\n    if (document.readyState === \"complete\" || document.readyState === \"ready\") {\r\n      ExecuteOrDelayUntilScriptLoaded(function () {\r\n        SP.SOD.executeFunc(\"sp.js\", \"SP.ClientContext\", InitPermissions);\r\n      }, \"sp.js\");\r\n    }\r\n  };\r\n}\r\n\r\nfunction InitPermissions() {\r\n  Audit.Permissions.Report = new Audit.Permissions.Load();\r\n  Audit.Permissions.Init();\r\n}\r\n\r\nAudit.Permissions.Init = function () {};\r\n\r\nAudit.Permissions.Load = function () {\r\n  //var m_siteUrl = _spPageContextInfo.webServerRelativeUrl; //IE11 in sp 2013 does not recognize L_Menu_BaseUrl\r\n  var m_arrRequests = new Array();\r\n  var m_arrResponses = new Array();\r\n  var m_arrResponseFolders = new Array();\r\n\r\n  var m_arrGroups = null;\r\n  var m_collGroup = null;\r\n  var m_ownerGroupName = null;\r\n  var m_memberGroupName = null;\r\n  var m_visitorGroupName = null;\r\n\r\n  var notifyId;\r\n  var m_waitDialog;\r\n  var m_txtOutgoingEmailText = null;\r\n\r\n  var m_emailFolderName = \"AOVerifications\";\r\n\r\n  var m_oAOGroupUsers = new Object();\r\n\r\n  LoadInfo();\r\n\r\n  function LoadInfo() {\r\n    //$(\"#divTblOutput\").html(\"\");\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    /*\tvar requestList = web.get_lists().getByTitle( Audit.Common.Utilities.GetListTitleRequests() );\r\n\t\tvar requestQuery = new SP.CamlQuery();\t\r\n\t\trequestQuery.set_viewXml('<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>');\r\n\t\tm_requestItems = requestList.getItems( requestQuery );\r\n\t\t//request status has internal name as response status in the request list\r\n\t\tcurrCtx.load( m_requestItems, 'Include(ID, Title, ReqStatus, IsSample, ActionOffice, Modified, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))');\r\n\t    \r\n\t\tvar responseList = web.get_lists().getByTitle( Audit.Common.Utilities.GetListTitleResponses() );\r\n\t\tvar responseQuery = new SP.CamlQuery();\t\r\n\t\tresponseQuery.set_viewXml('<View Scope=\"RecursiveAll\"><Query><OrderBy><FieldRef Name=\"ReqNum\"/></OrderBy></Query></View>');\r\n\t\tm_responseItems = responseList.getItems( responseQuery );\r\n\t\tcurrCtx.load( m_responseItems, 'Include(ID, Title, ReqNum, ActionOffice, SampleNumber, ResStatus, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))' );\r\n\r\n\t\tvar responseDocsLibFolderslist = web.get_lists().getByTitle( Audit.Common.Utilities.GetLibTitleResponseDocs() );\r\n\t\tvar responseDocsLibFolderslistQuery = new SP.CamlQuery();\r\n\t    responseDocsLibFolderslistQuery.set_viewXml('<View><Query><OrderBy><FieldRef Name=\"Name\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\" /><Value Type=\"Lookup\">1</Value></Eq></Where></Query></View>');\r\n\t\tresponseDocsLibFolderslistQuery.set_folderServerRelativeUrl( Audit.Common.Utilities.GetSiteUrl() + \"/\" + Audit.Common.Utilities.GetLibNameResponseDocs() );\r\n\t\tm_ResponseDocsFoldersItems = responseDocsLibFolderslist.getItems(responseDocsLibFolderslistQuery);\r\n\t\tcurrCtx.load( m_ResponseDocsFoldersItems, \"Include( DisplayName, Id, ContentType, EncodedAbsUrl, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))\");\r\n\t*/\r\n    var aoList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleActionOffices());\r\n    var aoQuery = new SP.CamlQuery();\r\n    aoQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>'\r\n    );\r\n    var m_aoItems = aoList.getItems(aoQuery);\r\n    currCtx.load(m_aoItems, \"Include(ID, Title, UserGroup)\");\r\n\r\n    var ownerGroup = web.get_associatedOwnerGroup();\r\n    var memberGroup = web.get_associatedMemberGroup();\r\n    var visitorGroup = web.get_associatedVisitorGroup();\r\n    currCtx.load(ownerGroup);\r\n    currCtx.load(memberGroup);\r\n    currCtx.load(visitorGroup);\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n    function OnSuccess(sender, args) {\r\n      Audit.Common.Utilities.LoadActionOffices(m_aoItems);\r\n\r\n      m_ownerGroupName = ownerGroup.get_title();\r\n      m_memberGroupName = memberGroup.get_title();\r\n      m_visitorGroupName = visitorGroup.get_title();\r\n\r\n      /*\tm_fnLoadRequestPermissions();\r\n\t\t\tm_fnLoadResponsePermissions();\r\n\t\t\tm_fnLoadResponseFolderPermissions();\r\n\t\t\t\r\n\t\t\tLoadDDOptions();\r\n\t\t*/\r\n      $(\"#tabs\").tabs().show();\r\n\r\n      m_fnBindHandlersOnLoad();\r\n\r\n      Audit.Common.Utilities.OnLoadDisplayTimeStamp();\r\n      m_fnOnLoadDisplayTab();\r\n\r\n      var isModalDlg = GetUrlKeyValue(\"IsDlg\");\r\n      if (isModalDlg == null || isModalDlg == \"\" || isModalDlg == false) {\r\n        $(\"#btnRefresh\").show();\r\n      }\r\n\r\n      var doneLoadingSPGroupPermissions = false;\r\n      m_fnLoadSPGroupPermissions(function (doneLoadingSPGroupPermissions) {\r\n        if (doneLoadingSPGroupPermissions) {\r\n          m_fnDisplaySPGroupPermissions();\r\n          m_fnDisplaySPGroupPermissions2();\r\n        }\r\n      });\r\n    }\r\n    function OnFailure(sender, args) {\r\n      $(\"#divLoading\").hide();\r\n\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n      SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n    }\r\n  }\r\n\r\n  function m_fnRefresh() {\r\n    var curPath = location.pathname;\r\n\r\n    var tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n    curPath += \"?Tab=\" + tabIndex;\r\n\r\n    location.href = curPath;\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTab() {\r\n    var paramTabIndex = GetUrlKeyValue(\"Tab\");\r\n    if (paramTabIndex != null && paramTabIndex != \"\") {\r\n      $(\"#tabs\").tabs(\"option\", \"active\", paramTabIndex);\r\n    }\r\n  }\r\n\r\n  function m_fnLoadRequestPermissions() {\r\n    m_arrRequests = new Array();\r\n\r\n    var currCtx = SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    this.ownerGroup = web.get_associatedOwnerGroup();\r\n    this.memberGroup = web.get_associatedMemberGroup();\r\n    this.visitorGroup = web.get_associatedVisitorGroup();\r\n\r\n    var listItemEnumerator = m_requestItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var number = oListItem.get_item(\"Title\");\r\n      var status = oListItem.get_item(\"ReqStatus\");\r\n\r\n      var sample = oListItem.get_item(\"IsSample\");\r\n      var arrActionOffice = oListItem.get_item(\"ActionOffice\");\r\n      var actionOffice = \"\";\r\n      for (var x = 0; x < arrActionOffice.length; x++) {\r\n        actionOffice +=\r\n          \"<div>\" + arrActionOffice[x].get_lookupValue() + \"</div>\";\r\n      }\r\n\r\n      var requestObject = new Object();\r\n      requestObject[\"ID\"] = id;\r\n      requestObject[\"number\"] = number;\r\n      requestObject[\"status\"] = status;\r\n      requestObject[\"sample\"] = sample;\r\n      requestObject[\"responses\"] = new Array();\r\n      requestObject[\"actionOffice\"] = actionOffice;\r\n      requestObject[\"item\"] = oListItem;\r\n\r\n      m_fnLoadPermsOnItem(requestObject, oListItem);\r\n\r\n      m_arrRequests.push(requestObject);\r\n    }\r\n\r\n    var arrRequestIDs = new Array();\r\n    var errorCount = 0;\r\n    var sTablePermissionsBody = \"\";\r\n\r\n    var r = new Array(),\r\n      j = -1;\r\n\r\n    var reqLength = m_arrRequests.length;\r\n    for (var x = 0; x < reqLength; x++) {\r\n      var oRequest = m_arrRequests[x];\r\n\r\n      var number = oRequest.number;\r\n      arrRequestIDs.push(number);\r\n      var status = oRequest.status;\r\n      var actionOffices = oRequest.actionOffice;\r\n      var permsDisplay = oRequest.permissionsDisplay;\r\n      var hasSecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oRequest.hasSpecialPermissions\r\n      );\r\n\r\n      var flagItem = false;\r\n      var errToolTip = \"\";\r\n\r\n      for (var y = 0; y < oRequest.item.get_item(\"ActionOffice\").length; y++) {\r\n        var actionOfficeName = oRequest.item\r\n          .get_item(\"ActionOffice\")\r\n          [y].get_lookupValue();\r\n        var groupNameActionOffice =\r\n          Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n\r\n        var bFoundPermission = false;\r\n        for (var z = 0; z < oRequest.arrUserPermissions.length; z++)\r\n          if (oRequest.arrUserPermissions[z].name == groupNameActionOffice)\r\n            bFoundPermission = true;\r\n        for (var z = 0; z < oRequest.arrGroupPermissions.length; z++)\r\n          if (oRequest.arrGroupPermissions[z].name == groupNameActionOffice)\r\n            bFoundPermission = true;\r\n\r\n        if (!bFoundPermission) {\r\n          errToolTip =\r\n            ' title=\"Missing Action Office in this set of Permissions\" ';\r\n          flagItem = true;\r\n        }\r\n      }\r\n\r\n      if (!flagItem) {\r\n        //check if groups/users found in the permissions that are not part of the AOs\r\n        var bError = false;\r\n        for (var z = 0; z < oRequest.arrUserPermissions.length; z++) {\r\n          var bFound = false;\r\n          var name = oRequest.arrUserPermissions[z].name;\r\n          for (\r\n            var y = 0;\r\n            y < oRequest.item.get_item(\"ActionOffice\").length;\r\n            y++\r\n          ) {\r\n            var actionOfficeName = oRequest.item\r\n              .get_item(\"ActionOffice\")\r\n              [y].get_lookupValue();\r\n            var groupNameActionOffice =\r\n              Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n            if (name == groupNameActionOffice) {\r\n              bFound = true;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            if (\r\n              name == m_ownerGroupName ||\r\n              name == m_memberGroupName ||\r\n              name == m_visitorGroupName ||\r\n              name == Audit.Common.Utilities.GetGroupNameQA() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm1() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm2()\r\n            ) {\r\n              bFound = true;\r\n            } else {\r\n              bFound = false;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            bError = true;\r\n            break;\r\n          }\r\n        }\r\n        for (var z = 0; z < oRequest.arrGroupPermissions.length; z++) {\r\n          var bFound = false;\r\n          var name = oRequest.arrGroupPermissions[z].name;\r\n          for (\r\n            var y = 0;\r\n            y < oRequest.item.get_item(\"ActionOffice\").length;\r\n            y++\r\n          ) {\r\n            var actionOfficeName = oRequest.item\r\n              .get_item(\"ActionOffice\")\r\n              [y].get_lookupValue();\r\n            var groupNameActionOffice =\r\n              Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n            if (name == groupNameActionOffice) {\r\n              bFound = true;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            if (\r\n              name == m_ownerGroupName ||\r\n              name == m_memberGroupName ||\r\n              name == m_visitorGroupName ||\r\n              name == Audit.Common.Utilities.GetGroupNameQA() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm1() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm2()\r\n            ) {\r\n              bFound = true;\r\n            } else {\r\n              bFound = false;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            bError = true;\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (bError) {\r\n          errToolTip =\r\n            ' title=\"User or Group found in this set of Permissions that does not belong\" ';\r\n          flagItem = true;\r\n        }\r\n      }\r\n\r\n      //if( oRequest.hasSpecialPermissions && ( status != \"4-Approved for QA\" && status != \"7-Closed\" ) )// this should never be the case\r\n      //\tflagItem = true;\r\n\r\n      var styleTag = \"\";\r\n      if (flagItem) {\r\n        styleTag = ' style=\"background-color:lightsalmon\" ' + errToolTip;\r\n        errorCount++;\r\n      }\r\n\r\n      var link =\r\n        '<a href=\"javascript:void(0);\" onclick=\\'Audit.Permissions.Report.GoToRequest(\"' +\r\n        oRequest.number +\r\n        \"\\\")'>\" +\r\n        oRequest.number +\r\n        \"</a>\";\r\n\r\n      /*sTablePermissionsBody += '<tr class=\"request-perm-item\" ' + styleTag + '>' + \r\n\t\t\t\t'<td class=\"request-perm-item-number\" title=\"Request number\">' + link + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-status\" title=\"Request status\">' + status + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-actionOffices\" title=\"Request action offices\">' + actionOffices + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-specialPerms\" title=\"Request special permissions?\">' + hasSecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-perms\" title=\"Request permissions\">' + permsDisplay + '</td>' +\r\n\t\t\t'</tr>';*/\r\n\r\n      r[++j] = '<tr class=\"request-perm-item\" ';\r\n      r[++j] = styleTag;\r\n      r[++j] = \">\";\r\n      r[++j] = '<td class=\"request-perm-item-number\" title=\"Request number\">';\r\n      r[++j] = link;\r\n      r[++j] = \"</td>\";\r\n      r[++j] = '<td class=\"request-perm-item-status\" title=\"Request status\">';\r\n      r[++j] = status;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"request-perm-item-actionOffices\" title=\"Request action offices\">';\r\n      r[++j] = actionOffices;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"request-perm-item-specialPerms\" title=\"Request special permissions?\">';\r\n      r[++j] = hasSecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"request-perm-item-perms\" title=\"Request permissions\">';\r\n      r[++j] = permsDisplay;\r\n      r[++j] = \"</td>\";\r\n      r[++j] = \"</tr>\";\r\n    }\r\n\r\n    $(\"#tblRequestsPermissions tbody\").append(r.join(\"\"));\r\n\r\n    $(\"#tblRequestsPermsTotal\").text(m_arrRequests.length);\r\n\r\n    if (errorCount > 0) {\r\n      $(\"#divErrorMsg\").html(\r\n        $(\"#divErrorMsg\").html() +\r\n          \"<div><fieldset><legend>Request Permissions</legend><span class='ui-icon ui-icon-alert'></span>There are (\" +\r\n          errorCount +\r\n          \") Requests with Permission issues detected</fielset></div>\"\r\n      );\r\n    }\r\n\r\n    Audit.Common.Utilities.AddOptions(arrRequestIDs, \"#ddlRequestID\", false);\r\n  }\r\n\r\n  function m_fnLoadResponsePermissions() {\r\n    m_arrResponses = new Array();\r\n\r\n    var listItemEnumerator = m_responseItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var number = oListItem.get_item(\"ReqNum\");\r\n      if (number != null) {\r\n        number = number.get_lookupValue();\r\n\r\n        var responseObject = new Object();\r\n        responseObject[\"ID\"] = oListItem.get_item(\"ID\");\r\n        responseObject[\"number\"] = number;\r\n        responseObject[\"title\"] = oListItem.get_item(\"Title\");\r\n        responseObject[\"item\"] = oListItem;\r\n\r\n        responseObject[\"sample\"] = oListItem.get_item(\"SampleNumber\");\r\n        if (responseObject[\"sample\"] == null) responseObject[\"sample\"] = \"\";\r\n\r\n        responseObject[\"actionOffice\"] = oListItem.get_item(\"ActionOffice\");\r\n        if (responseObject[\"actionOffice\"] == null)\r\n          responseObject[\"actionOffice\"] = \"\";\r\n        else\r\n          responseObject[\"actionOffice\"] =\r\n            responseObject[\"actionOffice\"].get_lookupValue();\r\n\r\n        responseObject[\"resStatus\"] = oListItem.get_item(\"ResStatus\");\r\n\r\n        m_fnLoadPermsOnItem(responseObject, oListItem);\r\n\r\n        m_arrResponses.push(responseObject);\r\n      }\r\n    }\r\n\r\n    var arrErrorRequestNoSpecialPerms = new Array();\r\n    var arrErrorResponseHasSpecialPerms = new Array();\r\n    var arrErrorResponseActionOfficeNotInRequest = new Array();\r\n\r\n    var errorCount = 0;\r\n    var sTablePermissionsBody = \"\";\r\n    var r = new Array(),\r\n      j = -1;\r\n\r\n    var responseLength = m_arrResponses.length;\r\n    for (var x = 0; x < responseLength; x++) {\r\n      var oResponse = m_arrResponses[x];\r\n\r\n      var number = oResponse.number;\r\n      var title = oResponse.title;\r\n      var status = oResponse.resStatus;\r\n      var actionOffice = oResponse.actionOffice;\r\n      var perms = oResponse.permissionsDisplay;\r\n      var hasSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oResponse.hasSpecialPermissions\r\n      );\r\n\r\n      var bRequestSpecialPerms = false;\r\n      var requestSpecialPerms = \"\";\r\n      var arrRequestActionOffices = null;\r\n      var requestActionOffices = \"\";\r\n      for (var y = 0; y < m_arrRequests.length; y++) {\r\n        if (m_arrRequests[y].number == number) {\r\n          bRequestSpecialPerms = m_arrRequests[y].hasSpecialPermissions;\r\n          requestSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n            m_arrRequests[y].hasSpecialPermissions\r\n          );\r\n          arrRequestActionOffices =\r\n            m_arrRequests[y].item.get_item(\"ActionOffice\");\r\n          requestActionOffices = m_arrRequests[y].actionOffice;\r\n          break;\r\n        }\r\n      }\r\n\r\n      var flagItem = false;\r\n      if (!bRequestSpecialPerms && oResponse.hasSpecialPermissions) {\r\n        // this should never be the case\r\n        flagItem = true;\r\n        arrErrorRequestNoSpecialPerms.push(title);\r\n      }\r\n      if (\r\n        oResponse.hasSpecialPermissions &&\r\n        status != \"4-Approved for QA\" &&\r\n        status != \"7-Closed\"\r\n      ) {\r\n        flagItem = true;\r\n        arrErrorResponseHasSpecialPerms.push(title);\r\n      }\r\n\r\n      var responseActionOfficeIsInRequest = false;\r\n      for (var y = 0; y < arrRequestActionOffices.length; y++) {\r\n        if (arrRequestActionOffices[y].get_lookupValue() == actionOffice) {\r\n          responseActionOfficeIsInRequest = true;\r\n        }\r\n      }\r\n\r\n      if (!responseActionOfficeIsInRequest) {\r\n        flagItem = true;\r\n        arrErrorResponseActionOfficeNotInRequest.push(title);\r\n      }\r\n\r\n      var styleTag = \"\";\r\n      if (flagItem) {\r\n        styleTag = ' style=\"background-color:lightsalmon\" ';\r\n        errorCount++;\r\n      }\r\n\r\n      var link =\r\n        '<a href=\"javascript:void(0);\" onclick=\\'Audit.Permissions.Report.GoToResponse(\"' +\r\n        title +\r\n        \"\\\")'>\" +\r\n        title +\r\n        \"</a>\";\r\n\r\n      requestActionOffices = requestActionOffices.replace(\r\n        actionOffice,\r\n        \"<b>\" + actionOffice + \"</b>\"\r\n      );\r\n      /*sTablePermissionsBody += '<tr class=\"response-perm-item\" ' + styleTag + '>' + \r\n\t\t\t\t'<td class=\"response-perm-item-number\" title=\"Request number\" nowrap>' + number + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-title\" title=\"Response title\" nowrap>' + link + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-status\" title=\"Response status\" nowrap>' + status + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>' + requestActionOffices + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-actionOffice\" title=\"Response action office\">' + actionOffice + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-requestSpecialPerms\" title=\"Special permissions?\">' + requestSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-specialPerms\" title=\"Special permissions\">' + hasSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-perms\" title=\"Response permissions\" nowrap>' + perms + '</td>' +\r\n\t\t\t'</tr>';*/\r\n\r\n      r[++j] = '<tr class=\"response-perm-item\" ';\r\n      r[++j] = styleTag;\r\n      r[++j] = \">\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-number\" title=\"Request number\" nowrap>';\r\n      r[++j] = number;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-title\" title=\"Response title\" nowrap>';\r\n      r[++j] = link;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-status\" title=\"Response status\" nowrap>';\r\n      r[++j] = status;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>';\r\n      r[++j] = requestActionOffices;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-actionOffice\" title=\"Response action office\">';\r\n      r[++j] = actionOffice;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-requestSpecialPerms\" title=\"Special permissions?\">';\r\n      r[++j] = requestSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-specialPerms\" title=\"Special permissions\">';\r\n      r[++j] = hasSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-perms\" title=\"Response permissions\" nowrap>';\r\n      r[++j] = perms;\r\n      r[++j] = \"</td></tr>\";\r\n    }\r\n\r\n    $(\"#tblResponsePermissions tbody\").append(r.join(\"\"));\r\n\r\n    $(\"#tblResponsePermsTotal\").text(m_arrResponses.length);\r\n\r\n    if (errorCount > 0) {\r\n      var errorMsg1 = m_fnGetErrorMsg(\r\n        arrErrorRequestNoSpecialPerms,\r\n        \"These Responses have Special Permisions, but their Requests do not\"\r\n      );\r\n      var errorMsg2 = m_fnGetErrorMsg(\r\n        arrErrorResponseHasSpecialPerms,\r\n        \"These Responses have Special Permisions, but their Response Status is NOT '4-Approved for QA' or '7-Closed'\"\r\n      );\r\n      var errorMsg3 = m_fnGetErrorMsg(\r\n        arrErrorResponseActionOfficeNotInRequest,\r\n        \"These Responses have an Action Office that is not specified in the Request's Action Offices\"\r\n      );\r\n\r\n      $(\"#divErrorMsg\").html(\r\n        $(\"#divErrorMsg\").html() +\r\n          \"<div style='padding-bottom:5px;'><fieldset><legend>Response Permissions</legend><span class='ui-icon ui-icon-alert'></span>There are (\" +\r\n          errorCount +\r\n          \") Responses with Permission issues detected.\" +\r\n          errorMsg1 +\r\n          errorMsg2 +\r\n          errorMsg3 +\r\n          \"</fielset></div>\"\r\n      );\r\n    }\r\n  }\r\n\r\n  function m_fnLoadResponseFolderPermissions() {\r\n    var m_arrResponseFolders = new Array();\r\n\r\n    var listItemEnumerator = m_ResponseDocsFoldersItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var folderName = oListItem.get_displayName();\r\n      for (var x = 0; x < m_arrResponses.length; x++) {\r\n        if (m_arrResponses[x].title == folderName) {\r\n          var responseFolderObject = new Object();\r\n          responseFolderObject[\"title\"] = folderName;\r\n          responseFolderObject[\"response\"] = m_arrResponses[x];\r\n\r\n          m_fnLoadPermsOnItem(responseFolderObject, oListItem);\r\n\r\n          m_arrResponseFolders.push(responseFolderObject);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    var arrErrorRequestNoSpecialPerms = new Array();\r\n    var arrErrorResponseHasSpecialPerms = new Array();\r\n    var arrErrorResponseActionOfficeNotInRequest = new Array();\r\n\r\n    var errorCount = 0;\r\n    var sTablePermissionsBody = \"\";\r\n    var r = new Array(),\r\n      j = -1;\r\n    var resFolderLength = m_arrResponseFolders.length;\r\n    for (var x = 0; x < resFolderLength; x++) {\r\n      var oResponseFolder = m_arrResponseFolders[x];\r\n\r\n      var number = oResponseFolder.response.number;\r\n      var title = oResponseFolder.response.title;\r\n      var folderName = oResponseFolder.title;\r\n      var status = oResponseFolder.response.resStatus;\r\n      var responseActionOffice = oResponseFolder.response.actionOffice;\r\n      var perms = oResponseFolder.response.permissionsDisplay;\r\n      var hasSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oResponseFolder.hasSpecialPermissions\r\n      );\r\n      var responseSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oResponseFolder.response.hasSpecialPermissions\r\n      );\r\n\r\n      var bRequestSpecialPerms = false;\r\n      var requestSpecialPerms = \"\";\r\n      var arrRequestActionOffices = null;\r\n      var requestActionOffices = \"\";\r\n      for (var y = 0; y < m_arrRequests.length; y++) {\r\n        if (m_arrRequests[y].number == number) {\r\n          bRequestSpecialPerms = m_arrRequests[y].hasSpecialPermissions;\r\n          requestSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n            m_arrRequests[y].hasSpecialPermissions\r\n          );\r\n          arrRequestActionOffices =\r\n            m_arrRequests[y].item.get_item(\"ActionOffice\");\r\n          requestActionOffices = m_arrRequests[y].actionOffice;\r\n          break;\r\n        }\r\n      }\r\n\r\n      var flagItem = false;\r\n      if (\r\n        !bRequestSpecialPerms &&\r\n        oResponseFolder.response.hasSpecialPermissions\r\n      ) {\r\n        // this should never be the case\r\n        flagItem = true;\r\n        arrErrorRequestNoSpecialPerms.push(title);\r\n      }\r\n      if (\r\n        oResponseFolder.response.hasSpecialPermissions &&\r\n        status != \"4-Approved for QA\" &&\r\n        status != \"7-Closed\"\r\n      ) {\r\n        flagItem = true;\r\n        arrErrorResponseHasSpecialPerms.push(title);\r\n      }\r\n\r\n      var responseActionOfficeIsInRequest = false;\r\n      for (var y = 0; y < arrRequestActionOffices.length; y++) {\r\n        if (\r\n          arrRequestActionOffices[y].get_lookupValue() == responseActionOffice\r\n        ) {\r\n          responseActionOfficeIsInRequest = true;\r\n        }\r\n      }\r\n\r\n      if (!responseActionOfficeIsInRequest) {\r\n        flagItem = true;\r\n        arrErrorResponseActionOfficeNotInRequest.push(title);\r\n      }\r\n\r\n      var styleTag = \"\";\r\n      if (flagItem) {\r\n        styleTag = ' style=\"background-color:lightsalmon\" ';\r\n        errorCount++;\r\n      }\r\n\r\n      requestActionOffices = requestActionOffices.replace(\r\n        responseActionOffice,\r\n        \"<b>\" + responseActionOffice + \"</b>\"\r\n      );\r\n      /*sTablePermissionsBody += '<tr class=\"responseFolder-perm-item\" ' + styleTag + '>' + \r\n\t\t\t\t'<td class=\"responseFolder-perm-item-number\" title=\"Request number\" nowrap>' + number  + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-responseTitle\" title=\"Response title\">' + title  + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-title\" title=\"Response folder\" nowrap>' + folderName + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-status\" title=\"Response status\" nowrap>' + status + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>' + requestActionOffices + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-responseActionOffice\" title=\"Response action office\" nowrap>' + responseActionOffice + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-requestSpecialPerms\" title=\"Request special permissions?\" nowrap>' + requestSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-responseSpecialPerms\" title=\"Response special permissions?\" nowrap>' + hasSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-specialPerms\" title=\"Response folder special permissions\" nowrap>' + responseSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-perms\" title=\"Folder permissions\" nowrap>' + perms + '</td>' +\r\n\t\t\t'</tr>';*/\r\n\r\n      r[++j] = '<tr class=\"responseFolder-perm-item\" ';\r\n      r[++j] = styleTag;\r\n      r[++j] = \">\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-number\" title=\"Request number\" nowrap>';\r\n      r[++j] = number;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-responseTitle\" title=\"Response title\">';\r\n      r[++j] = title;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-title\" title=\"Response folder\" nowrap>';\r\n      r[++j] = folderName;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-status\" title=\"Response status\" nowrap>';\r\n      r[++j] = status;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>';\r\n      r[++j] = requestActionOffices;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-responseActionOffice\" title=\"Response action office\" nowrap>';\r\n      r[++j] = responseActionOffice;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-requestSpecialPerms\" title=\"Request special permissions?\" nowrap>';\r\n      r[++j] = requestSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-responseSpecialPerms\" title=\"Response special permissions?\" nowrap>';\r\n      r[++j] = hasSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-specialPerms\" title=\"Response folder special permissions\" nowrap>';\r\n      r[++j] = responseSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-perms\" title=\"Folder permissions\" nowrap>';\r\n      r[++j] = perms;\r\n      r[++j] = \"</td></tr>\";\r\n    }\r\n\r\n    $(\"#tblResponseFolderPermissions tbody\").append(r.join(\"\"));\r\n\r\n    $(\"#tblResponseFolderPermsTotal\").text(m_arrResponseFolders.length);\r\n\r\n    if (errorCount > 0) {\r\n      var errorMsg1 = m_fnGetErrorMsg(\r\n        arrErrorRequestNoSpecialPerms,\r\n        \"These Response Folders have Special Permisions, but their Requests do not\"\r\n      );\r\n      var errorMsg2 = m_fnGetErrorMsg(\r\n        arrErrorResponseHasSpecialPerms,\r\n        \"These Response Folders have Special Permisions, but their Reponse Status is NOT '4-Approved for QA' or '7-Closed'\"\r\n      );\r\n      var errorMsg3 = m_fnGetErrorMsg(\r\n        arrErrorResponseActionOfficeNotInRequest,\r\n        \"These Response Folders have an Action Office that is not specified in the Request's Action Offices\"\r\n      );\r\n\r\n      $(\"#divErrorMsg\").html(\r\n        $(\"#divErrorMsg\").html() +\r\n          \"<div style='padding-bottom:5px;'><fieldset><legend>Response Folder Permissions</legend><span class='ui-icon ui-icon-alert'></span>There are (\" +\r\n          errorCount +\r\n          \") Response Folders with Permission issues detected.\" +\r\n          errorMsg1 +\r\n          errorMsg2 +\r\n          errorMsg3 +\r\n          \"</fieldset></div>\"\r\n      );\r\n    }\r\n  }\r\n\r\n  function m_fnGetErrorMsg(arr, msgTitle) {\r\n    var errorMsg = \"\";\r\n    if (arr.length > 0) {\r\n      errorMsg = \"<div style='padding-bottom:5px;'>\" + msgTitle + \"<ul>\";\r\n      for (var x = 0; x < arr.length; x++) {\r\n        errorMsg += \"<li>\" + arr + \"</li>\";\r\n      }\r\n      errorMsg += \"</ul></div>\";\r\n    }\r\n    return errorMsg;\r\n  }\r\n\r\n  function m_fnLoadPermsOnItem(item, oListItem) {\r\n    item[\"UserPermissions\"] = new Array();\r\n    item[\"GroupPermissions\"] = new Array();\r\n\r\n    item[\"arrUserPermissions\"] = new Array();\r\n    item[\"arrGroupPermissions\"] = new Array();\r\n\r\n    var roleAssignments = oListItem.get_roleAssignments();\r\n    var rolesEnumerator = roleAssignments.getEnumerator();\r\n    while (rolesEnumerator.moveNext()) {\r\n      var role = rolesEnumerator.get_current();\r\n      var roleMember = role.get_member();\r\n      var memeberLoginName = roleMember.get_loginName();\r\n      var memberTitleName = roleMember.get_title();\r\n\r\n      var permissionType = \"UserPermissions\";\r\n      var principalType = roleMember.get_principalType();\r\n      if (\r\n        principalType == SP.Utilities.PrincipalType.securityGroup ||\r\n        principalType == SP.Utilities.PrincipalType.sharePointGroup\r\n      ) {\r\n        permissionType = \"GroupPermissions\";\r\n      }\r\n\r\n      var roleDefs = role.get_roleDefinitionBindings();\r\n\r\n      var roleDefsEnumerator = roleDefs.getEnumerator();\r\n      while (roleDefsEnumerator.moveNext()) {\r\n        var rd = roleDefsEnumerator.get_current();\r\n        var rdName = rd.get_name();\r\n\r\n        item[permissionType].push(rdName + \" - \" + memberTitleName);\r\n\r\n        var pmObject = new Object();\r\n        pmObject.name = memberTitleName;\r\n        pmObject.permissionLevel = rdName;\r\n\r\n        item[\"arr\" + permissionType].push(pmObject);\r\n      }\r\n    }\r\n\r\n    var perms = \"\";\r\n    for (var z = 0; z < item.UserPermissions.length; z++)\r\n      perms +=\r\n        \"<div style='white-space:nowrap'>\" + item.UserPermissions[z] + \"</div>\";\r\n    for (var z = 0; z < item.GroupPermissions.length; z++)\r\n      perms +=\r\n        \"<div style='white-space:nowrap'>\" +\r\n        item.GroupPermissions[z] +\r\n        \"</div>\";\r\n\r\n    var specialPerms = false;\r\n    if (\r\n      perms.indexOf(Audit.Common.Utilities.GetGroupNameSpecialPerm1()) >= 0 &&\r\n      perms.indexOf(Audit.Common.Utilities.GetGroupNameSpecialPerm2()) >= 0\r\n    ) {\r\n      specialPerms = true;\r\n    }\r\n\r\n    if (perms != \"\")\r\n      perms =\r\n        \"<div class='permsLink' style='cursor:pointer' title='Click to view' ><a href='javascript:void(0)'>View</a><div class='permsInfo collapsed'>\" +\r\n        perms +\r\n        \"</div></div>\";\r\n    item[\"permissionsDisplay\"] = perms;\r\n    item[\"hasSpecialPermissions\"] = specialPerms;\r\n  }\r\n\r\n  function m_fnBindHandlerPermissionLinks() {\r\n    $(\".permsLink\").click(function () {\r\n      $(this).find(\".permsInfo\").toggleClass(\"collapsed\");\r\n    });\r\n  }\r\n\r\n  function m_fnLoadSPGroupPermissions(OnCompleteLoading) {\r\n    m_arrGroups = new Array();\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    m_collGroup = currCtx.get_web().get_siteGroups();\r\n    currCtx.load(m_collGroup);\r\n\r\n    function OnSuccess1(sender, args) {\r\n      m_arrGroups = new Array();\r\n      var listEnumerator = m_collGroup.getEnumerator();\r\n      while (listEnumerator.moveNext()) {\r\n        var item = listEnumerator.get_current();\r\n        var groupName = item.get_title();\r\n        groupName = $.trim(groupName);\r\n        var groupID = item.get_id();\r\n\r\n        var oGroup = new Object();\r\n        oGroup[\"Title\"] = groupName;\r\n        oGroup[\"ID\"] = groupID;\r\n        oGroup[\"Users\"] = null;\r\n        m_arrGroups.push(oGroup);\r\n      }\r\n\r\n      OnCompleteLoading(true);\r\n    }\r\n    function OnFailure1(sender, args) {\r\n      OnCompleteLoading(true);\r\n    }\r\n    currCtx.executeQueryAsync(OnSuccess1, OnFailure1);\r\n  }\r\n\r\n  /*\tfunction m_fnLoadSPGroupPermissions( OnCompleteLoading )\r\n\t{\r\n\t\tm_arrGroups = new Array();\r\n\t\t\r\n\t\tvar currCtx = new SP.ClientContext.get_current();\r\n\t\tvar web = currCtx.get_web();\r\n\t\t\r\n\t\tm_collGroup = currCtx.get_web().get_siteGroups();\r\n\t    currCtx.load( m_collGroup );\r\n\t   \tcurrCtx.load( m_collGroup, \"Include(Users)\")\r\n\t   \t\r\n\t\tfunction OnSuccess1(sender, args)\r\n\t\t{\r\n\t\t\tm_arrGroups = new Array();\r\n\t\t\tvar listEnumerator = m_collGroup.getEnumerator(); \r\n\t\t\twhile (listEnumerator.moveNext()) \r\n\t\t\t{ \r\n\t\t\t\tvar item = listEnumerator.get_current(); \r\n\t\t\t\tgroupName = item.get_title(); \t\t\t\r\n\t\t\t\tgroupName = $.trim(groupName);\r\n\t\t\t\tgroupID = item.get_id();\r\n\t\r\n\t\t\t\tvar arrPerms = new Array();\r\n\t\t\t\tvar listEnumerator1 = item.get_users().getEnumerator(); \r\n\t\t\t\twhile (listEnumerator1.moveNext()) \r\n\t\t\t\t{\r\n\t\t\t\t\t var item1 = listEnumerator1.get_current();\t\t\t\t\t\t\t \r\n\t\t\t\t\t var displayName = item1.get_loginName();\r\n\t\t\t\t\t arrPerms.push( displayName );\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tarrPerms.sort();\t\t\t\t\t\t\r\n\t\t\t\tvar users = \"\";\r\n\t\t\t\tfor( var g = 0; g < arrPerms.length; g++ )\r\n\t\t\t\t{\r\n\t\t\t\t\t users += arrPerms[g] + \"; \";\t\t\t\t\t\t\t \r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar oGroup = new Object();\r\n\t\t\t\toGroup[\"Title\"] = groupName;\r\n\t\t\t\toGroup[\"ID\"] = groupID;\r\n\t\t\t\toGroup[\"Users\"] = users;\r\n\t\t\t\tm_arrGroups.push( oGroup );\r\n\t\t\t} \r\n\t\t\t\r\n\t\t\tOnCompleteLoading ( true );\r\n\t\t}\r\n\t\tfunction OnFailure1(sender, args)\r\n\t\t{\r\n\t\t\tOnCompleteLoading ( true );\r\n\t\t}\t\t\t\t\r\n\t\tcurrCtx.executeQueryAsync(OnSuccess1, OnFailure1);\t\r\n\t}\r\n*/\r\n  function m_fnDisplaySPGroupPermissions(itemCollection) {\r\n    m_oAOGroupUsers = new Object();\r\n\r\n    $(\"#linkGetVerification\").prop(\"disabled\", true);\r\n\r\n    var aos = Audit.Common.Utilities.GetActionOffices();\r\n    var output = \"\";\r\n    var aoCnt = 0;\r\n    for (var x = 0; x < aos.length; x++) {\r\n      var actionOfficeName = aos[x].title;\r\n      if (actionOfficeName.indexOf(\"Select Action\") > 0) continue;\r\n\r\n      aoCnt++;\r\n\r\n      var groupName = aos[x].userGroup;\r\n      var groupId = \"\";\r\n      var perms = \"\";\r\n\r\n      if (groupName != null && groupName != \"\") {\r\n        for (var y = 0; y < m_arrGroups.length; y++) {\r\n          if (m_arrGroups[y].Title == groupName) {\r\n            groupId = m_arrGroups[y].ID;\r\n            //perms = m_arrGroups[y].Users;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (groupId != \"\")\r\n        output +=\r\n          \"<tr class='trGroup'><td class='removeOnExport'><input class='cbAO' id='cbAO\" +\r\n          x +\r\n          \"' type='checkbox' style='cursor: pointer;'></td><td class='actionOfficeName'>\" +\r\n          actionOfficeName +\r\n          \"</td><td class='groupName' style='white-space:nowrap'><a href='javascript:void(0)' onclick='Audit.Permissions.Report.ViewSitePermissionsGroup(\\\"\" +\r\n          groupId +\r\n          '\",\"' +\r\n          groupName +\r\n          \"\\\")'>\" +\r\n          groupName +\r\n          \"</a></td><td class='groupPerms' id='groupPerms\" +\r\n          x +\r\n          \"' >\" +\r\n          \"</td></tr>\";\r\n      else\r\n        output +=\r\n          \"<tr class='trGroup'><td class='removeOnExport'><input class='cbAO' id='cbAO\" +\r\n          x +\r\n          \"' type='checkbox' style='cursor: pointer;'></td><td class='actionOfficeName'>\" +\r\n          actionOfficeName +\r\n          \"</td><td class='groupName' style='white-space:nowrap'></td><td class='groupPerms' id='groupPerms\" +\r\n          x +\r\n          \"' ></td></tr>\";\r\n    }\r\n\r\n    if (aos.length == 0) {\r\n      output = \"<div>0 Action Groups found</div>\";\r\n    } else {\r\n      $(\"#fbody\").html(output);\r\n      $(\"#spanTotalAOS\").text(aoCnt);\r\n    }\r\n\r\n    $(\".cbAO\").click(function () {\r\n      var count = 0;\r\n      $(\".cbAO\").each(function () {\r\n        if ($(this).is(\":checked\")) {\r\n          count++;\r\n          return;\r\n        }\r\n      });\r\n\r\n      if (count > 0) $(\"#linkGetVerification\").prop(\"disabled\", false);\r\n      else $(\"#linkGetVerification\").prop(\"disabled\", true);\r\n    });\r\n\r\n    var cntGroupsToLoad = 0;\r\n    for (var x = 0; x < aos.length; x++) {\r\n      var actionOfficeName = aos[x].title;\r\n      if (actionOfficeName.indexOf(\"Select Action\") > 0) continue;\r\n\r\n      var groupName = aos[x].userGroup;\r\n      var groupId = null;\r\n      for (var y = 0; y < m_arrGroups.length; y++) {\r\n        if (m_arrGroups[y].Title == groupName) {\r\n          groupId = m_arrGroups[y].ID;\r\n          //perms = m_arrGroups[y].Users;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (groupId != null) {\r\n        cntGroupsToLoad++;\r\n\r\n        var currCtx = new SP.ClientContext.get_current();\r\n        var web = currCtx.get_web();\r\n        var collGroup = web.get_siteGroups();\r\n\r\n        var oGroup = collGroup.getById(groupId);\r\n        var collUser = oGroup.get_users();\r\n        currCtx.load(collUser);\r\n\r\n        var data = { x: x, groupName: groupName, collUser: collUser };\r\n        function onLoadGroupSucceeded() {\r\n          var arrPerms = new Array();\r\n          var listEnumerator1 = this.collUser.getEnumerator();\r\n          while (listEnumerator1.moveNext()) {\r\n            var item1 = listEnumerator1.get_current();\r\n            var displayName =\r\n              item1.get_loginName() + \" (\" + item1.get_title() + \")\";\r\n            arrPerms.push(displayName);\r\n          }\r\n\r\n          arrPerms = arrPerms.sort();\r\n          var users = \"\";\r\n          for (var g = 0; g < arrPerms.length; g++) {\r\n            users += arrPerms[g] + \"; \";\r\n          }\r\n\r\n          $(\"#groupPerms\" + this.x).html(m_fnGetFriendlyUsers(users));\r\n\r\n          m_oAOGroupUsers[this.groupName] = users;\r\n        }\r\n\r\n        function onLoadGroupFailed(sender, args) {}\r\n\r\n        currCtx.executeQueryAsync(\r\n          Function.createDelegate(data, onLoadGroupSucceeded),\r\n          Function.createDelegate(data, onLoadGroupFailed)\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnDisplaySPGroupPermissions2(itemCollection) {\r\n    var aos = Audit.Common.Utilities.GetActionOffices();\r\n    var output = \"\";\r\n\r\n    var arrSPGroups = new Array();\r\n    arrSPGroups.push(m_ownerGroupName);\r\n    arrSPGroups.push(m_memberGroupName);\r\n    arrSPGroups.push(m_visitorGroupName);\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameQA());\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameEA());\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameSpecialPerm1());\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameSpecialPerm2());\r\n\r\n    var spGroupCnt = 0;\r\n    for (var x = 0; x < arrSPGroups.length; x++) {\r\n      spGroupCnt++;\r\n\r\n      var groupName = arrSPGroups[x];\r\n      var groupId = \"\";\r\n      var perms = \"\";\r\n\r\n      for (var y = 0; y < m_arrGroups.length; y++) {\r\n        if (m_arrGroups[y].Title == groupName) {\r\n          groupId = m_arrGroups[y].ID;\r\n          break;\r\n        }\r\n      }\r\n\r\n      output +=\r\n        \"<tr class='trSPGroup'><td class='spgroupName' style='white-space:nowrap'><a href='javascript:void(0)' onclick='Audit.Permissions.Report.ViewSitePermissionsGroup(\\\"\" +\r\n        groupId +\r\n        '\",\"' +\r\n        groupName +\r\n        \"\\\")'>\" +\r\n        groupName +\r\n        \"</a></td><td class='spgroupPerms' id='spgroupPerms\" +\r\n        x +\r\n        \"' >\" +\r\n        \"</td></tr>\";\r\n    }\r\n\r\n    $(\"#fbodySPGroups\").html(output);\r\n\r\n    var cntSPGroupsToLoad = 0;\r\n    for (var x = 0; x < arrSPGroups.length; x++) {\r\n      var groupName = arrSPGroups[x];\r\n      var groupId = null;\r\n      for (var y = 0; y < m_arrGroups.length; y++) {\r\n        if (m_arrGroups[y].Title == groupName) {\r\n          groupId = m_arrGroups[y].ID;\r\n          //perms = m_arrGroups[y].Users;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (groupId != null) {\r\n        cntSPGroupsToLoad++;\r\n\r\n        var currCtx = new SP.ClientContext.get_current();\r\n        var web = currCtx.get_web();\r\n        var collGroup = web.get_siteGroups();\r\n\r\n        var oGroup = collGroup.getById(groupId);\r\n        var collUser = oGroup.get_users();\r\n        currCtx.load(collUser);\r\n\r\n        var data = { x: x, collUser: collUser };\r\n        function onLoadSPGroupSucceeded() {\r\n          var arrPerms = new Array();\r\n          var listEnumerator1 = this.collUser.getEnumerator();\r\n          while (listEnumerator1.moveNext()) {\r\n            var item1 = listEnumerator1.get_current();\r\n            var displayName =\r\n              item1.get_loginName() + \" (\" + item1.get_title() + \")\";\r\n            arrPerms.push(displayName);\r\n          }\r\n\r\n          arrPerms = arrPerms.sort();\r\n          var users = \"\";\r\n          for (var g = 0; g < arrPerms.length; g++) {\r\n            users += arrPerms[g] + \"; \";\r\n          }\r\n\r\n          $(\"#spgroupPerms\" + this.x).html(m_fnGetFriendlyUsers(users));\r\n        }\r\n\r\n        function onLoadSPGroupFailed(sender, args) {}\r\n\r\n        currCtx.executeQueryAsync(\r\n          Function.createDelegate(data, onLoadSPGroupSucceeded),\r\n          Function.createDelegate(data, onLoadSPGroupFailed)\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnFormatEmailBodyToAOForVerification(\r\n    m_txtOutgoingEmailText,\r\n    group,\r\n    users\r\n  ) {\r\n    var emailText =\r\n      m_txtOutgoingEmailText +\r\n      \"<br/>\" +\r\n      \"Please verify the following users for <b>\" +\r\n      group +\r\n      \"</b><br/>\" +\r\n      \"<div>\" +\r\n      users +\r\n      \"</div>\";\r\n\r\n    return emailText;\r\n  }\r\n\r\n  var m_emailCount = 0;\r\n  function m_fnGetVerification() {\r\n    m_txtOutgoingEmailText = \"\";\r\n\r\n    var aos = \"\";\r\n    $(\".trGroup\").each(function () {\r\n      var cb = $(this).find(\"input\");\r\n      if (cb && cb.is(\":checked\")) {\r\n        var group = $.trim($(this).find(\".groupName\").text());\r\n        if (group != null && group != \"\") aos += \"<li>\" + group + \"</li>\";\r\n      }\r\n    });\r\n\r\n    if (aos == \"\") {\r\n      notifyId = SP.UI.Notify.addNotification(\r\n        \"Please select an Action Office\",\r\n        false\r\n      );\r\n      return;\r\n    } else {\r\n      aos = \"<ul style='color:green'>\" + aos + \"</ul>\";\r\n    }\r\n\r\n    var verificationDocDlg =\r\n      \"<div id='verificationDocDlg' style='padding:20px; height:100px'><div style='padding:20px; width:600px'>Are you sure you would like to Email the following Action Offices for Verification?<p style='padding-top:10px'>\" +\r\n      aos +\r\n      \"</p> <p style='padding-top:10px'>If so, please specify any Custom Message to Append to the Outgoing Email Text: </p><p><input id='txtOutgoingEmailText' maxlength='300' size='100' onkeyup='Audit.Permissions.Report.GetEmailText()'></input></p></span></div>\" +\r\n      \"<table style='padding-top:10px; width:400px; margin:0px auto'>\" +\r\n      \"<tr><td><input id='btnClientOk1' type='button' class='ms-ButtonHeightWidth' value='Yes Send Email' onclick='SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK)'/></td>\" +\r\n      \"<td class='ms-separator'>&#160;</td><td><input id='btnCancel' type='button' class='ms-ButtonHeightWidth' value='Close' onclick='SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.cancel)'/></td></tr>\" +\r\n      \"</table></div>\";\r\n\r\n    $(\"body\").append(verificationDocDlg);\r\n\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Email Action Office for User Verification\";\r\n    options.dialogReturnValueCallback = OnCallbackSendVerification;\r\n    options.html = document.getElementById(\"verificationDocDlg\");\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function OnCallbackSendVerification(result, value) {\r\n    if (result === SP.UI.DialogResult.OK) {\r\n      m_waitDialog = SP.UI.ModalDialog.showWaitScreenWithNoClose(\r\n        \"Sending Emails\",\r\n        \"Please wait... Sending Emails\",\r\n        200,\r\n        400\r\n      );\r\n\r\n      setTimeout(function () {\r\n        m_fnSendVerificationEmails();\r\n      }, 1000);\r\n    }\r\n  }\r\n\r\n  function m_fnSendVerificationEmails() {\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var emailList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleEmailHistory());\r\n    var emailListQuery = new SP.CamlQuery();\r\n    emailListQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"ID\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\"/><Value Type=\"Text\">1</Value></Eq></Where></Query></View>'\r\n    );\r\n    var emailListFolderItems = emailList.getItems(emailListQuery);\r\n    currCtx.load(\r\n      emailListFolderItems,\r\n      \"Include(ID, FSObjType, Title, DisplayName)\"\r\n    );\r\n\r\n    function OnSuccess(sender, args) {\r\n      //document.body.style.cursor = 'wait';\r\n\r\n      if (\r\n        !Audit.Common.Utilities.CheckIfEmailFolderExists(\r\n          emailListFolderItems,\r\n          m_emailFolderName\r\n        )\r\n      ) {\r\n        Audit.Common.Utilities.CreateEmailFolder(\r\n          emailList,\r\n          m_emailFolderName,\r\n          null\r\n        );\r\n      }\r\n\r\n      m_emailCount = 0;\r\n      $(\".trGroup\").each(function () {\r\n        var cb = $(this).find(\"input\");\r\n        if (cb && cb.is(\":checked\")) {\r\n          var group = $.trim($(this).find(\".groupName\").text());\r\n          if (group != null && group != \"\") m_emailCount++;\r\n        }\r\n      });\r\n\r\n      if (m_emailCount == 0) {\r\n        notifyId = SP.UI.Notify.addNotification(\r\n          \"Please select an Action Office\",\r\n          false\r\n        );\r\n        //document.body.style.cursor = 'default';\r\n        m_waitDialog.close();\r\n      }\r\n\r\n      var cnt = 0;\r\n      $(\".trGroup\").each(function () {\r\n        var cb = $(this).find(\"input\");\r\n        //var aoName = $.trim( $(this).find(\".actionOfficeName\").text() );\r\n        var group = $.trim($(this).find(\".groupName\").text());\r\n        //var users = $.trim( $(this).find(\".groupPerms\").html() );\r\n\r\n        if (cb && cb.is(\":checked\") && group != null && group != \"\") {\r\n          var users = m_oAOGroupUsers[group];\r\n          users = m_fnGetFriendlyUsers(users); //for some reason, doing this instead of getting .groupperms above outputs correctly in email without extra lines\r\n\r\n          var emailSubject =\r\n            \"Please review the Audit Tool users for (\" + group + \")\";\r\n          var emailText = m_fnFormatEmailBodyToAOForVerification(\r\n            m_txtOutgoingEmailText,\r\n            group,\r\n            users\r\n          );\r\n          var itemCreateInfo = new SP.ListItemCreationInformation();\r\n          itemCreateInfo.set_folderUrl(\r\n            location.protocol +\r\n              \"//\" +\r\n              location.host +\r\n              Audit.Common.Utilities.GetSiteUrl() +\r\n              \"/Lists/\" +\r\n              Audit.Common.Utilities.GetListNameEmailHistory() +\r\n              \"/\" +\r\n              m_emailFolderName\r\n          );\r\n          var oListItemEmail = emailList.addItem(itemCreateInfo);\r\n          oListItemEmail.set_item(\"Title\", emailSubject);\r\n          oListItemEmail.set_item(\"Body\", emailText);\r\n          oListItemEmail.set_item(\"To\", group);\r\n          oListItemEmail.set_item(\"NotificationType\", \"AO Verification\");\r\n          oListItemEmail.update();\r\n\r\n          currCtx.executeQueryAsync(\r\n            function () {\r\n              cnt++;\r\n              if (cnt == m_emailCount) {\r\n                m_waitDialog.close();\r\n                //document.body.style.cursor = 'default';\r\n                notifyId = SP.UI.Notify.addNotification(\r\n                  \"Completed Sending Email Verifications\",\r\n                  false\r\n                );\r\n\r\n                m_fnUncheckCheckboxes();\r\n                //m_fnViewEmailHistoryFolder();\r\n              }\r\n            },\r\n            function (sender, args) {\r\n              //document.body.style.cursor = 'default';\r\n              m_waitDialog.close();\r\n              alert(\r\n                \"Request failed: \" +\r\n                  args.get_message() +\r\n                  \"\\n\" +\r\n                  args.get_stackTrace()\r\n              );\r\n              m_fnRefresh();\r\n            }\r\n          );\r\n        }\r\n      });\r\n    }\r\n    function OnFailure(sender, args) {\r\n      m_waitDialog.close();\r\n    }\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n  }\r\n\r\n  function m_fnCheckCheckboxes() {\r\n    $(\"#linkGetVerification\").prop(\"disabled\", false);\r\n\r\n    $(\".trGroup\").each(function () {\r\n      var cb = $(this).find(\"input\");\r\n      if (cb && !cb.is(\":checked\")) {\r\n        cb.prop(\"checked\", true);\r\n      }\r\n    });\r\n  }\r\n\r\n  function m_fnUncheckCheckboxes() {\r\n    $(\"#linkGetVerification\").prop(\"disabled\", true);\r\n\r\n    $(\".trGroup\").each(function () {\r\n      var cb = $(this).find(\"input\");\r\n      if (cb && cb.is(\":checked\")) {\r\n        cb.prop(\"checked\", false);\r\n      }\r\n    });\r\n  }\r\n\r\n  function m_fnGetFriendlyUsers(perms) {\r\n    if (perms == null || perms == \"\") return \"\";\r\n\r\n    perms = perms.replace(/; /gi, \";\");\r\n    var permArr = perms.split(\";\");\r\n    permArr = permArr.sort();\r\n    var output = \"<ul>\";\r\n    for (var x = 0; x < permArr.length; x++) {\r\n      if (permArr[x] != null && $.trim(permArr[x])) {\r\n        output += \"<li>\" + permArr[x] + \"</li>\";\r\n      }\r\n    }\r\n    output += \"</ul>\";\r\n    return output;\r\n  }\r\n  /*function m_fnDisplaySPGroupPermissions( itemCollection )\r\n\t{\r\n\t\tvar arrGroups = new Array();\r\n\t\tvar listEnumerator = itemCollection.getEnumerator(); \r\n\t\twhile (listEnumerator.moveNext()) \r\n\t\t{ \r\n\t\t\tvar item = listEnumerator.get_current(); \r\n\t\t\tgroupName = item.get_title(); \t\t\t\r\n\t\t\tgroupName = $.trim(groupName);\r\n\t\t\tgroupID = item.get_id();\r\n\r\n\t\t\tvar arrPerms = new Array();\r\n\t\t\tvar listEnumerator1 = item.get_users().getEnumerator(); \r\n\t\t\twhile (listEnumerator1.moveNext()) \r\n\t\t\t{\r\n\t\t\t\t var item1 = listEnumerator1.get_current();\t\t\t\t\t\t\t \r\n\t\t\t\t var displayName = item1.get_loginName();\r\n\t\t\t\t arrPerms.push( displayName );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tarrPerms.sort();\t\t\t\t\t\t\r\n\t\t\tvar users = \"\";\r\n\t\t\tfor( var g = 0; g < arrPerms.length; g++ )\r\n\t\t\t{\r\n\t\t\t\t users += arrPerms[g] + \"; \";\t\t\t\t\t\t\t \r\n\t\t\t}\r\n\r\n\t\t\tvar oGroup = new Object();\r\n\t\t\toGroup[\"Title\"] = groupName;\r\n\t\t\toGroup[\"ID\"] = groupID;\r\n\t\t\toGroup[\"Users\"] = users;\r\n\t\t\tarrGroups.push( oGroup );\r\n\t\t} \r\n\t\t\t\r\n\t\tvar output = \"<table id='table_Groups' class='tablesorter' style='width:800px'><thead><tr><th>SharePoint Group Name</th><th>Users</th></tr></thead><tbody id='fbody'>\";\r\n\t\t\r\n\t\tfor( var x = 0; x < arrGroups.length; x++ )\r\n\t\t{\r\n\t\t\tvar groupName = arrGroups[x].Title;\r\n\t\t\tvar groupId = arrGroups[x].ID;\r\n\t\t\tvar perms = arrGroups[x].Users;\r\n\t\t\t\r\n\t\t\toutput += \"<tr><td class='groupName' style='white-space:nowrap'><a href='javascript:void(0)' onclick='Audit.Permissions.Report.ViewSitePermissionsGroup(\\\"\" + groupId + \"\\\",\\\"\" + groupName + \"\\\")'>\" + groupName + \"</a></td><td id='groupPerms\" + x +\"' >\" + perms + \"</td></tr>\";\r\n\t\t}\r\n\t\toutput += \"</tbody><tfoot><tr><th colspan = '3' style='text-align:left;white-space:nowrap'>Total: \" + arrGroups.length + \"</th></tr></tfoot></table>\";\r\n\t\t\r\n\t\tif( arrGroups.length == 0 )\r\n\t\t{\r\n\t\t\toutput = \"<div>0 Groups found</div>\";\r\n\t\t}\r\n\t\t\r\n\t\t$(\"#divTblOutput\").html( output );\r\n\t}*/\r\n\r\n  function LoadDDOptions() {\r\n    var arrResponseRequestID = new Array();\r\n    var arrResponseTitle = new Array();\r\n\r\n    $(\".request-perm-item-number\").each(function () {\r\n      var val = $(this).text();\r\n      if (!Audit.Common.Utilities.ExistsInArr(arrResponseRequestID, val))\r\n        arrResponseRequestID.push(val);\r\n    });\r\n\r\n    $(\".response-perm-item-title\").each(function () {\r\n      var val = $(this).text();\r\n      if (!Audit.Common.Utilities.ExistsInArr(arrResponseTitle, val))\r\n        arrResponseTitle.push(val);\r\n    });\r\n\r\n    Audit.Common.Utilities.AddOptions(\r\n      arrResponseRequestID,\r\n      \"#ddlResponseRequestID\",\r\n      false\r\n    );\r\n    Audit.Common.Utilities.AddOptions(\r\n      arrResponseTitle,\r\n      \"#ddlResponseFolderResponseID\",\r\n      false\r\n    );\r\n  }\r\n\r\n  function m_fnGoToRequest(requestNumber) {\r\n    notifyId = SP.UI.Notify.addNotification(\r\n      \"Displaying Request (\" + requestNumber + \")\",\r\n      false\r\n    );\r\n\r\n    $(\"#ddlResponseRequestID\").val(requestNumber).change();\r\n\r\n    $(\"#tabs\").tabs({ active: 1 });\r\n  }\r\n\r\n  function m_fnGoToResponse(responseTitle) {\r\n    notifyId = SP.UI.Notify.addNotification(\r\n      \"Displaying Response (\" + responseTitle + \")\",\r\n      false\r\n    );\r\n\r\n    $(\"#ddlResponseFolderResponseID\").val(responseTitle).change();\r\n\r\n    $(\"#tabs\").tabs({ active: 2 });\r\n  }\r\n\r\n  function m_fnBindHandlersOnLoad() {\r\n    m_fnBindPrintButton(\"#btnPrint\", \"#divTblOutput\");\r\n\r\n    /**Note: for the export to work, make sure this is added to the html: <iframe id=\"CsvExpFrame\" style=\"display: none\"></iframe>**/\r\n    m_fnBindExportButton(\".export\", \"GroupPermissions_\", \"table_Groups\");\r\n\r\n    m_fnBindHandlerPermissionLinks();\r\n\r\n    $(\"#ddlRequestID\").change(function () {\r\n      $(\"#ddlResponseRequestID\").val($(this).val());\r\n\r\n      setTimeout(function () {\r\n        FilterRequests();\r\n      }, 10);\r\n    });\r\n\r\n    $(\"#ddlResponseRequestID\").change(function () {\r\n      $(\"#ddlRequestID\").val($(this).val());\r\n\r\n      setTimeout(function () {\r\n        FilterRequests();\r\n      }, 10);\r\n    });\r\n\r\n    $(\"#ddlResponseFolderResponseID\").change(function () {\r\n      setTimeout(function () {\r\n        FilterResponses();\r\n      }, 10);\r\n    });\r\n\r\n    $(\"#linkViewAO\").click(function () {\r\n      m_fnViewAOs();\r\n    });\r\n    $(\"#linkAddAO\").click(function () {\r\n      m_fnAddAO();\r\n    });\r\n\r\n    $(\"#linkUploadPermissions\").click(function () {\r\n      m_fnUploadPermissions();\r\n    });\r\n\r\n    $(\"#linkGetVerification\").click(function () {\r\n      m_fnGetVerification();\r\n    });\r\n\r\n    $(\"#linkEmailHistory\").click(function () {\r\n      m_fnViewEmailHistoryFolder();\r\n    });\r\n\r\n    $(\"#linkViewExportFriendly\").click(function () {\r\n      $(\".removeOnExport\").toggle();\r\n\r\n      $(\".groupPerms\").each(function () {\r\n        if ($(this).html().toLowerCase().indexOf(\"<ul>\") >= 0) {\r\n          var friendlyNames = \"\";\r\n\r\n          $(this)\r\n            .find(\"LI\")\r\n            .each(function () {\r\n              var curText = $(this).text();\r\n              var index = curText.indexOf(\"(\");\r\n              if (index >= 0) curText = curText.substring(0, index);\r\n              curText = $.trim(curText);\r\n\r\n              friendlyNames += curText + \";\";\r\n            });\r\n\r\n          $(this).html(friendlyNames);\r\n        }\r\n      });\r\n    });\r\n\r\n    $(\"#cbAOAll\").click(function () {\r\n      if ($(this).is(\":checked\")) m_fnCheckCheckboxes();\r\n      else m_fnUncheckCheckboxes();\r\n    });\r\n  }\r\n\r\n  function m_fnViewAOs() {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"View Action Office Details\";\r\n    //options.height = \"800\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/lists/\" +\r\n      Audit.Common.Utilities.GetListNameActionOffices();\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnAddAO() {\r\n    var formName = \"NewForm.aspx\";\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Add Action Office\";\r\n    //options.height = \"800\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/lists/\" +\r\n      Audit.Common.Utilities.GetListNameActionOffices() +\r\n      \"/\" +\r\n      formName;\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  //Captures the values from all of the drop downs and uses them to filter the rows\r\n  function FilterRequests() {\r\n    var requestID = $(\"#ddlRequestID\").val();\r\n\r\n    //each row in the data form web part is marked with this class; it iterates through each to find the containing class to see if it matches\r\n    //the value that has been selected in the drop down\r\n    $(\".request-perm-item\").each(function () {\r\n      var hide = false;\r\n\r\n      if (\r\n        !hide &&\r\n        requestID != \"\" &&\r\n        $.trim($(this).find(\".request-perm-item-number\").text()) != requestID\r\n      ) {\r\n        hide = true;\r\n      }\r\n\r\n      if (hide) $(this).hide();\r\n      else $(this).show();\r\n    });\r\n\r\n    //each row in the data form web part is marked with this class; it iterates through each to find the containing class to see if it matches\r\n    //the value that has been selected in the drop down\r\n    $(\".response-perm-item\").each(function () {\r\n      var hide = false;\r\n\r\n      if (\r\n        !hide &&\r\n        requestID != \"\" &&\r\n        $.trim($(this).find(\".response-perm-item-number\").text()) != requestID\r\n      ) {\r\n        hide = true;\r\n      }\r\n\r\n      if (hide) $(this).hide();\r\n      else $(this).show();\r\n    });\r\n  }\r\n\r\n  //Captures the values from all of the drop downs and uses them to filter the rows\r\n  function FilterResponses() {\r\n    var responseTitle = $(\"#ddlResponseFolderResponseID\").val();\r\n\r\n    //each row in the data form web part is marked with this class; it iterates through each to find the containing class to see if it matches\r\n    //the value that has been selected in the drop down\r\n    $(\".responseFolder-perm-item\").each(function () {\r\n      var hide = false;\r\n\r\n      if (\r\n        !hide &&\r\n        responseTitle != \"\" &&\r\n        $.trim($(this).find(\".responseFolder-perm-item-title\").text()) !=\r\n          responseTitle\r\n      ) {\r\n        hide = true;\r\n      }\r\n\r\n      if (hide) $(this).hide();\r\n      else $(this).show();\r\n    });\r\n  }\r\n\r\n  function m_fnBindPrintButton(btnPrint, divTbl) {\r\n    var pageTitle = \"Audit Site Group Permissions (SharePoint Site)\";\r\n    $(btnPrint).on(\"click\", function () {\r\n      PrintPage(pageTitle, divTbl);\r\n    });\r\n  }\r\n\r\n  function m_fnBindExportButton(btnExport, fileNamePrefix, tbl) {\r\n    $(btnExport).on(\"click\", function (event) {\r\n      var curDate = new Date().format(\"yyyyMMdd\");\r\n      ExportToCsv(fileNamePrefix + curDate, tbl);\r\n    });\r\n  }\r\n\r\n  //This function will grab the html from the container var to display in a new window.\r\n  //It also loads the css files that are on the current page and appends it to the output that is displayed in a new window to maintain the styles\r\n  function PrintPage(title, container) {\r\n    var curDate = new Date();\r\n    var cssLink1 =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/siteassets/css/tablesorter/style.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink2 =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/siteassets/css/audit_styles.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink3 =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/siteassets/css/audit_page_reports.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n\r\n    var divOutput = $(container).html();\r\n\r\n    var printDateString = curDate.format(\"MM/dd/yyyy hh:mm tt\");\r\n    printDateString =\r\n      \"<div style='padding-bottom:10px;'>\" + printDateString + \"</div>\";\r\n    divOutput = printDateString + divOutput;\r\n\r\n    var cssFile1 = $(\"<div></div>\");\r\n    var cssFile2 = $(\"<div></div>\");\r\n    var cssFile3 = $(\"<div></div>\");\r\n\r\n    var def1 = $.Deferred();\r\n    var def2 = $.Deferred();\r\n    var def3 = $.Deferred();\r\n\r\n    var cssFileText = \"\";\r\n    cssFile1.load(cssLink1, function () {\r\n      cssFileText += \"<style>\" + cssFile1.html() + \"</style>\";\r\n      def1.resolve();\r\n    });\r\n    cssFile2.load(cssLink2, function () {\r\n      cssFileText += \"<style>\" + cssFile2.html() + \"</style>\";\r\n      def2.resolve();\r\n    });\r\n    cssFile3.load(cssLink3, function () {\r\n      cssFileText += \"<style>\" + cssFile3.html() + \"</style>\";\r\n      def3.resolve();\r\n    });\r\n\r\n    $.when(def1, def2, def3).done(function () {\r\n      var html =\r\n        \"<HTML>\\n\" +\r\n        \"<HEAD>\\n\\n\" +\r\n        \"<Title>\" +\r\n        title +\r\n        \"</Title>\\n\" +\r\n        cssFileText +\r\n        \"\\n\" +\r\n        \"<style>\" +\r\n        \".hideOnPrint {display:none}\" +\r\n        \"</style>\\n\" +\r\n        \"</HEAD>\\n\" +\r\n        \"<BODY>\\n\" +\r\n        divOutput +\r\n        \"\\n\" +\r\n        \"</BODY>\\n\" +\r\n        \"</HTML>\";\r\n\r\n      var printWP = window.open(\"\", \"printWebPart\");\r\n      printWP.document.open();\r\n      //insert content\r\n      printWP.document.write(html);\r\n\r\n      printWP.document.close();\r\n      //open print dialog\r\n      printWP.print();\r\n    });\r\n  }\r\n  //make sure iframe with id csvexprframe is added to page up top\r\n  //http://stackoverflow.com/questions/18185660/javascript-jquery-exporting-data-in-csv-not-working-in-ie\r\n  function ExportToCsv(fileName, tableName, removeHeader) {\r\n    var data = GetCellValues(tableName);\r\n    if (removeHeader == true) data = data.slice(1);\r\n\r\n    var csv = ConvertToCsv(data);\r\n    if (navigator.userAgent.search(\"Trident\") >= 0) {\r\n      window.CsvExpFrame.document.open(\"text/html\", \"replace\");\r\n      window.CsvExpFrame.document.write(csv);\r\n      window.CsvExpFrame.document.close();\r\n      window.CsvExpFrame.focus();\r\n      window.CsvExpFrame.document.execCommand(\r\n        \"SaveAs\",\r\n        true,\r\n        fileName + \".csv\"\r\n      );\r\n    } else {\r\n      var uri = \"data:text/csv;charset=utf-8,\" + escape(csv);\r\n      var downloadLink = document.createElement(\"a\");\r\n      downloadLink.href = uri;\r\n      downloadLink.download = fileName + \".csv\";\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n    }\r\n  }\r\n\r\n  function GetCellValues(tableName) {\r\n    var table = document.getElementById(tableName);\r\n\r\n    var tableArray = [];\r\n    for (var r = 0, n = table.rows.length; r < n; r++) {\r\n      tableArray[r] = [];\r\n      for (var c = 0, m = table.rows[r].cells.length; c < m; c++) {\r\n        var text =\r\n          table.rows[r].cells[c].textContent ||\r\n          table.rows[r].cells[c].innerText;\r\n        tableArray[r][c] = text.trim();\r\n      }\r\n    }\r\n    return tableArray;\r\n  }\r\n\r\n  function ConvertToCsv(objArray) {\r\n    var array = typeof objArray != \"object\" ? JSON.parse(objArray) : objArray;\r\n    var str = \"sep=,\\r\\n\";\r\n    var line = \"\";\r\n    var index;\r\n    var value;\r\n    for (var i = 0; i < array.length; i++) {\r\n      line = \"\";\r\n      var array1 = array[i];\r\n      for (index in array1) {\r\n        if (array1.hasOwnProperty(index)) {\r\n          value = array1[index] + \"\";\r\n          line += '\"' + value.replace(/\"/g, '\"\"') + '\",';\r\n        }\r\n      }\r\n      line = line.slice(0, -1);\r\n      str += line + \"\\r\\n\";\r\n    }\r\n    return str;\r\n  }\r\n\r\n  function m_fnViewSitePermissionsGroup(groupID, groupName) {\r\n    ///The call back on this does not refresh the page BECAUSE if you add/remove a user on that dialog with the group users, it will try to refresh and it will look\r\n    //odd. so don't refresh here.\r\n    /*var options = SP.UI.$create_DialogOptions();\t\r\n\t\toptions.title = \"View Site Permissions on Group \" + groupName;\r\n\t\t//options.dialogReturnValueCallback = OnCallbackFormNoRefresh;\r\n\t\toptions.url = Audit.Common.Utilities.GetSiteUrl() + \"/_layouts/people.aspx?MembershipGroupId=\" + groupID;\r\n\r\n\t\tSP.UI.ModalDialog.showModalDialog(options);*/\r\n\r\n    //doing it this way instead because on add new user, it keeps redirecting to permissions page\r\n    var vPermGroup = window.open(\r\n      location.protocol +\r\n        \"//\" +\r\n        location.host +\r\n        Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/_layouts/people.aspx?MembershipGroupId=\" +\r\n        groupID +\r\n        \"&IsDlg=1\"\r\n    ); //pass isdlg so that it hides left nav\r\n    //vPermGroup.document.title = groupName;\r\n\r\n    setTimeout(function () {\r\n      vPermGroup.document.title = \"Group: \" + groupName;\r\n    }, 2000);\r\n  }\r\n\r\n  function m_fnViewEmailHistoryFolder() {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"View Email History\";\r\n    //options.height = \"600\";\r\n    //options.width = \"900\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/pages/AuditEmailHistory.aspx?RootFolder=\" +\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/Lists/\" +\r\n      Audit.Common.Utilities.GetListNameEmailHistory() +\r\n      \"/\" +\r\n      m_emailFolderName;\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnUploadPermissions() {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Upload Permissions\";\r\n    options.height = \"800\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() + \"/pages/AuditUpdateSiteGroups.aspx\";\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function OnCallbackFormNoRefresh(result, value) {\r\n    //do nothing\r\n  }\r\n\r\n  function OnCallbackFormAutoRefresh(result, value) {\r\n    m_fnRefresh();\r\n  }\r\n\r\n  function OnCallbackForm(result, value) {\r\n    if (result === SP.UI.DialogResult.OK) {\r\n      m_fnRefresh();\r\n    }\r\n  }\r\n\r\n  var publicMembers = {\r\n    GoToRequest: function (requestNum) {\r\n      m_fnGoToRequest(requestNum);\r\n    },\r\n    GoToResponse: function (responseTitle) {\r\n      m_fnGoToResponse(responseTitle);\r\n    },\r\n    ViewSitePermissionsGroup: function (groupID, groupName) {\r\n      m_fnViewSitePermissionsGroup(groupID, groupName);\r\n    },\r\n    GetEmailText: function () {\r\n      m_txtOutgoingEmailText = $(\"#txtOutgoingEmailText\").val();\r\n      /*if( $.trim(m_txtOutgoingEmailText) == \"\" )\r\n\t\t\t\t$(\"#btnClientOk1\").attr(\"disabled\",\"disabled\");\r\n\t\t\telse\r\n\t\t\t\t$(\"#btnClientOk1\").removeAttr(\"disabled\");*/\r\n      return m_txtOutgoingEmailText;\r\n    },\r\n    Refresh: m_fnRefresh,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n"],
  "mappings": "MAAC,IAAMA,GAAO,OAAO,IAERC,GAAsBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;ECFlC,OAAO,MAAQ,OAAO,OAAS,CAAC,EACjC,MAAM,OAAS,MAAM,QAAU,CAAC,EAEhC,SAASE,IAAa,CACpB,MAAM,OAAO,UAAY,IAAI,MAAM,OAAO,aAC1C,MAAM,OAAO,KAAK,CACpB,CAEA,MAAM,OAAO,KAAO,UAAY,CAAC,EAEjC,MAAM,OAAO,aAAe,UAAY,CACtC,IAAIC,EAAY,mBAAmB,qBAE/BC,EAAsB,gBACtBC,GAAqB,gBAErBC,EAA8B,wBAC9BC,EAA6B,wBAE7BC,EAAuB,iBACvBC,EAAsB,iBAEtBC,EAAwB,mBACxBC,EAAuB,mBAEvBC,EAAuB,mBACvBC,EAAsB,mBAEtBC,EAAyB,oBACzBC,EAAwB,oBAExBC,GAA2B,sBAC3BC,EAA0B,sBAE1BC,GAA2B,qBAC3BC,GAA0B,qBAE1BC,GAA0B,cAC1BC,GAAyB,cAEzBC,EAA2B,qBAC3BC,GAA0B,qBAE1BC,GAA6B,uBAC7BC,GAA4B,uBAE5BC,GAA8B,uBAC9BC,GAA8B,uBAC9BC,GAAgB,oBAChBC,EAAgB,oBAEhBC,GAA+B,KAE/BC,EAAkB,KAClBC,EAAW,KAMf,SAASC,GAAYC,EAAO,GAAO,CACjC,GAAIA,EAAM,CACR,SAAS,KAAO,SAAS,SACzB,MACF,CACA,IAAIC,EAAU,SAAS,SAEvB,GAAI,EAAE,OAAO,EAAE,KAAK,GAAK,MAAQ,EAAE,OAAO,EAAE,KAAK,GAAK,GAAI,CACxD,IAAIC,EAAW,EACf,GAAI,CACFA,EAAW,EAAE,OAAO,EAAE,KAAK,SAAU,QAAQ,CAC/C,MAAa,CAAC,CAId,GAFAD,GAAW,QAAUC,EAEjBA,GAAY,GAAK,EAAE,kBAAkB,EAAE,IAAI,GAAK,GAClDD,GAAW,WAAa,EAAE,kBAAkB,EAAE,IAAI,UACzCC,GAAY,EAAG,CACxB,IAAIC,EAAkB,EAAE,mBAAmB,EAAE,IAAI,EAC7CC,EAAuB,EAAE,wBAAwB,EAAE,IAAI,EAEvDD,GAAmB,MAAQA,GAAmB,GAChDF,GAAW,WAAaE,EACjBC,GAAwB,MAAQA,GAAwB,KAC/DH,GAAW,WAAaG,EAC5B,CAEA,SAAS,KAAOH,CAClB,MACE,SAAS,OAAO,CAEpB,CAEA,SAASI,IAA6B,CACpC,IAAIC,EAAU,IAAI,KAClB,EAAE,aAAa,EAAE,KAAK,aAAeA,EAAQ,OAAO,qBAAqB,CAAC,CAC5E,CAEA,SAASC,IAAkC,CACzC,IAAIC,EAAgB,eAAe,KAAK,EACpCA,GAAiB,MAAQA,GAAiB,IAC5C,EAAE,OAAO,EAAE,KAAK,SAAU,SAAUA,CAAa,EAGnD,IAAIC,EAAY,GAEZC,EAAmB,eAAe,QAAQ,EAC1CA,GAAoB,MAAQA,GAAoB,KAC9CF,GAAiB,EAEjB,EAAE,kCAAoCE,EAAmB,IAAI,EAC1D,OAAS,IAEZ,EAAE,kBAAkB,EAAE,IAAIA,CAAgB,EAAE,OAAO,EACnDD,EAAY,IAIZ,EAAE,mCAAqCC,EAAmB,IAAI,EAC3D,OAAS,EAEZ,EAAE,mBAAmB,EAAE,IAAIA,CAAgB,EAAE,OAAO,EAEpD,EAAE,wCAA0CA,EAAmB,IAAI,EAChE,OAAS,GAEZ,EAAE,wBAAwB,EAAE,IAAIA,CAAgB,EAAE,OAAO,GAK1DD,GACH,EAAE,mBAAmB,EAAE,KAAK,CAEhC,CAEA,SAASE,GAA0BC,EAAiBC,EAAiB,CACnE,IAAIC,EAAQ,EACRC,EAAU,EACVC,EAAc,EACdC,EAAa,EACbC,EAAa,EAEbC,EAAS,EAAE,mBAAmB,EAElCA,EAAO,KAAK,UAAY,CACtB,IAAIC,EAAY,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,4BAA4B,EAAE,KAAK,CAAC,EACpEC,EAAY,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,qBAAqB,EAAE,KAAK,CAAC,GAG9DA,GAAaT,GAAmBS,GAAaR,KAC7CO,GAAa,QAAUA,GAAa,cAErC,EAAE,IAAI,EAAE,SAAS,aAAa,EAC9BN,IAEIO,GAAaT,EAAiBK,IACzBI,GAAaR,GAAiBK,IAEnCE,GAAa,OAAQL,IAChBK,GAAa,YAAYJ,IAEtC,CAAC,EAEGF,EAAQ,GACV,EAAE,8BAA8B,EAAE,KAChC,wDACEA,EACA,gCACJ,EAEIG,EAAa,GAAKC,GAAc,EAClC,EAAE,oBAAoB,EAAE,IAAIN,CAAe,EAAE,OAAO,EAC7CM,EAAa,GAAKD,GAAc,GACvC,EAAE,oBAAoB,EAAE,IAAIJ,CAAe,EAAE,OAAO,GAEtD,EAAE,8BAA8B,EAAE,KAChC,6FACF,CACJ,CAEA,SAASS,GAAmBC,EAAU,CACpC1B,EAAkB,IAAI,MAGtB,QADI2B,EAAqBD,EAAS,cAAc,EACzCC,EAAmB,SAAS,GAAG,CACpC,IAAIC,EAAYD,EAAmB,YAAY,EAE3CE,EAAKD,EAAU,OAAO,EACtBE,EAAYF,EAAU,cAAc,EACpCG,EAAQH,EAAU,UAAU,EAE5BI,EAAc,IAAI,OACtBA,EAAY,GAAQH,EACpBG,EAAY,UAAeF,EAC3BE,EAAY,MAAWD,EACvBC,EAAY,MAAWJ,EAEvB5B,EAAgB,KAAKgC,CAAW,CAClC,CACF,CAEA,SAASC,GAAmBC,EAAW,CACrC,IAAIC,EAAY,KAChB,GAAInC,GAAmB,MACrB,QAASoC,EAAI,EAAGA,EAAIpC,EAAgB,OAAQoC,IAC1C,GAAIpC,EAAgBoC,CAAC,EAAE,OAASF,EAAW,CACzCC,EAAYnC,EAAgBoC,CAAC,EAAE,MAC/B,KACF,EAGJ,OAAOD,CACT,CAEA,SAASE,GAAsBX,EAAU,CACvCzB,EAAW,IAAI,MAGf,QADI0B,EAAqBD,EAAS,cAAc,EACzCC,EAAmB,SAAS,GAAG,CACpC,IAAIC,EAAYD,EAAmB,YAAY,EAE3CE,EAAKD,EAAU,SAAS,IAAI,EAC5BG,EAAQH,EAAU,SAAS,OAAO,EAClCO,EAAYP,EAAU,SAAS,WAAW,EAC1CO,GAAa,KACfA,EAAYA,EAAU,gBAAgB,EACjCA,EAAY,GAEnB,IAAIG,EAAW,IAAI,OACnBA,EAAS,GAAQT,EACjBS,EAAS,MAAWP,EACpBO,EAAS,UAAeH,EAExBlC,EAAS,KAAKqC,CAAQ,CACxB,CACF,CAEA,SAASC,GAAqBL,EAAW,CAEvC,IAAIC,EAAY,KAChB,GAAIlC,GAAY,KACd,QAASmC,EAAI,EAAGA,EAAInC,EAAS,OAAQmC,IAAK,CACxC,IAAII,EAASvC,EAASmC,CAAC,EACvB,GAAII,EAAO,OAASN,EAAW,CAC7BC,EAAYK,EAAO,UACnB,KACF,CACF,CAEF,OAAOL,CACT,CAEA,SAASM,GAAkCC,EAAMR,EAAWS,EAAiB,CAC3E,GACED,GAAQ,MACRR,GAAa,IACbA,GAAa,MACbS,GAAmB,KAEnB,MAAO,GAET,IAAIC,EAAQ,GACRC,EAAkBH,EAAK,oBAAoB,EAC/C,GAAIG,GAAmB,KACrB,aAAM,mCAAmC,EAClC,GAIT,QADIC,EAAkBD,EAAgB,cAAc,EAC7CC,EAAgB,SAAS,GAAG,CACjC,IAAIC,EAAOD,EAAgB,YAAY,EACvC,GAAIC,GAAQ,KAAM,CAChB,IAAIC,EAAaD,EAAK,WAAW,EACjC,GAAIC,EAAW,oBAAoB,OAAO,EAAG,CAC3C,IAAIC,EAAkBD,EAAW,UAAU,EAEvCE,EAAWH,EAAK,2BAA2B,EAC/C,GAAIG,GAAY,KAEd,QADIC,EAAqBD,EAAS,cAAc,EACzCC,EAAmB,SAAS,GAAG,CACpC,IAAIC,EAAKD,EAAmB,YAAY,EACpCE,EAASD,EAAG,SAAS,EAEzB,GACEH,GAAmBf,GACnBkB,EAAG,oBAAoB,EAAE,IAAIT,CAAe,EAC5C,CACAC,EAAQ,GACR,KACF,CACF,CAEJ,CACF,CACF,CACA,OAAOA,CACT,CAEA,SAASU,GAAiBC,EAAeC,EAAM,CAC7C,GAAI,CAACA,EAAM,CACT,IAAIC,EAAS,GACb,EAAE,4BAA4B,EAAE,KAAK,UAAY,CAC/C,GAAI,EAAE,IAAI,EAAE,KAAK,GAAKF,EACpB,OAAAE,EAAS,GACT,SAAW,GAAG,GAAG,OAAO,gBACtB,wBAA0BF,EAAgB,IAC1C,EACF,EACA,EAAE,mBAAmB,EAAE,IAAIA,CAAa,EAAE,OAAO,EAE1C,EAEX,CAAC,EACIE,GACH,EAAE,iCAAiC,EAAE,KAAK,UAAY,CACpD,GAAI,EAAE,IAAI,EAAE,KAAK,GAAKF,EACpB,OAAAE,EAAS,GACT,SAAW,GAAG,GAAG,OAAO,gBACtB,wBAA0BF,EAAgB,IAC1C,EACF,EACA,EAAE,wBAAwB,EAAE,IAAIA,CAAa,EAAE,OAAO,EAE/C,EAEX,CAAC,EAGH,EAAE,OAAO,EAAE,KAAK,CAAE,OAAQ,CAAE,CAAC,CAC/B,CACF,CAEA,SAASG,GAA4BC,EAAgB,CACnD,IAAIC,EAAW,CAAC,EAChB,OAAID,GAAkB,WACpBC,EAAW,CAAE,mBAAoB,WAAY,EACtCD,GAAkB,WACzBC,EAAW,CAAE,mBAAoB,WAAY,EACtCD,GAAkB,WACzBC,EAAW,CAAE,mBAAoB,aAAc,EACxCD,GAAkB,aACzBC,EAAW,CAAE,mBAAoB,WAAY,EACtCD,GAAkB,YACzBC,EAAW,CAAE,mBAAoB,cAAe,EACzCD,GAAkB,wBACzBC,EAAW,CACT,mBAAoB,YACpB,aAAc,QAChB,GACKA,CAET,CAEA,SAASC,GAA2BF,EAAgB,CAClD,IAAIC,EAAW,GAEf,OAAID,GAAkB,WACpBC,EAAW,wCACJD,GAAkB,WACzBC,EAAW,wCACJD,GAAkB,WACzBC,EAAW,0CACJD,GAAkB,aACzBC,EAAW,wCACJD,GAAkB,YACzBC,EAAW,2CACJD,GAAkB,wBACzBC,EACE,4GAEGA,CACT,CAEA,SAASE,GAA6BC,EAAOC,EAAe,CAI1D,QAFIC,EAAgB,GAChBtC,EAAqBoC,EAAM,cAAc,EACtCpC,EAAmB,SAAS,GAAG,CACpC,IAAIuC,EAAavC,EAAmB,YAAY,EAC5CwC,EAAWD,EAAW,gBAAgB,EAC1C,GAAIC,GAAYH,EAAe,CAC7B,IAAIC,EAAgB,GACpB,KACF,CACF,CACA,OAAOA,CACT,CAEA,IAAIG,EAAwB,EACxBC,EAA0B,EAE9B,SAASC,GAAsBC,EAAMP,EAAeQ,EAAaC,EAAY,CAC3EL,EAAwB,EACxBC,EAA0B,EAE1B,IAAIK,EAAU,IAAI,GAAG,cAAc,YAC/BC,EAAMD,EAAQ,QAAQ,EAEtBE,EAAiB,IAAI,GAAG,4BAC5BA,EAAe,yBAAyB,GAAG,qBAAqB,MAAM,EACtEA,EAAe,aAAaZ,CAAa,EACzC,gBAAkBO,EAAK,QAAQK,CAAc,EAC7C,gBAAgB,SAAS,QAASZ,CAAa,EAC/C,gBAAgB,OAAO,EAEvB,KAAK,YAAcW,EAAI,gBAAgB,EACvC,KAAK,WAAaA,EAAI,yBAAyB,EAC/C,KAAK,YAAcA,EAAI,0BAA0B,EACjD,KAAK,aAAeA,EAAI,2BAA2B,EAEnD,gBAAgB,qBAAqB,EACrC,gBAAgB,qBAAqB,GAAO,EAAK,EAEjD,IAAIE,EACF,GAAG,gCAAgC,UAAUH,CAAO,EACtDG,EAAwB,IACtBF,EAAI,oBAAoB,EAAE,UAAU,GAAG,SAAS,aAAa,CAC/D,EAEA,IAAIG,EACF,GAAG,gCAAgC,UAAUJ,CAAO,EACtDI,EAA6B,IAC3BH,EAAI,oBAAoB,EAAE,UAAU,GAAG,SAAS,WAAW,CAC7D,EAEA,IAAII,EACF,GAAG,gCAAgC,UAAUL,CAAO,EACtDK,EAAiC,IAC/BJ,EAAI,oBAAoB,EAAE,UAAU,iBAAiB,CACvD,EAEA,IAAIK,EACF,GAAG,gCAAgC,UAAUN,CAAO,EACtDM,EAAuC,IACrCL,EAAI,oBAAoB,EAAE,UAAU,uBAAuB,CAC7D,EAGA,gBACG,oBAAoB,EACpB,IAAI,WAAYE,CAAuB,EAC1C,gBACG,oBAAoB,EACpB,IAAI,YAAaC,CAA4B,EAChD,gBACG,oBAAoB,EACpB,IAAI,aAAcC,CAAgC,EAErD,IAAIE,EAAY,MAAM,OAAO,UAAU,eACrC,MAAM,OAAO,UAAU,eAAe,CACxC,EACIA,GAAa,MACf,gBACG,oBAAoB,EACpB,IAAIA,EAAWD,CAAsC,EAE1D,gBACG,oBAAoB,EACpB,eAAe,WAAW,EAC1B,aAAa,EAGhB,SAASE,GAAyB,CAChC,GAAI,KAAK,YAAa,CAGpB,IAAIC,EAAkB,KAAK,YAAY,SAAS,cAAc,EAC9D,GAAIA,GAAmB,MAAQA,EAAgB,QAAU,EAAG,CACtD,KAAK,YAAY,KAAK,WAAW,EAAI,EACzC,MACF,CAEA,QAAS/C,EAAI,EAAGA,EAAI+C,EAAgB,OAAQ/C,IAAK,CAC/C,IAAIgD,GAAmBD,EAAgB/C,CAAC,EAAE,gBAAgB,EAEtDiD,GACF,MAAM,OAAO,UAAU,iBAAiBD,EAAgB,EACtDE,GAAoB,MAAM,OAAO,UAAU,eAC7CD,EACF,EAEA,GAAIC,IAAqB,KAAM,CAgB7B,IAASC,GAAT,UAAoC,CAClClB,IACIA,GAA2BD,GACzB,KAAK,YAAY,KAAK,WAAW,EAAI,CAE7C,EACSoB,GAAT,SAA+BC,GAAQC,GAAM,CAC3CrB,IACIA,GAA2BD,GACzB,KAAK,YAAY,KAAK,WAAW,EAAI,CAE7C,EAXS,IAAAmB,MAMAC,MArBTpB,IAEA,IAAIuB,GAAW,IAAI,GAAG,cAAc,YAChCC,GAAOD,GAAS,QAAQ,EAExBX,GACF,GAAG,gCAAgC,UAAUW,EAAQ,EACvDX,GAAuC,IACrCY,GAAK,oBAAoB,EAAE,UAAU,uBAAuB,CAC9D,EAEA,KAAK,gBACF,oBAAoB,EACpB,IAAIN,GAAmBN,EAAsC,EAchE,IAAIa,GAAO,CAAE,WAAY,KAAK,UAAW,EACzCF,GAAS,kBACP,SAAS,eAAeE,GAAMN,EAAwB,EACtD,SAAS,eAAeM,GAAML,EAAqB,CACrD,CACF,CACF,CACF,MACM,KAAK,YAAY,KAAK,WAAW,EAAI,CAE7C,CAEA,SAASM,EAAoBL,EAAQC,EAAM,CACzC,SAAW,GAAG,GAAG,OAAO,UACtB,mBAAqBA,EAAK,YAAY,EAAI;AAAA,EAAOA,EAAK,eAAe,CACvE,CACF,CAEA,IAAIG,EAAO,CACa,YAAarB,EACnC,gBACA,WAAYC,CACd,EACAC,EAAQ,kBACN,SAAS,eAAemB,EAAMX,CAAsB,EACpD,SAAS,eAAeW,EAAMC,CAAmB,CACnD,CACF,CAEA,SAASC,GAA4BC,EAAGC,EAAG,CACzC,IAAIC,EAASF,EACTG,EAASF,EACb,IAAIG,EAAMC,EAENH,GAAU,OAAMA,EAAS,IACzBC,GAAU,OAAMA,EAAS,IAE7B,IAAIG,EAASJ,EAAO,YAAY,GAAG,EACnC,GAAII,GAAU,EAAG,CACf,IAAIC,EAAOL,EAAO,UAAU,EAAGI,EAAS,CAAC,EACrCE,EAAQN,EAAO,QAAQK,EAAM,EAAE,EAC/BE,EAAO,SAASD,EAAO,EAAE,EACzBE,EAAU,MAAM,OAAO,UAAU,UAAUD,EAAM,CAAC,EACtDL,EAAOG,EAAOG,CAChB,MAAON,EAAOF,EAEd,IAAIS,EAASR,EAAO,YAAY,GAAG,EACnC,GAAIQ,GAAU,EAAG,CACf,IAAIC,EAAOT,EAAO,UAAU,EAAGQ,EAAS,CAAC,EACrCE,EAAQV,EAAO,QAAQS,EAAM,EAAE,EAC/BE,EAAO,SAASD,EAAO,EAAE,EACzBE,EAAU,MAAM,OAAO,UAAU,UAAUD,EAAM,CAAC,EACtDT,EAAOO,EAAOG,CAChB,MAAOV,EAAOF,EAEd,OAAOC,EAAK,YAAY,EAAE,cAAcC,EAAK,YAAY,CAAC,CAC5D,CAEA,SAASW,GAA6BhB,EAAGC,EAAG,CAC1C,IAAIC,EAASF,EAAE,MACXG,EAASF,EAAE,MACXG,EACAC,EACAH,GAAU,OAAMA,EAAS,IACzBC,GAAU,OAAMA,EAAS,IAE7B,IAAIG,EAASJ,EAAO,YAAY,GAAG,EACnC,GAAII,GAAU,EAAG,CACf,IAAIC,EAAOL,EAAO,UAAU,EAAGI,EAAS,CAAC,EACrCE,EAAQN,EAAO,QAAQK,EAAM,EAAE,EAC/BE,EAAO,SAASD,EAAO,EAAE,EACzBE,EAAU,MAAM,OAAO,UAAU,UAAUD,EAAM,CAAC,EACtDL,EAAOG,EAAOG,CAChB,MAAON,EAAOF,EAEd,IAAIS,EAASR,EAAO,YAAY,GAAG,EACnC,GAAIQ,GAAU,EAAG,CACf,IAAIC,EAAOT,EAAO,UAAU,EAAGQ,EAAS,CAAC,EACrCE,EAAQV,EAAO,QAAQS,EAAM,EAAE,EAC/BE,EAAO,SAASD,EAAO,EAAE,EACzBE,EAAU,MAAM,OAAO,UAAU,UAAUD,EAAM,CAAC,EACtDT,EAAOO,EAAOG,CAChB,MAAOV,EAAOF,EAEd,OAAOC,EAAK,YAAY,EAAE,cAAcC,EAAK,YAAY,CAAC,CAC5D,CAEA,SAASY,GAAejB,EAAGC,EAAG,CAC5B,OAAOD,EAAE,YAAY,EAAE,cAAcC,EAAE,YAAY,CAAC,CACtD,CAEA,SAASiB,GAAalB,EAAGC,EAAG,CAC1B,OAAID,GAAK,GAAW,GAChBC,GAAK,GAAW,EACb,IAAI,KAAKD,CAAC,EAAE,QAAQ,EAAI,IAAI,KAAKC,CAAC,EAAE,QAAQ,CACrD,CAGA,SAASkB,GAAeC,EAAKC,EAAOC,EAAUC,EAAc,CAC1D,GAAIH,GAAO,KACX,CAAIG,EAAcH,EAAI,KAAKrB,EAA2B,EAC5CuB,EACLF,EAAI,KAAKF,EAAY,EADNE,EAAI,KAAKH,EAAc,EAG3C,IAAIO,EAAW,IAAI,MACjBC,EAAI,GACND,EAAS,EAAEC,CAAC,EAAI,qCAUhB,QARIC,EAAYN,EAAI,OAQXhF,EAAI,EAAGA,EAAIsF,EAAWtF,IAAK,CAClC,IAAIuF,EAAS,EAAE,KAAKP,EAAIhF,CAAC,CAAC,EAE1BoF,EAAS,EAAEC,CAAC,EAAI,kBAAoBE,EAAS,KAAOA,EAAS,WAO/D,CAKA,IAAIC,EAAU,EAAEP,CAAK,EACrBO,EAAQ,MAAM,EAAE,OAAOJ,EAAS,KAAK,EAAE,CAAC,EAG1C,CAEA,SAASK,GAAgBT,EAAKU,EAAK,CACjC,GAAIV,GAAO,KAAM,MAAO,GAGxB,QADIM,EAAYN,EAAI,OACXhF,EAAI,EAAGA,EAAIsF,EAAWtF,IAC7B,GAAIgF,EAAIhF,CAAC,GAAK0F,EAAK,MAAO,GAE5B,MAAO,EACT,CAEA,SAASC,EAAqBD,EAAK,CACjC,OAAIA,GAAO,GACF,uCAAyCA,EAAM,UAC5C,uCAAyCA,EAAM,SAC7D,CAEA,SAASE,GAA2BpG,EAAWqG,EAAW,CACxD,IAAIC,EAAOtG,EAAU,SAASqG,CAAS,EACvC,OAAIC,GAAQ,KAAa,GACbA,EAAK,gBAAgB,CACnC,CAEA,SAASC,EAAcC,EAAGC,EAAa,CACrCD,EAAIA,EAAE,SAAS,EACf,IAAIE,EAAK,GACT,GAAID,EAAcD,EAAE,OAClB,QAASG,EAAI,EAAGA,EAAIF,EAAcD,EAAE,OAAQG,IAC1CD,GAAM,IAGV,OAAOA,EAAKF,EAAE,SAAS,CACzB,CAEA,SAASI,EAAiBC,EAAKC,EAAU,CACvC,IAAIC,EAAOF,GAAO,EAAI,EAAI,GAC1B,OACE,KAAK,MAAMA,EAAM,KAAK,IAAI,GAAIC,CAAQ,EAAIC,EAAO,IAAK,EACtD,KAAK,IAAI,GAAID,CAAQ,GACrB,QAAQA,CAAQ,CACpB,CAEA,SAASE,EAAwBC,EAAU,CACzC,OAAIA,GAAY,MAAQA,GAAY,GAAW,IAE3CA,EAAW,QACbA,EACE,MAAM,OAAO,UAAU,aAAaA,EAAW,QAAS,CAAC,EAAI,MACtDA,EAAW,KACpBA,EACE,MAAM,OAAO,UAAU,aAAaA,EAAW,KAAM,CAAC,EAAI,MAE5DA,GAAY,KAEPA,EACT,CAEA,SAASC,EAAkBC,EAAG,CAC5B,SAASC,EAAIZ,EAAG,CACd,OAAOA,EAAI,GAAK,IAAMA,EAAIA,CAC5B,CAEA,OACEW,EAAE,eAAe,EACjB,IACAC,EAAID,EAAE,YAAY,EAAI,CAAC,EACvB,IACAC,EAAID,EAAE,WAAW,CAAC,EAClB,IACAC,EAAID,EAAE,YAAY,CAAC,EACnB,IACAC,EAAID,EAAE,cAAc,CAAC,EACrB,IACAC,EAAID,EAAE,cAAc,CAAC,EACrB,GAEJ,CAEA,SAASE,GAA6B,CACpC,EAAE,+BAA+B,EAAE,MAAM,SAAUC,EAAO,CACxDA,EAAM,eAAe,EACrB,IAAIC,EAAU,EAAE,IAAI,EAAE,KAAK,KAAK,EAC5BA,GAAW,6BACb,EAAE,IAAI,EAAE,KAAK,MAAO,2BAA2B,EAC5C,EAAE,IAAI,EAAE,KAAK,MAAO,4BAA4B,EAGrD,EAAE,IAAI,EACH,OAAO,EACP,OAAO,EACP,UAAU,6BAA6B,EACvC,KAAK,UAAY,CAChB,EAAE,IAAI,EAAE,YAAY,WAAW,CACjC,CAAC,CACL,CAAC,CACH,CAoBA,SAASC,EAAuBC,EAAY,CAC1C,OAAI,EAAE,iBAAmBA,EAAa,IAAI,EAAE,KAAK,IAAM,KAC9C,EAAE,iBAAmBA,EAAa,IAAI,EAEtC,EAAE,gBAAkBA,EAAa,IAAI,CAEhD,CAEA,SAASC,EAAyBD,EAAY,CAE5C,OAAI,EAAE,iBAAmBA,EAAa,IAAI,EAAE,KAAK,IAAM,KAC9C,EAAE,iBAAmBA,EAAa,oBAAoB,EAAE,KAAK,EAE7D,EAAE,gBAAkBA,EAAa,IAAI,EAAE,IAAI,CAEtD,CAEA,SAASE,EAAiCtB,EAAWuB,EAAM,CACzD,GAAI,CACF,GAAIA,GAAQ,KAAW,OACvB,IAAIC,EAAYC,EAAiC,SAAU,GAAIzB,CAAS,EAExE,GAAIwB,GAAa,KAAM,CACrB,IAAIE,EAAWD,EAAiC,QAAS,GAAIzB,CAAS,EAEtE,aAAa0B,EAAS,EAAE,EACxB,IAAIC,EAAM,SAAS,eAAeD,EAAS,GAAG,EAC9CE,EAA4BD,EAAKJ,CAAI,EAErC,aAAaI,CAAG,CAClB,MACEC,EAA4BJ,EAAWD,CAAI,CAE/C,MAAa,CAAC,CAChB,CAEA,SAASK,EAA4BC,EAAQN,EAAM,CACjD,IAAIO,EAAOD,EAAO,QACdE,EAAYD,EAAK,OACrB,GAAID,GAAU,KAEd,SAASvB,EAAI,EAAGA,EAAIyB,EAAWzB,IAC7B,GAAIwB,EAAKxB,CAAC,EAAE,MAAQiB,EAClB,OAAAM,EAAO,cAAgBvB,EAChB,GAGX,MAAO,GACT,CAEA,SAASmB,EAAiCO,EAASC,EAAYnI,EAAO,CAGpE,QAFIoI,EAAWD,EAAW,OACtBE,EAAO,SAAS,qBAAqBH,CAAO,EACvC1B,EAAI,EAAGA,EAAI6B,EAAK,OAAQ7B,IAAK,CACpC,IAAI8B,EAAQD,EAAK7B,CAAC,EAAE,GACpB,GACE6B,EAAK7B,CAAC,EAAE,OAASxG,IAChBmI,GAAc,IACbG,EAAM,QAAQH,CAAU,GAAKG,EAAM,OAASF,GAE9C,OAAOC,EAAK7B,CAAC,CAEjB,CACA,OAAO,IACT,CAEA,SAAS+B,EAAoBC,EAAS,CACpC,IAAIC,EAAU,GAAG,GAAG,sBAAsB,EAC1CA,EAAQ,MAAQ,cAChBA,EAAQ,OAAS,IAEbD,GAAW,KACbC,EAAQ,IACN,MAAM,OAAO,UAAU,WAAW,EAClC,kEACAD,EAEFC,EAAQ,IACN,MAAM,OAAO,UAAU,WAAW,EAAI,+BAE1C,GAAG,GAAG,YAAY,gBAAgBA,CAAO,CAC3C,CAEA,SAASC,EAAcC,EAAWC,EAAQ,CACxC,IAAIlK,EAAU,IAAI,KACdmK,EAAU,MAAM,OAAO,UAAU,WAAW,EAC5CC,EACFD,EACA,2CACAnK,EAAQ,OAAO,YAAY,EACzBqK,EACFF,EACA,sCACAnK,EAAQ,OAAO,YAAY,EAEzBsK,EAAY,EAAEJ,CAAM,EAAE,KAAK,EAG3BK,EAAmB,EAAE,OAAO,EAAE,OAAOD,CAAS,EAClDC,EAAiB,KAAK,sBAAsB,EAAE,KAAK,UAAY,CAC7D,EAAE,IAAI,EAAE,WAAW,SAAS,EAC5B,EAAE,IAAI,EAAE,WAAW,MAAM,CAC3B,CAAC,EAEDD,EAAYC,EAAiB,KAAK,EAElC,IAAIC,EAAkBxK,EAAQ,OAAO,qBAAqB,EAC1DwK,EACE,qCAAuCA,EAAkB,SAC3DF,EAAYE,EAAkBF,EAE9B,IAAIG,EAAW,EAAE,aAAa,EAC1BC,EAAW,EAAE,aAAa,EAE1BC,EAAO,EAAE,SAAS,EAClBC,EAAO,EAAE,SAAS,EAElBC,EAAc,GAClBJ,EAAS,KAAKL,EAAU,UAAY,CAClCS,GAAe,UAAYJ,EAAS,KAAK,EAAI,WAC7CE,EAAK,QAAQ,CACf,CAAC,EACDD,EAAS,KAAKL,EAAU,UAAY,CAClCQ,GAAe,UAAYH,EAAS,KAAK,EAAI,WAC7CE,EAAK,QAAQ,CACf,CAAC,EAGD,EAAE,KAAKD,EAAMC,CAAI,EAAE,KAAK,UAAY,CAClC,IAAIE,EACF;AAAA;AAAA;AAAA,SAGAb,EACA;AAAA,EACAY,EACA;AAAA;AAAA;AAAA;AAAA,EAMAP,EACA;AAAA;AAAA,SAIES,EAAU,OAAO,KAAK,GAAI,cAAc,EAC5CA,EAAQ,SAAS,KAAK,EAEtBA,EAAQ,SAAS,MAAMD,CAAI,EAE3BC,EAAQ,SAAS,MAAM,EAEvBA,EAAQ,MAAM,CAChB,CAAC,CACH,CAIA,SAASC,EAAgBC,EAAUC,EAAWC,EAAc,CAC1D,IAAI/F,EAAOgG,EAAkBF,CAAS,EAElCC,GAAgB,KAAM/F,EAAOA,EAAK,MAAM,CAAC,GAE7C,IAAIiG,EAAMC,EAAiBlG,CAAI,EAE/B,GAAI,UAAU,UAAU,OAAO,SAAS,GAAK,EAC3C,OAAO,YAAY,SAAS,KAAK,YAAa,SAAS,EAIvD,OAAO,YAAY,SAAS,MAAMiG,CAAG,EACrC,OAAO,YAAY,SAAS,MAAM,EAClC,OAAO,YAAY,MAAM,EACzB,OAAO,YAAY,SAAS,YAC1B,SACA,GACAJ,EAAW,MACb,MACK,CACL,IAAIM,EAAM,+BAAiC,OAAOF,CAAG,EACjDG,EAAe,SAAS,cAAc,GAAG,EAC7CA,EAAa,KAAOD,EACpBC,EAAa,SAAWP,EAAW,OACnC,SAAS,KAAK,YAAYO,CAAY,EACtCA,EAAa,MAAM,EACnB,SAAS,KAAK,YAAYA,CAAY,CACxC,CACF,CAEA,SAASJ,EAAkBF,EAAW,CACpC,IAAIO,EAAQ,SAAS,eAAeP,CAAS,EAG7C,GAAIO,EAAM,UAAU,QAAQ,YAAY,GAAK,EAAG,CAC9C,IAAIC,EAAQ,EAAE,OAAO,EAAE,OAAOD,EAAM,SAAS,EAC7CC,EAAM,KAAK,aAAa,EAAE,KAAK,UAAY,CACzC,EAAE,IAAI,EAAE,OAAO,CACjB,CAAC,EACDD,EAAQC,EAAM,KAAK,OAAO,EAAE,CAAC,CAC/B,CACA,GAAID,EAAM,UAAU,QAAQ,QAAQ,GAAK,EAAG,CAC1C,IAAIC,EAAQ,EAAE,OAAO,EAAE,OAAOD,EAAM,SAAS,EAC7CC,EAAM,KAAK,SAAS,EAAE,KAAK,UAAY,CACrC,EAAE,IAAI,EAAE,OAAO,CACjB,CAAC,EACDD,EAAQC,EAAM,KAAK,OAAO,EAAE,CAAC,CAC/B,CAGA,QADIC,EAAa,CAAC,EACTC,EAAI,EAAGjE,EAAI8D,EAAM,KAAK,OAAQG,EAAIjE,EAAGiE,IAAK,CACjDD,EAAWC,CAAC,EAAI,CAAC,EACjB,QAASC,EAAI,EAAGC,EAAIL,EAAM,KAAKG,CAAC,EAAE,MAAM,OAAQC,EAAIC,EAAGD,IAAK,CAC1D,IAAI9C,EACF0C,EAAM,KAAKG,CAAC,EAAE,MAAMC,CAAC,EAAE,aACvBJ,EAAM,KAAKG,CAAC,EAAE,MAAMC,CAAC,EAAE,UACzBF,EAAWC,CAAC,EAAEC,CAAC,EAAI9C,EAAK,KAAK,CAC/B,CACF,CACA,OAAO4C,CACT,CAEA,SAASL,EAAiBS,EAAU,CAMlC,QALIC,EAAQ,OAAOD,GAAY,SAAW,KAAK,MAAMA,CAAQ,EAAIA,EAC7DE,EAAM;AAAA,EACNC,EAAO,GACPC,EACAC,EACKtE,EAAI,EAAGA,EAAIkE,EAAM,OAAQlE,IAAK,CACrCoE,EAAO,GACP,IAAIG,EAASL,EAAMlE,CAAC,EACpB,IAAKqE,KAASE,EACRA,EAAO,eAAeF,CAAK,IAC7BC,EAAQC,EAAOF,CAAK,EAAI,GACxBD,GAAQ,IAAME,EAAM,QAAQ,KAAM,IAAI,EAAI,MAG9CF,EAAOA,EAAK,MAAM,EAAG,EAAE,EACvBD,GAAOC,EAAO;AAAA,CAChB,CACA,OAAOD,CACT,CAEA,IAAIK,EAAgB,CAClB,WAAY,UAAY,CACtB,OAAI3O,GAAa,IAAY,GACjBA,CACd,EACA,qBAAsB,UAAY,CAChC,OAAOC,CACT,EACA,oBAAqB,UAAY,CAC/B,OAAOC,EACT,EACA,6BAA8B,UAAY,CACxC,OAAOC,CACT,EACA,4BAA6B,UAAY,CACvC,OAAOC,CACT,EACA,sBAAuB,UAAY,CACjC,OAAOC,CACT,EACA,qBAAsB,UAAY,CAChC,OAAOC,CACT,EACA,uBAAwB,UAAY,CAClC,OAAOC,CACT,EACA,sBAAuB,UAAY,CACjC,OAAOC,CACT,EACA,uBAAwB,UAAY,CAClC,OAAOC,CACT,EACA,sBAAuB,UAAY,CACjC,OAAOC,CACT,EACA,wBAAyB,UAAY,CACnC,OAAOC,CACT,EACA,uBAAwB,UAAY,CAClC,OAAOC,CACT,EACA,0BAA2B,UAAY,CACrC,OAAOC,EACT,EACA,yBAA0B,UAAY,CACpC,OAAOC,CACT,EACA,0BAA2B,UAAY,CACrC,OAAOC,EACT,EACA,yBAA0B,UAAY,CACpC,OAAOC,EACT,EACA,yBAA0B,UAAY,CACpC,OAAOC,EACT,EACA,wBAAyB,UAAY,CACnC,OAAOC,EACT,EACA,0BAA2B,UAAY,CACrC,OAAOC,CACT,EACA,yBAA0B,UAAY,CACpC,OAAOC,EACT,EACA,4BAA6B,UAAY,CACvC,OAAOC,EACT,EACA,2BAA4B,UAAY,CACtC,OAAOC,EACT,EACA,yBAA0B,UAAY,CACpC,OAAOC,EACT,EACA,yBAA0B,UAAY,CACpC,OAAOC,EACT,EACA,eAAgB,UAAY,CAC1B,OAAOC,EACT,EACA,eAAgB,UAAY,CAC1B,OAAOC,CACT,EACA,QAASI,GACT,uBAAwBM,GACxB,4BAA6BE,GAC7B,sBAAuB,SAAUK,EAAiBC,EAAiB,CACjEF,GAA0BC,EAAiBC,CAAe,CAC5D,EACA,sBAAuB,SAAUgM,EAAS,CACxCjN,GAA+BiN,CACjC,EACA,sBAAuB,UAAY,CACjC,OAAOjN,EACT,EACA,eAAgB,SAAU2B,EAAU,CAClCD,GAAmBC,CAAQ,CAC7B,EACA,eAAgB,SAAUQ,EAAW,CACnC,OAAOD,GAAmBC,CAAS,CACrC,EACA,kBAAmB,SAAUR,EAAU,CACrCW,GAAsBX,CAAQ,CAChC,EACA,iBAAkB,UAAY,CAC5B,OAAOzB,CACT,EACA,iBAAkB,SAAUiC,EAAW,CACrC,OAAOK,GAAqBL,CAAS,CACvC,EACA,8BAA+B,SAAUQ,EAAMR,EAAWS,EAAiB,CACzE,OAAOF,GACLC,EACAR,EACAS,CACF,CACF,EACA,aAAc,SAAUY,EAAeC,EAAM,CAC3CF,GAAiBC,EAAeC,CAAI,CACtC,EACA,uBAAwB,SAAUG,EAAgB,CAChD,OAAOE,GAA2BF,CAAc,CAClD,EACA,wBAAyB,SAAUA,EAAgB,CACjD,OAAOD,GAA4BC,CAAc,CACnD,EACA,yBAA0B,SAAUI,EAAOC,EAAe,CACxD,OAAOF,GAA6BC,EAAOC,CAAa,CAC1D,EACA,kBAAmB,SAAUO,EAAMP,EAAeQ,EAAaC,EAAY,CACzE,OAAOH,GACLC,EACAP,EACAQ,EACAC,CACF,CACF,EACA,WAAY,SAAU2C,EAAKC,EAAOC,EAAUC,EAAc,CACxDJ,GAAeC,EAAKC,EAAOC,EAAUC,CAAY,CACnD,EACA,YAAa,SAAUH,EAAKU,EAAK,CAC/B,OAAOD,GAAgBT,EAAKU,CAAG,CACjC,EACA,iBAAkB,SAAUA,EAAK,CAC/B,OAAOC,EAAqBD,CAAG,CACjC,EACA,UAAW,SAAUM,EAAGC,EAAa,CACnC,OAAOF,EAAcC,EAAGC,CAAW,CACrC,EACA,aAAc,SAAUI,EAAKC,EAAU,CACrC,OAAOF,EAAiBC,EAAKC,CAAQ,CACvC,EACA,oBAAqB,SAAUG,EAAU,CACvC,OAAOD,EAAwBC,CAAQ,CACzC,EACA,iBAAkB,SAAUE,EAAG,CAC7B,OAAOD,EAAkBC,CAAC,CAC5B,EACA,uBAAwB,SAAUnH,EAAWqG,EAAW,CACtD,OAAOD,GAA2BpG,EAAWqG,CAAS,CACxD,EACA,uBAAwBgB,EACxB,kBAAmB,SAAUyB,EAAWC,EAAQ,CAC9CF,EAAcC,EAAWC,CAAM,CACjC,EACA,YAAa,SAAUe,EAAUC,EAAWC,EAAc,CACxDH,EAAgBC,EAAUC,EAAWC,CAAY,CACnD,EACA,gBAAiB,SAAUrB,EAAS,CAClCD,EAAoBC,CAAO,CAC7B,EAEA,qBAAsB,SAAUtC,EAAW,CACzC,OAAOqB,EAAyBrB,CAAS,CAC3C,EACA,mBAAoB,SAAUA,EAAW,CACvC,OAAOmB,EAAuBnB,CAAS,CACzC,EACA,6BAA8B,SAAUA,EAAWuB,EAAM,CACvD,OAAOD,EAAiCtB,EAAWuB,CAAI,CACzD,EACA,oBAAqB,SAAUxD,EAAGC,EAAG,CACnC,OAAOe,GAA6BhB,EAAGC,CAAC,CAC1C,EACA,mBAAoBF,EACtB,EAEA,OAAOgH,CACT,EAGA5O,GAAW,ECzqCX,OAAO,MAAQ,OAAO,OAAS,CAAC,EAChC,MAAM,YAAc,MAAM,aAAe,CAAC,EAE1C,SAAS,eAAe,KAAK,EAAE,UAAY8O,GAEvC,SAAS,aAAe,SAAW,SAAS,aAAe,WAC7DC,GAAgB,EAEhB,SAAS,mBAAqB,IAAM,EAC9B,SAAS,aAAe,YAAc,SAAS,aAAe,UAChE,gCAAgC,UAAY,CAC1C,GAAG,IAAI,YAAY,QAAS,mBAAoBA,EAAe,CACjE,EAAG,OAAO,CAEd,EAGF,SAASA,IAAkB,CACzB,MAAM,YAAY,OAAS,IAAI,MAAM,YAAY,KACjD,MAAM,YAAY,KAAK,CACzB,CAEA,MAAM,YAAY,KAAO,UAAY,CAAC,EAEtC,MAAM,YAAY,KAAO,UAAY,CAEnC,IAAIC,EAAgB,IAAI,MACpBC,EAAiB,IAAI,MACrBC,GAAuB,IAAI,MAE3BC,EAAc,KACdC,EAAc,KACdC,EAAmB,KACnBC,EAAoB,KACpBC,EAAqB,KAErBC,EACAC,EACAC,EAAyB,KAEzBC,EAAoB,kBAEpBC,EAAkB,IAAI,OAE1BC,GAAS,EAET,SAASA,IAAW,CAGlB,IAAIC,EAAU,IAAI,GAAG,cAAc,YAC/BC,EAAMD,EAAQ,QAAQ,EAsBtBE,EAASD,EACV,UAAU,EACV,WAAW,MAAM,OAAO,UAAU,0BAA0B,CAAC,EAC5DE,EAAU,IAAI,GAAG,UACrBA,EAAQ,YACN,yEACF,EACA,IAAIC,EAAYF,EAAO,SAASC,CAAO,EACvCH,EAAQ,KAAKI,EAAW,+BAA+B,EAEvD,IAAIC,EAAaJ,EAAI,yBAAyB,EAC1CK,EAAcL,EAAI,0BAA0B,EAC5CM,EAAeN,EAAI,2BAA2B,EAClDD,EAAQ,KAAKK,CAAU,EACvBL,EAAQ,KAAKM,CAAW,EACxBN,EAAQ,KAAKO,CAAY,EAEzBP,EAAQ,kBAAkBQ,EAAWC,CAAS,EAC9C,SAASD,EAAUE,EAAQC,EAAM,CAC/B,MAAM,OAAO,UAAU,kBAAkBP,CAAS,EAElDb,EAAmBc,EAAW,UAAU,EACxCb,EAAoBc,EAAY,UAAU,EAC1Cb,EAAqBc,EAAa,UAAU,EAQ5C,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAEvBK,GAAuB,EAEvB,MAAM,OAAO,UAAU,uBAAuB,EAC9CC,GAAqB,EAErB,IAAIC,EAAa,eAAe,OAAO,GACnCA,GAAc,MAAQA,GAAc,IAAMA,GAAc,KAC1D,EAAE,aAAa,EAAE,KAAK,EAGxB,IAAIC,EAAgC,GACpCC,GAA2B,SAAUD,EAA+B,CAC9DA,IACFE,GAA8B,EAC9BC,GAA+B,EAEnC,CAAC,CACH,CACA,SAAST,EAAUC,EAAQC,EAAM,CAC/B,EAAE,aAAa,EAAE,KAAK,EAEtB,SAAW,GAAG,GAAG,OAAO,UACtB,mBAAqBA,EAAK,YAAY,EAAI;AAAA,EAAOA,EAAK,eAAe,CACvE,EACA,GAAG,GAAG,OAAO,kBAAkB,SAAU,KAAK,CAChD,CACF,CAEA,SAASQ,GAAc,CACrB,IAAIC,EAAU,SAAS,SAEnBC,EAAW,EAAE,OAAO,EAAE,KAAK,SAAU,QAAQ,EACjDD,GAAW,QAAUC,EAErB,SAAS,KAAOD,CAClB,CAEA,SAASP,IAAuB,CAC9B,IAAIS,EAAgB,eAAe,KAAK,EACpCA,GAAiB,MAAQA,GAAiB,IAC5C,EAAE,OAAO,EAAE,KAAK,SAAU,SAAUA,CAAa,CAErD,CAEA,SAASC,IAA6B,CACpCrC,EAAgB,IAAI,MAEpB,IAAIc,EAAU,GAAG,cAAc,YAAY,EACvCC,EAAMD,EAAQ,QAAQ,EAE1B,KAAK,WAAaC,EAAI,yBAAyB,EAC/C,KAAK,YAAcA,EAAI,0BAA0B,EACjD,KAAK,aAAeA,EAAI,2BAA2B,EAGnD,QADIuB,EAAqB,eAAe,cAAc,EAC/CA,EAAmB,SAAS,GAAG,CAUpC,QATIC,EAAYD,EAAmB,YAAY,EAE3CE,EAAKD,EAAU,SAAS,IAAI,EAC5BE,EAASF,EAAU,SAAS,OAAO,EACnCG,EAASH,EAAU,SAAS,WAAW,EAEvCI,EAASJ,EAAU,SAAS,UAAU,EACtCK,EAAkBL,EAAU,SAAS,cAAc,EACnDM,EAAe,GACVC,EAAI,EAAGA,EAAIF,EAAgB,OAAQE,IAC1CD,GACE,QAAUD,EAAgBE,CAAC,EAAE,gBAAgB,EAAI,SAGrD,IAAIC,EAAgB,IAAI,OACxBA,EAAc,GAAQP,EACtBO,EAAc,OAAYN,EAC1BM,EAAc,OAAYL,EAC1BK,EAAc,OAAYJ,EAC1BI,EAAc,UAAe,IAAI,MACjCA,EAAc,aAAkBF,EAChCE,EAAc,KAAUR,EAExBS,GAAoBD,EAAeR,CAAS,EAE5CvC,EAAc,KAAK+C,CAAa,CAClC,CAUA,QARIE,EAAgB,IAAI,MACpBC,EAAa,EACbC,EAAwB,GAExBC,EAAI,IAAI,MACVC,EAAI,GAEFC,EAAYtD,EAAc,OACrB8C,EAAI,EAAGA,EAAIQ,EAAWR,IAAK,CAClC,IAAIS,EAAWvD,EAAc8C,CAAC,EAE1BL,EAASc,EAAS,OACtBN,EAAc,KAAKR,CAAM,EAWzB,QAVIC,EAASa,EAAS,OAClBC,EAAgBD,EAAS,aACzBE,EAAeF,EAAS,mBACxBG,EAAiB,MAAM,OAAO,UAAU,iBAC1CH,EAAS,qBACX,EAEII,EAAW,GACXC,EAAa,GAER,EAAI,EAAG,EAAIL,EAAS,KAAK,SAAS,cAAc,EAAE,OAAQ,IAAK,CAQtE,QAPIM,EAAmBN,EAAS,KAC7B,SAAS,cAAc,EACvB,CAAC,EAAE,gBAAgB,EAClBO,EACF,MAAM,OAAO,UAAU,iBAAiBD,CAAgB,EAEtDE,EAAmB,GACdC,EAAI,EAAGA,EAAIT,EAAS,mBAAmB,OAAQS,IAClDT,EAAS,mBAAmBS,CAAC,EAAE,MAAQF,IACzCC,EAAmB,IACvB,QAASC,EAAI,EAAGA,EAAIT,EAAS,oBAAoB,OAAQS,IACnDT,EAAS,oBAAoBS,CAAC,EAAE,MAAQF,IAC1CC,EAAmB,IAElBA,IACHH,EACE,6DACFD,EAAW,GAEf,CAEA,GAAI,CAACA,EAAU,CAGb,QADIM,EAAS,GACJD,EAAI,EAAGA,EAAIT,EAAS,mBAAmB,OAAQS,IAAK,CAG3D,QAFIE,EAAS,GACTC,EAAOZ,EAAS,mBAAmBS,CAAC,EAAE,KAEpC,EAAI,EACR,EAAIT,EAAS,KAAK,SAAS,cAAc,EAAE,OAC3C,IACA,CACA,IAAIM,EAAmBN,EAAS,KAC7B,SAAS,cAAc,EACvB,CAAC,EAAE,gBAAgB,EAClBO,EACF,MAAM,OAAO,UAAU,iBAAiBD,CAAgB,EACtDM,GAAQL,IACVI,EAAS,GAEb,CAeA,GAdKA,IAEDC,GAAQ9D,GACR8D,GAAQ7D,GACR6D,GAAQ5D,GACR4D,GAAQ,MAAM,OAAO,UAAU,eAAe,GAC9CA,GAAQ,MAAM,OAAO,UAAU,yBAAyB,GACxDA,GAAQ,MAAM,OAAO,UAAU,yBAAyB,EAExDD,EAAS,GAETA,EAAS,IAGT,CAACA,EAAQ,CACXD,EAAS,GACT,KACF,CACF,CACA,QAASD,EAAI,EAAGA,EAAIT,EAAS,oBAAoB,OAAQS,IAAK,CAG5D,QAFIE,EAAS,GACTC,EAAOZ,EAAS,oBAAoBS,CAAC,EAAE,KAErC,EAAI,EACR,EAAIT,EAAS,KAAK,SAAS,cAAc,EAAE,OAC3C,IACA,CACA,IAAIM,EAAmBN,EAAS,KAC7B,SAAS,cAAc,EACvB,CAAC,EAAE,gBAAgB,EAClBO,EACF,MAAM,OAAO,UAAU,iBAAiBD,CAAgB,EACtDM,GAAQL,IACVI,EAAS,GAEb,CAeA,GAdKA,IAEDC,GAAQ9D,GACR8D,GAAQ7D,GACR6D,GAAQ5D,GACR4D,GAAQ,MAAM,OAAO,UAAU,eAAe,GAC9CA,GAAQ,MAAM,OAAO,UAAU,yBAAyB,GACxDA,GAAQ,MAAM,OAAO,UAAU,yBAAyB,EAExDD,EAAS,GAETA,EAAS,IAGT,CAACA,EAAQ,CACXD,EAAS,GACT,KACF,CACF,CAEIA,IACFL,EACE,gFACFD,EAAW,GAEf,CAKA,IAAIS,EAAW,GACXT,IACFS,EAAW,yCAA2CR,EACtDV,KAGF,IAAImB,GACF,gFACAd,EAAS,OACT,OACAA,EAAS,OACT,OAUFH,EAAE,EAAEC,CAAC,EAAI,iCACTD,EAAE,EAAEC,CAAC,EAAIe,EACThB,EAAE,EAAEC,CAAC,EAAI,IACTD,EAAE,EAAEC,CAAC,EAAI,+DACTD,EAAE,EAAEC,CAAC,EAAIgB,GACTjB,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EAAI,+DACTD,EAAE,EAAEC,CAAC,EAAIX,EACTU,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,8EACFD,EAAE,EAAEC,CAAC,EAAIG,EACTJ,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,mFACFD,EAAE,EAAEC,CAAC,EAAIK,EACTN,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,mEACFD,EAAE,EAAEC,CAAC,EAAII,EACTL,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EAAI,OACX,CAEA,EAAE,+BAA+B,EAAE,OAAOD,EAAE,KAAK,EAAE,CAAC,EAEpD,EAAE,wBAAwB,EAAE,KAAKpD,EAAc,MAAM,EAEjDkD,EAAa,GACf,EAAE,cAAc,EAAE,KAChB,EAAE,cAAc,EAAE,KAAK,EACrB,4GACAA,EACA,4DACJ,EAGF,MAAM,OAAO,UAAU,WAAWD,EAAe,gBAAiB,EAAK,CACzE,CAEA,SAASqB,IAA8B,CACrCrE,EAAiB,IAAI,MAGrB,QADIqC,EAAqB,gBAAgB,cAAc,EAChDA,EAAmB,SAAS,GAAG,CACpC,IAAIC,EAAYD,EAAmB,YAAY,EAE3CG,EAASF,EAAU,SAAS,QAAQ,EACxC,GAAIE,GAAU,KAAM,CAClBA,EAASA,EAAO,gBAAgB,EAEhC,IAAI8B,EAAiB,IAAI,OACzBA,EAAe,GAAQhC,EAAU,SAAS,IAAI,EAC9CgC,EAAe,OAAY9B,EAC3B8B,EAAe,MAAWhC,EAAU,SAAS,OAAO,EACpDgC,EAAe,KAAUhC,EAEzBgC,EAAe,OAAYhC,EAAU,SAAS,cAAc,EACxDgC,EAAe,QAAa,OAAMA,EAAe,OAAY,IAEjEA,EAAe,aAAkBhC,EAAU,SAAS,cAAc,EAC9DgC,EAAe,cAAmB,KACpCA,EAAe,aAAkB,GAEjCA,EAAe,aACbA,EAAe,aAAgB,gBAAgB,EAEnDA,EAAe,UAAehC,EAAU,SAAS,WAAW,EAE5DS,GAAoBuB,EAAgBhC,CAAS,EAE7CtC,EAAe,KAAKsE,CAAc,CACpC,CACF,CAYA,QAVIC,EAAgC,IAAI,MACpCC,EAAkC,IAAI,MACtCC,EAA2C,IAAI,MAE/CxB,EAAa,EACbC,EAAwB,GACxBC,EAAI,IAAI,MACVC,EAAI,GAEFsB,EAAiB1E,EAAe,OAC3B6C,EAAI,EAAGA,EAAI6B,EAAgB7B,IAAK,CAgBvC,QAfI8B,EAAY3E,EAAe6C,CAAC,EAE5BL,EAASmC,EAAU,OACnBC,EAAQD,EAAU,MAClBlC,EAASkC,EAAU,UACnB/B,EAAe+B,EAAU,aACzBE,EAAQF,EAAU,mBAClBG,EAAkB,MAAM,OAAO,UAAU,iBAC3CH,EAAU,qBACZ,EAEII,EAAuB,GACvBC,EAAsB,GACtBC,EAA0B,KAC1BC,EAAuB,GAClBC,EAAI,EAAGA,EAAIpF,EAAc,OAAQoF,IACxC,GAAIpF,EAAcoF,CAAC,EAAE,QAAU3C,EAAQ,CACrCuC,EAAuBhF,EAAcoF,CAAC,EAAE,sBACxCH,EAAsB,MAAM,OAAO,UAAU,iBAC3CjF,EAAcoF,CAAC,EAAE,qBACnB,EACAF,EACElF,EAAcoF,CAAC,EAAE,KAAK,SAAS,cAAc,EAC/CD,EAAuBnF,EAAcoF,CAAC,EAAE,aACxC,KACF,CAGF,IAAIzB,EAAW,GACX,CAACqB,GAAwBJ,EAAU,wBAErCjB,EAAW,GACXa,EAA8B,KAAKK,CAAK,GAGxCD,EAAU,uBACVlC,GAAU,qBACVA,GAAU,aAEViB,EAAW,GACXc,EAAgC,KAAKI,CAAK,GAI5C,QADIQ,EAAkC,GAC7BD,EAAI,EAAGA,EAAIF,EAAwB,OAAQE,IAC9CF,EAAwBE,CAAC,EAAE,gBAAgB,GAAKvC,IAClDwC,EAAkC,IAIjCA,IACH1B,EAAW,GACXe,EAAyC,KAAKG,CAAK,GAGrD,IAAIT,EAAW,GACXT,IACFS,EAAW,yCACXlB,KAGF,IAAImB,EACF,iFACAQ,EACA,OACAA,EACA,OAEFM,EAAuBA,EAAqB,QAC1CtC,EACA,MAAQA,EAAe,MACzB,EAYAO,EAAE,EAAEC,CAAC,EAAI,kCACTD,EAAE,EAAEC,CAAC,EAAIe,EACThB,EAAE,EAAEC,CAAC,EAAI,IACTD,EAAE,EAAEC,CAAC,EACH,uEACFD,EAAE,EAAEC,CAAC,EAAIZ,EACTW,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,sEACFD,EAAE,EAAEC,CAAC,EAAIgB,EACTjB,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,wEACFD,EAAE,EAAEC,CAAC,EAAIX,EACTU,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,6FACFD,EAAE,EAAEC,CAAC,EAAI8B,EACT/B,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,8EACFD,EAAE,EAAEC,CAAC,EAAIR,EACTO,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,mFACFD,EAAE,EAAEC,CAAC,EAAI4B,EACT7B,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,2EACFD,EAAE,EAAEC,CAAC,EAAI0B,EACT3B,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,4EACFD,EAAE,EAAEC,CAAC,EAAIyB,EACT1B,EAAE,EAAEC,CAAC,EAAI,YACX,CAMA,GAJA,EAAE,+BAA+B,EAAE,OAAOD,EAAE,KAAK,EAAE,CAAC,EAEpD,EAAE,wBAAwB,EAAE,KAAKnD,EAAe,MAAM,EAElDiD,EAAa,EAAG,CAClB,IAAIoC,EAAYC,EACdf,EACA,oEACF,EACIgB,EAAYD,EACdd,EACA,6GACF,EACIgB,EAAYF,EACdb,EACA,6FACF,EAEA,EAAE,cAAc,EAAE,KAChB,EAAE,cAAc,EAAE,KAAK,EACrB,yIACAxB,EACA,+CACAoC,EACAE,EACAC,EACA,kBACJ,CACF,CACF,CAEA,SAASC,IAAoC,CAI3C,QAHIxF,EAAuB,IAAI,MAE3BoC,EAAqB,2BAA2B,cAAc,EAC3DA,EAAmB,SAAS,GAIjC,QAHIC,EAAYD,EAAmB,YAAY,EAE3CqD,EAAapD,EAAU,gBAAgB,EAClCO,EAAI,EAAGA,EAAI7C,EAAe,OAAQ6C,IACzC,GAAI7C,EAAe6C,CAAC,EAAE,OAAS6C,EAAY,CACzC,IAAIC,EAAuB,IAAI,OAC/BA,EAAqB,MAAWD,EAChCC,EAAqB,SAAc3F,EAAe6C,CAAC,EAEnDE,GAAoB4C,EAAsBrD,CAAS,EAEnDrC,EAAqB,KAAK0F,CAAoB,EAC9C,KACF,CAaJ,QATIpB,EAAgC,IAAI,MACpCC,EAAkC,IAAI,MACtCC,EAA2C,IAAI,MAE/CxB,EAAa,EACbC,EAAwB,GACxBC,EAAI,IAAI,MACVC,EAAI,GACFwC,EAAkB3F,EAAqB,OAClC4C,EAAI,EAAGA,EAAI+C,EAAiB/C,IAAK,CAoBxC,QAnBIgD,EAAkB5F,EAAqB4C,CAAC,EAExCL,EAASqD,EAAgB,SAAS,OAClCjB,EAAQiB,EAAgB,SAAS,MACjCH,EAAaG,EAAgB,MAC7BpD,EAASoD,EAAgB,SAAS,UAClCC,EAAuBD,EAAgB,SAAS,aAChDhB,EAAQgB,EAAgB,SAAS,mBACjCf,EAAkB,MAAM,OAAO,UAAU,iBAC3Ce,EAAgB,qBAClB,EACIE,EAAuB,MAAM,OAAO,UAAU,iBAChDF,EAAgB,SAAS,qBAC3B,EAEId,EAAuB,GACvBC,EAAsB,GACtBC,EAA0B,KAC1BC,EAAuB,GAClBC,EAAI,EAAGA,EAAIpF,EAAc,OAAQoF,IACxC,GAAIpF,EAAcoF,CAAC,EAAE,QAAU3C,EAAQ,CACrCuC,EAAuBhF,EAAcoF,CAAC,EAAE,sBACxCH,EAAsB,MAAM,OAAO,UAAU,iBAC3CjF,EAAcoF,CAAC,EAAE,qBACnB,EACAF,EACElF,EAAcoF,CAAC,EAAE,KAAK,SAAS,cAAc,EAC/CD,EAAuBnF,EAAcoF,CAAC,EAAE,aACxC,KACF,CAGF,IAAIzB,EAAW,GAEb,CAACqB,GACDc,EAAgB,SAAS,wBAGzBnC,EAAW,GACXa,EAA8B,KAAKK,CAAK,GAGxCiB,EAAgB,SAAS,uBACzBpD,GAAU,qBACVA,GAAU,aAEViB,EAAW,GACXc,EAAgC,KAAKI,CAAK,GAI5C,QADIQ,EAAkC,GAC7BD,EAAI,EAAGA,EAAIF,EAAwB,OAAQE,IAEhDF,EAAwBE,CAAC,EAAE,gBAAgB,GAAKW,IAEhDV,EAAkC,IAIjCA,IACH1B,EAAW,GACXe,EAAyC,KAAKG,CAAK,GAGrD,IAAIT,EAAW,GACXT,IACFS,EAAW,yCACXlB,KAGFiC,EAAuBA,EAAqB,QAC1CY,EACA,MAAQA,EAAuB,MACjC,EAcA3C,EAAE,EAAEC,CAAC,EAAI,wCACTD,EAAE,EAAEC,CAAC,EAAIe,EACThB,EAAE,EAAEC,CAAC,EAAI,IACTD,EAAE,EAAEC,CAAC,EACH,6EACFD,EAAE,EAAEC,CAAC,EAAIZ,EACTW,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,6EACFD,EAAE,EAAEC,CAAC,EAAIwB,EACTzB,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,6EACFD,EAAE,EAAEC,CAAC,EAAIsC,EACTvC,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,8EACFD,EAAE,EAAEC,CAAC,EAAIX,EACTU,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,mGACFD,EAAE,EAAEC,CAAC,EAAI8B,EACT/B,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,mGACFD,EAAE,EAAEC,CAAC,EAAI0C,EACT3C,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,wGACFD,EAAE,EAAEC,CAAC,EAAI4B,EACT7B,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,0GACFD,EAAE,EAAEC,CAAC,EAAI0B,EACT3B,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,wGACFD,EAAE,EAAEC,CAAC,EAAI2C,EACT5C,EAAE,EAAEC,CAAC,EAAI,QACTD,EAAE,EAAEC,CAAC,EACH,gFACFD,EAAE,EAAEC,CAAC,EAAIyB,EACT1B,EAAE,EAAEC,CAAC,EAAI,YACX,CAMA,GAJA,EAAE,qCAAqC,EAAE,OAAOD,EAAE,KAAK,EAAE,CAAC,EAE1D,EAAE,8BAA8B,EAAE,KAAKlD,EAAqB,MAAM,EAE9DgD,EAAa,EAAG,CAClB,IAAIoC,EAAYC,EACdf,EACA,2EACF,EACIgB,EAAYD,EACdd,EACA,mHACF,EACIgB,EAAYF,EACdb,EACA,oGACF,EAEA,EAAE,cAAc,EAAE,KAChB,EAAE,cAAc,EAAE,KAAK,EACrB,gJACAxB,EACA,sDACAoC,EACAE,EACAC,EACA,mBACJ,CACF,CACF,CAEA,SAASF,EAAgBU,EAAKC,EAAU,CACtC,IAAIC,EAAW,GACf,GAAIF,EAAI,OAAS,EAAG,CAClBE,EAAW,oCAAsCD,EAAW,OAC5D,QAASpD,EAAI,EAAGA,EAAImD,EAAI,OAAQnD,IAC9BqD,GAAY,OAASF,EAAM,QAE7BE,GAAY,aACd,CACA,OAAOA,CACT,CAEA,SAASnD,GAAoBoD,EAAM7D,EAAW,CAC5C6D,EAAK,gBAAqB,IAAI,MAC9BA,EAAK,iBAAsB,IAAI,MAE/BA,EAAK,mBAAwB,IAAI,MACjCA,EAAK,oBAAyB,IAAI,MAIlC,QAFIC,EAAkB9D,EAAU,oBAAoB,EAChD+D,EAAkBD,EAAgB,cAAc,EAC7CC,EAAgB,SAAS,GAAG,CACjC,IAAIC,EAAOD,EAAgB,YAAY,EACnCE,EAAaD,EAAK,WAAW,EAC7BE,EAAmBD,EAAW,cAAc,EAC5CE,EAAkBF,EAAW,UAAU,EAEvCG,EAAiB,kBACjBC,EAAgBJ,EAAW,kBAAkB,GAE/CI,GAAiB,GAAG,UAAU,cAAc,eAC5CA,GAAiB,GAAG,UAAU,cAAc,mBAE5CD,EAAiB,oBAMnB,QAHIE,EAAWN,EAAK,2BAA2B,EAE3CO,EAAqBD,EAAS,cAAc,EACzCC,EAAmB,SAAS,GAAG,CACpC,IAAIC,EAAKD,EAAmB,YAAY,EACpCE,EAASD,EAAG,SAAS,EAEzBX,EAAKO,CAAc,EAAE,KAAKK,EAAS,MAAQN,CAAe,EAE1D,IAAIO,EAAW,IAAI,OACnBA,EAAS,KAAOP,EAChBO,EAAS,gBAAkBD,EAE3BZ,EAAK,MAAQO,CAAc,EAAE,KAAKM,CAAQ,CAC5C,CACF,CAGA,QADInC,EAAQ,GACHd,EAAI,EAAGA,EAAIoC,EAAK,gBAAgB,OAAQpC,IAC/Cc,GACE,mCAAqCsB,EAAK,gBAAgBpC,CAAC,EAAI,SACnE,QAASA,EAAI,EAAGA,EAAIoC,EAAK,iBAAiB,OAAQpC,IAChDc,GACE,mCACAsB,EAAK,iBAAiBpC,CAAC,EACvB,SAEJ,IAAIkD,EAAe,GAEjBpC,EAAM,QAAQ,MAAM,OAAO,UAAU,yBAAyB,CAAC,GAAK,GACpEA,EAAM,QAAQ,MAAM,OAAO,UAAU,yBAAyB,CAAC,GAAK,IAEpEoC,EAAe,IAGbpC,GAAS,KACXA,EACE,8IACAA,EACA,gBACJsB,EAAK,mBAAwBtB,EAC7BsB,EAAK,sBAA2Bc,CAClC,CAEA,SAASC,IAAiC,CACxC,EAAE,YAAY,EAAE,MAAM,UAAY,CAChC,EAAE,IAAI,EAAE,KAAK,YAAY,EAAE,YAAY,WAAW,CACpD,CAAC,CACH,CAEA,SAASrF,GAA2BsF,EAAmB,CACrDjH,EAAc,IAAI,MAElB,IAAIW,EAAU,IAAI,GAAG,cAAc,YAC/BC,EAAMD,EAAQ,QAAQ,EAE1BV,EAAcU,EAAQ,QAAQ,EAAE,eAAe,EAC/CA,EAAQ,KAAKV,CAAW,EAExB,SAASiH,EAAW7F,EAAQC,EAAM,CAChCtB,EAAc,IAAI,MAElB,QADImH,EAAiBlH,EAAY,cAAc,EACxCkH,EAAe,SAAS,GAAG,CAChC,IAAIlB,EAAOkB,EAAe,YAAY,EAClCC,EAAYnB,EAAK,UAAU,EAC/BmB,EAAY,EAAE,KAAKA,CAAS,EAC5B,IAAIC,EAAUpB,EAAK,OAAO,EAEtBqB,EAAS,IAAI,OACjBA,EAAO,MAAWF,EAClBE,EAAO,GAAQD,EACfC,EAAO,MAAW,KAClBtH,EAAY,KAAKsH,CAAM,CACzB,CAEAL,EAAkB,EAAI,CACxB,CACA,SAASM,EAAWlG,EAAQC,EAAM,CAChC2F,EAAkB,EAAI,CACxB,CACAtG,EAAQ,kBAAkBuG,EAAYK,CAAU,CAClD,CAwDA,SAAS3F,GAA8B4F,EAAgB,CACrD/G,EAAkB,IAAI,OAEtB,EAAE,sBAAsB,EAAE,KAAK,WAAY,EAAI,EAK/C,QAHIgH,EAAM,MAAM,OAAO,UAAU,iBAAiB,EAC9CC,EAAS,GACTC,EAAQ,EACHhF,EAAI,EAAGA,EAAI8E,EAAI,OAAQ9E,IAAK,CACnC,IAAIe,EAAmB+D,EAAI9E,CAAC,EAAE,MAC9B,GAAI,EAAAe,EAAiB,QAAQ,eAAe,EAAI,GAEhD,CAAAiE,IAEA,IAAIP,EAAYK,EAAI9E,CAAC,EAAE,UACnBiF,EAAU,GACVjD,EAAQ,GAEZ,GAAIyC,GAAa,MAAQA,GAAa,IACpC,QAASnC,EAAI,EAAGA,EAAIjF,EAAY,OAAQiF,IACtC,GAAIjF,EAAYiF,CAAC,EAAE,OAASmC,EAAW,CACrCQ,EAAU5H,EAAYiF,CAAC,EAAE,GAEzB,KACF,EAIA2C,GAAW,GACbF,GACE,8EACA/E,EACA,gFACAe,EACA,kJACAkE,EACA,MACAR,EACA,OACAA,EACA,iDACAzE,EACA,gBAGF+E,GACE,8EACA/E,EACA,gFACAe,EACA,mGACAf,EACA,gBACN,CAEI8E,EAAI,QAAU,EAChBC,EAAS,oCAET,EAAE,QAAQ,EAAE,KAAKA,CAAM,EACvB,EAAE,eAAe,EAAE,KAAKC,CAAK,GAG/B,EAAE,OAAO,EAAE,MAAM,UAAY,CAC3B,IAAIE,EAAQ,EACZ,EAAE,OAAO,EAAE,KAAK,UAAY,CAC1B,GAAI,EAAE,IAAI,EAAE,GAAG,UAAU,EAAG,CAC1BA,IACA,MACF,CACF,CAAC,EAEGA,EAAQ,EAAG,EAAE,sBAAsB,EAAE,KAAK,WAAY,EAAK,EAC1D,EAAE,sBAAsB,EAAE,KAAK,WAAY,EAAI,CACtD,CAAC,EAGD,QADIC,EAAkB,EACbnF,EAAI,EAAGA,EAAI8E,EAAI,OAAQ9E,IAAK,CACnC,IAAIe,EAAmB+D,EAAI9E,CAAC,EAAE,MAC9B,GAAI,EAAAe,EAAiB,QAAQ,eAAe,EAAI,GAIhD,SAFI0D,EAAYK,EAAI9E,CAAC,EAAE,UACnBiF,EAAU,KACL3C,EAAI,EAAGA,EAAIjF,EAAY,OAAQiF,IACtC,GAAIjF,EAAYiF,CAAC,EAAE,OAASmC,EAAW,CACrCQ,EAAU5H,EAAYiF,CAAC,EAAE,GAEzB,KACF,CAGF,GAAI2C,GAAW,KAAM,CAYnB,IAASG,EAAT,UAAgC,CAG9B,QAFIC,EAAW,IAAI,MACfC,EAAkB,KAAK,SAAS,cAAc,EAC3CA,EAAgB,SAAS,GAAG,CACjC,IAAIC,EAAQD,EAAgB,YAAY,EACpCE,EACFD,EAAM,cAAc,EAAI,KAAOA,EAAM,UAAU,EAAI,IACrDF,EAAS,KAAKG,CAAW,CAC3B,CAEAH,EAAWA,EAAS,KAAK,EAEzB,QADII,EAAQ,GACHC,EAAI,EAAGA,EAAIL,EAAS,OAAQK,IACnCD,GAASJ,EAASK,CAAC,EAAI,KAGzB,EAAE,cAAgB,KAAK,CAAC,EAAE,KAAKC,GAAqBF,CAAK,CAAC,EAE1D3H,EAAgB,KAAK,SAAS,EAAI2H,CACpC,EAESG,EAAT,SAA2BlH,EAAQC,EAAM,CAAC,EAhC1CwG,IAEA,IAAInH,EAAU,IAAI,GAAG,cAAc,YAC/BC,EAAMD,EAAQ,QAAQ,EACtB6H,EAAY5H,EAAI,eAAe,EAE/B0G,EAASkB,EAAU,QAAQZ,CAAO,EAClCa,EAAWnB,EAAO,UAAU,EAChC3G,EAAQ,KAAK8H,CAAQ,EAErB,IAAIC,EAAO,CAAE,EAAG/F,EAAG,UAAWyE,EAAW,SAAUqB,CAAS,EAwB5D9H,EAAQ,kBACN,SAAS,eAAe+H,EAAMX,CAAoB,EAClD,SAAS,eAAeW,EAAMH,CAAiB,CACjD,CACF,EACF,CACF,CAEA,SAAS1G,GAA+B2F,EAAgB,CACtD,IAAIC,EAAM,MAAM,OAAO,UAAU,iBAAiB,EAC9CC,EAAS,GAETiB,EAAc,IAAI,MACtBA,EAAY,KAAKzI,CAAgB,EACjCyI,EAAY,KAAKxI,CAAiB,EAClCwI,EAAY,KAAKvI,CAAkB,EACnCuI,EAAY,KAAK,MAAM,OAAO,UAAU,eAAe,CAAC,EACxDA,EAAY,KAAK,MAAM,OAAO,UAAU,eAAe,CAAC,EACxDA,EAAY,KAAK,MAAM,OAAO,UAAU,yBAAyB,CAAC,EAClEA,EAAY,KAAK,MAAM,OAAO,UAAU,yBAAyB,CAAC,EAGlE,QADIC,EAAa,EACRjG,EAAI,EAAGA,EAAIgG,EAAY,OAAQhG,IAAK,CAC3CiG,IAMA,QAJIxB,EAAYuB,EAAYhG,CAAC,EACzBiF,EAAU,GACVjD,EAAQ,GAEHM,EAAI,EAAGA,EAAIjF,EAAY,OAAQiF,IACtC,GAAIjF,EAAYiF,CAAC,EAAE,OAASmC,EAAW,CACrCQ,EAAU5H,EAAYiF,CAAC,EAAE,GACzB,KACF,CAGFyC,GACE,qKACAE,EACA,MACAR,EACA,OACAA,EACA,qDACAzE,EACA,eAEJ,CAEA,EAAE,gBAAgB,EAAE,KAAK+E,CAAM,EAG/B,QADImB,EAAoB,EACflG,EAAI,EAAGA,EAAIgG,EAAY,OAAQhG,IAAK,CAG3C,QAFIyE,EAAYuB,EAAYhG,CAAC,EACzBiF,EAAU,KACL3C,EAAI,EAAGA,EAAIjF,EAAY,OAAQiF,IACtC,GAAIjF,EAAYiF,CAAC,EAAE,OAASmC,EAAW,CACrCQ,EAAU5H,EAAYiF,CAAC,EAAE,GAEzB,KACF,CAGF,GAAI2C,GAAW,KAAM,CAYnB,IAASkB,EAAT,UAAkC,CAGhC,QAFId,EAAW,IAAI,MACfC,EAAkB,KAAK,SAAS,cAAc,EAC3CA,EAAgB,SAAS,GAAG,CACjC,IAAIC,EAAQD,EAAgB,YAAY,EACpCE,EACFD,EAAM,cAAc,EAAI,KAAOA,EAAM,UAAU,EAAI,IACrDF,EAAS,KAAKG,CAAW,CAC3B,CAEAH,EAAWA,EAAS,KAAK,EAEzB,QADII,EAAQ,GACHC,EAAI,EAAGA,EAAIL,EAAS,OAAQK,IACnCD,GAASJ,EAASK,CAAC,EAAI,KAGzB,EAAE,gBAAkB,KAAK,CAAC,EAAE,KAAKC,GAAqBF,CAAK,CAAC,CAC9D,EAESW,EAAT,SAA6B1H,EAAQC,EAAM,CAAC,EA9B5CuH,IAEA,IAAIlI,EAAU,IAAI,GAAG,cAAc,YAC/BC,EAAMD,EAAQ,QAAQ,EACtB6H,EAAY5H,EAAI,eAAe,EAE/B0G,EAASkB,EAAU,QAAQZ,CAAO,EAClCa,EAAWnB,EAAO,UAAU,EAChC3G,EAAQ,KAAK8H,CAAQ,EAErB,IAAIC,EAAO,CAAE,EAAG/F,EAAG,SAAU8F,CAAS,EAsBtC9H,EAAQ,kBACN,SAAS,eAAe+H,EAAMI,CAAsB,EACpD,SAAS,eAAeJ,EAAMK,CAAmB,CACnD,CACF,CACF,CACF,CAEA,SAASC,GACPzI,EACA0I,EACAb,EACA,CACA,IAAIc,EACF3I,EACA,iDAEA0I,EACA,iBAEAb,EACA,SAEF,OAAOc,CACT,CAEA,IAAIC,EAAe,EACnB,SAASC,IAAsB,CAC7B7I,EAAyB,GAEzB,IAAIkH,EAAM,GASV,GARA,EAAE,UAAU,EAAE,KAAK,UAAY,CAC7B,IAAI4B,EAAK,EAAE,IAAI,EAAE,KAAK,OAAO,EAC7B,GAAIA,GAAMA,EAAG,GAAG,UAAU,EAAG,CAC3B,IAAIJ,EAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,YAAY,EAAE,KAAK,CAAC,EAChDA,GAAS,MAAQA,GAAS,KAAIxB,GAAO,OAASwB,EAAQ,QAC5D,CACF,CAAC,EAEGxB,GAAO,GAAI,CACbpH,EAAW,GAAG,GAAG,OAAO,gBACtB,iCACA,EACF,EACA,MACF,MACEoH,EAAM,2BAA6BA,EAAM,QAG3C,IAAI6B,EACF,yNACA7B,EACA,gtBAMF,EAAE,MAAM,EAAE,OAAO6B,CAAkB,EAEnC,IAAIC,EAAU,GAAG,GAAG,sBAAsB,EAC1CA,EAAQ,MAAQ,4CAChBA,EAAQ,0BAA4BC,EACpCD,EAAQ,KAAO,SAAS,eAAe,oBAAoB,EAC3D,GAAG,GAAG,YAAY,gBAAgBA,CAAO,CAC3C,CAEA,SAASC,EAA2BC,EAAQC,EAAO,CAC7CD,IAAW,GAAG,GAAG,aAAa,KAChCnJ,EAAe,GAAG,GAAG,YAAY,0BAC/B,iBACA,gCACA,IACA,GACF,EAEA,WAAW,UAAY,CACrBqJ,EAA2B,CAC7B,EAAG,GAAI,EAEX,CAEA,SAASA,GAA6B,CACpC,IAAIhJ,EAAU,IAAI,GAAG,cAAc,YAC/BC,EAAMD,EAAQ,QAAQ,EAEtBiJ,EAAYhJ,EACb,UAAU,EACV,WAAW,MAAM,OAAO,UAAU,yBAAyB,CAAC,EAC3DiJ,EAAiB,IAAI,GAAG,UAC5BA,EAAe,YACb,sJACF,EACA,IAAIC,EAAuBF,EAAU,SAASC,CAAc,EAC5DlJ,EAAQ,KACNmJ,EACA,4CACF,EAEA,SAAS3I,EAAUE,EAAQC,EAAM,CAI5B,MAAM,OAAO,UAAU,yBACtBwI,EACAtJ,CACF,GAEA,MAAM,OAAO,UAAU,kBACrBoJ,EACApJ,EACA,IACF,EAGF2I,EAAe,EACf,EAAE,UAAU,EAAE,KAAK,UAAY,CAC7B,IAAIE,EAAK,EAAE,IAAI,EAAE,KAAK,OAAO,EAC7B,GAAIA,GAAMA,EAAG,GAAG,UAAU,EAAG,CAC3B,IAAIJ,EAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,YAAY,EAAE,KAAK,CAAC,EAChDA,GAAS,MAAQA,GAAS,IAAIE,GACpC,CACF,CAAC,EAEGA,GAAgB,IAClB9I,EAAW,GAAG,GAAG,OAAO,gBACtB,iCACA,EACF,EAEAC,EAAa,MAAM,GAGrB,IAAIyJ,EAAM,EACV,EAAE,UAAU,EAAE,KAAK,UAAY,CAC7B,IAAIV,EAAK,EAAE,IAAI,EAAE,KAAK,OAAO,EAEzBJ,EAAQ,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,YAAY,EAAE,KAAK,CAAC,EAGpD,GAAII,GAAMA,EAAG,GAAG,UAAU,GAAKJ,GAAS,MAAQA,GAAS,GAAI,CAC3D,IAAIb,EAAQ3H,EAAgBwI,CAAK,EACjCb,EAAQE,GAAqBF,CAAK,EAElC,IAAI4B,EACF,2CAA6Cf,EAAQ,IACnDC,EAAYF,GACdzI,EACA0I,EACAb,CACF,EACI6B,EAAiB,IAAI,GAAG,4BAC5BA,EAAe,cACb,SAAS,SACP,KACA,SAAS,KACT,MAAM,OAAO,UAAU,WAAW,EAClC,UACA,MAAM,OAAO,UAAU,wBAAwB,EAC/C,IACAzJ,CACJ,EACA,IAAI0J,EAAiBN,EAAU,QAAQK,CAAc,EACrDC,EAAe,SAAS,QAASF,CAAY,EAC7CE,EAAe,SAAS,OAAQhB,CAAS,EACzCgB,EAAe,SAAS,KAAMjB,CAAK,EACnCiB,EAAe,SAAS,mBAAoB,iBAAiB,EAC7DA,EAAe,OAAO,EAEtBvJ,EAAQ,kBACN,UAAY,CACVoJ,IACIA,GAAOZ,IACT7I,EAAa,MAAM,EAEnBD,EAAW,GAAG,GAAG,OAAO,gBACtB,wCACA,EACF,EAEA8J,GAAsB,EAG1B,EACA,SAAU9I,EAAQC,EAAM,CAEtBhB,EAAa,MAAM,EACnB,MACE,mBACEgB,EAAK,YAAY,EACjB;AAAA,EACAA,EAAK,eAAe,CACxB,EACAQ,EAAY,CACd,CACF,CACF,CACF,CAAC,CACH,CACA,SAASV,EAAUC,EAAQC,EAAM,CAC/BhB,EAAa,MAAM,CACrB,CAEAK,EAAQ,kBAAkBQ,EAAWC,CAAS,CAChD,CAEA,SAASgJ,IAAsB,CAC7B,EAAE,sBAAsB,EAAE,KAAK,WAAY,EAAK,EAEhD,EAAE,UAAU,EAAE,KAAK,UAAY,CAC7B,IAAIf,EAAK,EAAE,IAAI,EAAE,KAAK,OAAO,EACzBA,GAAM,CAACA,EAAG,GAAG,UAAU,GACzBA,EAAG,KAAK,UAAW,EAAI,CAE3B,CAAC,CACH,CAEA,SAASc,IAAwB,CAC/B,EAAE,sBAAsB,EAAE,KAAK,WAAY,EAAI,EAE/C,EAAE,UAAU,EAAE,KAAK,UAAY,CAC7B,IAAId,EAAK,EAAE,IAAI,EAAE,KAAK,OAAO,EACzBA,GAAMA,EAAG,GAAG,UAAU,GACxBA,EAAG,KAAK,UAAW,EAAK,CAE5B,CAAC,CACH,CAEA,SAASf,GAAqB3D,EAAO,CACnC,GAAIA,GAAS,MAAQA,GAAS,GAAI,MAAO,GAEzCA,EAAQA,EAAM,QAAQ,OAAQ,GAAG,EACjC,IAAI0F,EAAU1F,EAAM,MAAM,GAAG,EAC7B0F,EAAUA,EAAQ,KAAK,EAEvB,QADI3C,EAAS,OACJ/E,EAAI,EAAGA,EAAI0H,EAAQ,OAAQ1H,IAC9B0H,EAAQ1H,CAAC,GAAK,MAAQ,EAAE,KAAK0H,EAAQ1H,CAAC,CAAC,IACzC+E,GAAU,OAAS2C,EAAQ1H,CAAC,EAAI,SAGpC,OAAA+E,GAAU,QACHA,CACT,CAuDA,SAAS4C,IAAgB,CACvB,IAAIC,EAAuB,IAAI,MAC3BC,EAAmB,IAAI,MAE3B,EAAE,2BAA2B,EAAE,KAAK,UAAY,CAC9C,IAAIC,EAAM,EAAE,IAAI,EAAE,KAAK,EAClB,MAAM,OAAO,UAAU,YAAYF,EAAsBE,CAAG,GAC/DF,EAAqB,KAAKE,CAAG,CACjC,CAAC,EAED,EAAE,2BAA2B,EAAE,KAAK,UAAY,CAC9C,IAAIA,EAAM,EAAE,IAAI,EAAE,KAAK,EAClB,MAAM,OAAO,UAAU,YAAYD,EAAkBC,CAAG,GAC3DD,EAAiB,KAAKC,CAAG,CAC7B,CAAC,EAED,MAAM,OAAO,UAAU,WACrBF,EACA,wBACA,EACF,EACA,MAAM,OAAO,UAAU,WACrBC,EACA,+BACA,EACF,CACF,CAEA,SAASE,GAAgBC,EAAe,CACtCtK,EAAW,GAAG,GAAG,OAAO,gBACtB,uBAAyBsK,EAAgB,IACzC,EACF,EAEA,EAAE,uBAAuB,EAAE,IAAIA,CAAa,EAAE,OAAO,EAErD,EAAE,OAAO,EAAE,KAAK,CAAE,OAAQ,CAAE,CAAC,CAC/B,CAEA,SAASC,GAAiBC,EAAe,CACvCxK,EAAW,GAAG,GAAG,OAAO,gBACtB,wBAA0BwK,EAAgB,IAC1C,EACF,EAEA,EAAE,8BAA8B,EAAE,IAAIA,CAAa,EAAE,OAAO,EAE5D,EAAE,OAAO,EAAE,KAAK,CAAE,OAAQ,CAAE,CAAC,CAC/B,CAEA,SAAStJ,IAAyB,CAChCuJ,GAAoB,YAAa,eAAe,EAGhDC,GAAqB,UAAW,oBAAqB,cAAc,EAEnE/D,GAA+B,EAE/B,EAAE,eAAe,EAAE,OAAO,UAAY,CACpC,EAAE,uBAAuB,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,EAE5C,WAAW,UAAY,CACrBgE,GAAe,CACjB,EAAG,EAAE,CACP,CAAC,EAED,EAAE,uBAAuB,EAAE,OAAO,UAAY,CAC5C,EAAE,eAAe,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,EAEpC,WAAW,UAAY,CACrBA,GAAe,CACjB,EAAG,EAAE,CACP,CAAC,EAED,EAAE,8BAA8B,EAAE,OAAO,UAAY,CACnD,WAAW,UAAY,CACrBC,GAAgB,CAClB,EAAG,EAAE,CACP,CAAC,EAED,EAAE,aAAa,EAAE,MAAM,UAAY,CACjCC,GAAY,CACd,CAAC,EACD,EAAE,YAAY,EAAE,MAAM,UAAY,CAChCC,GAAU,CACZ,CAAC,EAED,EAAE,wBAAwB,EAAE,MAAM,UAAY,CAC5CC,GAAsB,CACxB,CAAC,EAED,EAAE,sBAAsB,EAAE,MAAM,UAAY,CAC1ChC,GAAoB,CACtB,CAAC,EAED,EAAE,mBAAmB,EAAE,MAAM,UAAY,CACvCiC,GAA2B,CAC7B,CAAC,EAED,EAAE,yBAAyB,EAAE,MAAM,UAAY,CAC7C,EAAE,iBAAiB,EAAE,OAAO,EAE5B,EAAE,aAAa,EAAE,KAAK,UAAY,CAChC,GAAI,EAAE,IAAI,EAAE,KAAK,EAAE,YAAY,EAAE,QAAQ,MAAM,GAAK,EAAG,CACrD,IAAIC,EAAgB,GAEpB,EAAE,IAAI,EACH,KAAK,IAAI,EACT,KAAK,UAAY,CAChB,IAAIC,EAAU,EAAE,IAAI,EAAE,KAAK,EACvBC,EAAQD,EAAQ,QAAQ,GAAG,EAC3BC,GAAS,IAAGD,EAAUA,EAAQ,UAAU,EAAGC,CAAK,GACpDD,EAAU,EAAE,KAAKA,CAAO,EAExBD,GAAiBC,EAAU,GAC7B,CAAC,EAEH,EAAE,IAAI,EAAE,KAAKD,CAAa,CAC5B,CACF,CAAC,CACH,CAAC,EAED,EAAE,UAAU,EAAE,MAAM,UAAY,CAC1B,EAAE,IAAI,EAAE,GAAG,UAAU,EAAGlB,GAAoB,EAC3CD,GAAsB,CAC7B,CAAC,CACH,CAEA,SAASe,IAAc,CACrB,IAAI3B,EAAU,GAAG,GAAG,sBAAsB,EAC1CA,EAAQ,MAAQ,6BAEhBA,EAAQ,SAAW,GACnBA,EAAQ,0BAA4BkC,EAEpClC,EAAQ,IACN,MAAM,OAAO,UAAU,WAAW,EAClC,UACA,MAAM,OAAO,UAAU,yBAAyB,EAElD,GAAG,GAAG,YAAY,gBAAgBA,CAAO,CAC3C,CAEA,SAAS4B,IAAY,CACnB,IAAIO,EAAW,eACXnC,EAAU,GAAG,GAAG,sBAAsB,EAC1CA,EAAQ,MAAQ,oBAEhBA,EAAQ,SAAW,GACnBA,EAAQ,0BAA4BkC,EAEpClC,EAAQ,IACN,MAAM,OAAO,UAAU,WAAW,EAClC,UACA,MAAM,OAAO,UAAU,yBAAyB,EAChD,IACAmC,EAEF,GAAG,GAAG,YAAY,gBAAgBnC,CAAO,CAC3C,CAGA,SAASyB,IAAiB,CACxB,IAAIW,EAAY,EAAE,eAAe,EAAE,IAAI,EAIvC,EAAE,oBAAoB,EAAE,KAAK,UAAY,CACvC,IAAIC,EAAO,GAGT,CAACA,GACDD,GAAa,IACb,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,2BAA2B,EAAE,KAAK,CAAC,GAAKA,IAE5DC,EAAO,IAGLA,EAAM,EAAE,IAAI,EAAE,KAAK,EAClB,EAAE,IAAI,EAAE,KAAK,CACpB,CAAC,EAID,EAAE,qBAAqB,EAAE,KAAK,UAAY,CACxC,IAAIA,EAAO,GAGT,CAACA,GACDD,GAAa,IACb,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,4BAA4B,EAAE,KAAK,CAAC,GAAKA,IAE7DC,EAAO,IAGLA,EAAM,EAAE,IAAI,EAAE,KAAK,EAClB,EAAE,IAAI,EAAE,KAAK,CACpB,CAAC,CACH,CAGA,SAASX,IAAkB,CACzB,IAAIJ,EAAgB,EAAE,8BAA8B,EAAE,IAAI,EAI1D,EAAE,2BAA2B,EAAE,KAAK,UAAY,CAC9C,IAAIe,EAAO,GAGT,CAACA,GACDf,GAAiB,IACjB,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,iCAAiC,EAAE,KAAK,CAAC,GAC3DA,IAEFe,EAAO,IAGLA,EAAM,EAAE,IAAI,EAAE,KAAK,EAClB,EAAE,IAAI,EAAE,KAAK,CACpB,CAAC,CACH,CAEA,SAASd,GAAoBe,EAAUC,EAAQ,CAC7C,IAAIC,EAAY,iDAChB,EAAEF,CAAQ,EAAE,GAAG,QAAS,UAAY,CAClCG,EAAUD,EAAWD,CAAM,CAC7B,CAAC,CACH,CAEA,SAASf,GAAqBkB,EAAWC,EAAgBC,EAAK,CAC5D,EAAEF,CAAS,EAAE,GAAG,QAAS,SAAUG,EAAO,CACxC,IAAIC,EAAU,IAAI,KAAK,EAAE,OAAO,UAAU,EAC1CC,EAAYJ,EAAiBG,EAASF,CAAG,CAC3C,CAAC,CACH,CAIA,SAASH,EAAUtH,EAAO6H,EAAW,CACnC,IAAIF,EAAU,IAAI,KACdG,EACF,MAAM,OAAO,UAAU,WAAW,EAClC,2CACAH,EAAQ,OAAO,YAAY,EACzBI,EACF,MAAM,OAAO,UAAU,WAAW,EAClC,sCACAJ,EAAQ,OAAO,YAAY,EACzBK,EACF,MAAM,OAAO,UAAU,WAAW,EAClC,4CACAL,EAAQ,OAAO,YAAY,EAEzBM,EAAY,EAAEJ,CAAS,EAAE,KAAK,EAE9BK,EAAkBP,EAAQ,OAAO,qBAAqB,EAC1DO,EACE,qCAAuCA,EAAkB,SAC3DD,EAAYC,EAAkBD,EAE9B,IAAIE,EAAW,EAAE,aAAa,EAC1BC,EAAW,EAAE,aAAa,EAC1BC,EAAW,EAAE,aAAa,EAE1BC,EAAO,EAAE,SAAS,EAClBC,EAAO,EAAE,SAAS,EAClBC,EAAO,EAAE,SAAS,EAElBC,EAAc,GAClBN,EAAS,KAAKL,EAAU,UAAY,CAClCW,GAAe,UAAYN,EAAS,KAAK,EAAI,WAC7CG,EAAK,QAAQ,CACf,CAAC,EACDF,EAAS,KAAKL,EAAU,UAAY,CAClCU,GAAe,UAAYL,EAAS,KAAK,EAAI,WAC7CG,EAAK,QAAQ,CACf,CAAC,EACDF,EAAS,KAAKL,EAAU,UAAY,CAClCS,GAAe,UAAYJ,EAAS,KAAK,EAAI,WAC7CG,EAAK,QAAQ,CACf,CAAC,EAED,EAAE,KAAKF,EAAMC,EAAMC,CAAI,EAAE,KAAK,UAAY,CACxC,IAAIE,EACF;AAAA;AAAA;AAAA,SAGA1I,EACA;AAAA,EACAyI,EACA;AAAA;AAAA;AAAA;AAAA,EAMAR,EACA;AAAA;AAAA,SAIEU,EAAU,OAAO,KAAK,GAAI,cAAc,EAC5CA,EAAQ,SAAS,KAAK,EAEtBA,EAAQ,SAAS,MAAMD,CAAI,EAE3BC,EAAQ,SAAS,MAAM,EAEvBA,EAAQ,MAAM,CAChB,CAAC,CACH,CAGA,SAASf,EAAYgB,EAAUC,EAAWC,EAAc,CACtD,IAAI9E,EAAO+E,GAAcF,CAAS,EAC9BC,GAAgB,KAAM9E,EAAOA,EAAK,MAAM,CAAC,GAE7C,IAAIgF,EAAMC,GAAajF,CAAI,EAC3B,GAAI,UAAU,UAAU,OAAO,SAAS,GAAK,EAC3C,OAAO,YAAY,SAAS,KAAK,YAAa,SAAS,EACvD,OAAO,YAAY,SAAS,MAAMgF,CAAG,EACrC,OAAO,YAAY,SAAS,MAAM,EAClC,OAAO,YAAY,MAAM,EACzB,OAAO,YAAY,SAAS,YAC1B,SACA,GACAJ,EAAW,MACb,MACK,CACL,IAAIM,EAAM,+BAAiC,OAAOF,CAAG,EACjDG,EAAe,SAAS,cAAc,GAAG,EAC7CA,EAAa,KAAOD,EACpBC,EAAa,SAAWP,EAAW,OACnC,SAAS,KAAK,YAAYO,CAAY,EACtCA,EAAa,MAAM,EACnB,SAAS,KAAK,YAAYA,CAAY,CACxC,CACF,CAEA,SAASJ,GAAcF,EAAW,CAIhC,QAHIO,EAAQ,SAAS,eAAeP,CAAS,EAEzCQ,EAAa,CAAC,EACT9K,EAAI,EAAG+K,EAAIF,EAAM,KAAK,OAAQ7K,EAAI+K,EAAG/K,IAAK,CACjD8K,EAAW9K,CAAC,EAAI,CAAC,EACjB,QAASgL,EAAI,EAAGC,EAAIJ,EAAM,KAAK7K,CAAC,EAAE,MAAM,OAAQgL,EAAIC,EAAGD,IAAK,CAC1D,IAAIE,EACFL,EAAM,KAAK7K,CAAC,EAAE,MAAMgL,CAAC,EAAE,aACvBH,EAAM,KAAK7K,CAAC,EAAE,MAAMgL,CAAC,EAAE,UACzBF,EAAW9K,CAAC,EAAEgL,CAAC,EAAIE,EAAK,KAAK,CAC/B,CACF,CACA,OAAOJ,CACT,CAEA,SAASJ,GAAaS,EAAU,CAM9B,QALIC,EAAQ,OAAOD,GAAY,SAAW,KAAK,MAAMA,CAAQ,EAAIA,EAC7DE,EAAM;AAAA,EACNC,EAAO,GACP/C,EACA9B,EACK8E,EAAI,EAAGA,EAAIH,EAAM,OAAQG,IAAK,CACrCD,EAAO,GACP,IAAIE,EAASJ,EAAMG,CAAC,EACpB,IAAKhD,KAASiD,EACRA,EAAO,eAAejD,CAAK,IAC7B9B,EAAQ+E,EAAOjD,CAAK,EAAI,GACxB+C,GAAQ,IAAM7E,EAAM,QAAQ,KAAM,IAAI,EAAI,MAG9C6E,EAAOA,EAAK,MAAM,EAAG,EAAE,EACvBD,GAAOC,EAAO;AAAA,CAChB,CACA,OAAOD,CACT,CAEA,SAASI,GAA6BrH,EAASD,EAAW,CAWxD,IAAIuH,EAAa,OAAO,KACtB,SAAS,SACP,KACA,SAAS,KACT,MAAM,OAAO,UAAU,WAAW,EAClC,2CACAtH,EACA,UACJ,EAGA,WAAW,UAAY,CACrBsH,EAAW,SAAS,MAAQ,UAAYvH,CAC1C,EAAG,GAAI,CACT,CAEA,SAASiE,IAA6B,CACpC,IAAI9B,EAAU,GAAG,GAAG,sBAAsB,EAC1CA,EAAQ,MAAQ,qBAGhBA,EAAQ,SAAW,GACnBA,EAAQ,0BAA4BkC,EAEpClC,EAAQ,IACN,MAAM,OAAO,UAAU,WAAW,EAClC,4CACA,MAAM,OAAO,UAAU,WAAW,EAClC,UACA,MAAM,OAAO,UAAU,wBAAwB,EAC/C,IACA/I,EAEF,GAAG,GAAG,YAAY,gBAAgB+I,CAAO,CAC3C,CAEA,SAAS6B,IAAwB,CAC/B,IAAI7B,EAAU,GAAG,GAAG,sBAAsB,EAC1CA,EAAQ,MAAQ,qBAChBA,EAAQ,OAAS,MACjBA,EAAQ,SAAW,GACnBA,EAAQ,0BAA4BkC,EAEpClC,EAAQ,IACN,MAAM,OAAO,UAAU,WAAW,EAAI,oCAExC,GAAG,GAAG,YAAY,gBAAgBA,CAAO,CAC3C,CAEA,SAASqF,GAAwBnF,EAAQC,EAAO,CAEhD,CAEA,SAASmF,GAA0BpF,EAAQC,EAAO,CAChD5H,EAAY,CACd,CAEA,SAAS2J,EAAehC,EAAQC,EAAO,CACjCD,IAAW,GAAG,GAAG,aAAa,IAChC3H,EAAY,CAEhB,CAEA,IAAIgN,GAAgB,CAClB,YAAa,SAAUC,EAAY,CACjCrE,GAAgBqE,CAAU,CAC5B,EACA,aAAc,SAAUlE,EAAe,CACrCD,GAAiBC,CAAa,CAChC,EACA,yBAA0B,SAAUxD,EAASD,EAAW,CACtDsH,GAA6BrH,EAASD,CAAS,CACjD,EACA,aAAc,UAAY,CACxB,OAAA7G,EAAyB,EAAE,uBAAuB,EAAE,IAAI,EAKjDA,CACT,EACA,QAASuB,CACX,EAEA,OAAOgN,EACT",
  "names": ["html", "permissionsTemplate", "InitReport", "m_siteUrl", "m_listTitleRequests", "m_listNameRequests", "m_listTitleRequestsInternal", "m_listNameRequestsInternal", "m_listTitleResponses", "m_listNameResponses", "m_libTitleRequestDocs", "m_libNameRequestDocs", "m_libTitleCoverSheet", "m_libNameCoverSheet", "m_libTitleResponseDocs", "m_libNameResponseDocs", "m_libTitleResponseDocsEA", "m_libNameResponseDocsEA", "m_listTitleActionOffices", "m_listNameActionOffices", "m_listTitleEmailHistory", "m_listNameEmailHistory", "m_listTitleBulkResponses", "m_listNameBulkResponses", "m_listTitleBulkPermissions", "m_listNameBulkPermissions", "m_groupNameSpecialPermName1", "m_groupNameSpecialPermName2", "m_groupNameQA", "m_groupNameEA", "m_libResponseDocsLibraryGUID", "m_arrSiteGroups", "m_arrAOs", "m_fnRefresh", "hard", "curPath", "tabIndex", "responseNumOpen", "responseNumProcessed", "m_fnOnLoadDisplayTimeStamp", "curDate", "m_fnOnLoadDisplayTabAndResponse", "paramTabIndex", "bFiltered", "paramResponseNum", "m_fnOnLoadFilterResponses", "responseStatus1", "responseStatus2", "count", "cntOpen", "cntReOpened", "resStatus1", "resStatus2", "eacher", "reqStatus", "resStatus", "m_fnLoadSiteGroups", "itemColl", "listItemEnumerator", "oListItem", "id", "loginName", "title", "groupObject", "m_fnGetSPSiteGroup", "groupName", "userGroup", "x", "m_fnLoadActionOffices", "aoObject", "m_fnGetAOSPGroupName", "oGroup", "m_fnCheckSPItemHasGroupPermission", "item", "permissionLevel", "match", "roleAssignments", "rolesEnumerator", "role", "roleMember", "memberTitleName", "roleDefs", "roleDefsEnumerator", "rd", "rdName", "m_fnGoToResponse", "responseTitle", "isIA", "bFound", "m_fnGetResponseDocStyleTag2", "documentStatus", "styleTag", "m_fnGetResponseDocStyleTag", "m_fnCheckIfEmailFolderExists", "items", "requestNumber", "bFolderExists", "folderItem", "itemName", "m_cntAddToEmailFolder", "m_cntAddedToEmailFolder", "m_fnCreateEmailFolder", "list", "requestItem", "OnComplete", "currCtx", "web", "itemCreateInfo", "roleDefBindingCollAdmin", "roleDefBindingCollContribute", "roleDefBindingCollRestrictedRead", "roleDefBindingCollRestrictedContribute", "spGroupQA", "onUpdatePermsSucceeded", "arrActionOffice", "actionOfficeName", "actionOfficeGroupName", "actionOfficeGroup", "onUpdateAOPermsSucceeded", "onUpdateAOPermsFailed", "sender", "args", "currCtx2", "web2", "data", "onUpdatePermsFailed", "m_fnSortResponseTitleNoCase", "a", "b", "aTitle", "bTitle", "newA", "newB", "aIndex", "subA", "lastA", "intA", "newIntA", "bIndex", "subB", "lastB", "intB", "newIntB", "m_fnSortResponseObjectNoCase", "m_fnSortNoCase", "m_fnSortDate", "m_fnAddOptions", "arr", "ddlID", "dateSort", "responseSort", "rOptions", "j", "arrLength", "option", "thisDDL", "m_fnExistsInArr", "val", "m_fnGetTrueFalseIcon", "m_fnGetFriendlyDisplayName", "fieldName", "user", "m_fnPadDigits", "n", "totalDigits", "pd", "i", "m_fnPreciseRound", "num", "decimals", "sign", "m_fnGetFriendlyFileSize", "fileSize", "m_fnISODateString", "d", "pad", "m_fnBindHandlerResponseDoc", "event", "curIcon", "m_fnGetLookupFormField", "fieldTitle", "m_fnGetLookupDisplayText", "m_fnSetLookupFromFieldNameByText", "text", "theSelect", "m_fnGetTagFromIdentifierAndTitle", "theInput", "opt", "m_fnSetSelectedOptionByText", "select", "opts", "optLength", "tagName", "identifier", "idLength", "tags", "tagID", "m_fnViewUserManuals", "docType", "options", "m_fnPrintPage", "pageTitle", "divTbl", "siteUrl", "cssLink1", "cssLink2", "divOutput", "updatedDivOutput", "printDateString", "cssFile1", "cssFile2", "def1", "def2", "cssFileText", "html", "printWP", "m_fnExportToCsv", "fileName", "tableName", "removeHeader", "m_fnGetCellValues", "csv", "m_fnConvertToCsv", "uri", "downloadLink", "table", "deets", "tableArray", "r", "c", "m", "objArray", "array", "str", "line", "index", "value", "array1", "publicMembers", "libGUID", "permissionsTemplate", "InitPermissions", "m_arrRequests", "m_arrResponses", "m_arrResponseFolders", "m_arrGroups", "m_collGroup", "m_ownerGroupName", "m_memberGroupName", "m_visitorGroupName", "notifyId", "m_waitDialog", "m_txtOutgoingEmailText", "m_emailFolderName", "m_oAOGroupUsers", "LoadInfo", "currCtx", "web", "aoList", "aoQuery", "m_aoItems", "ownerGroup", "memberGroup", "visitorGroup", "OnSuccess", "OnFailure", "sender", "args", "m_fnBindHandlersOnLoad", "m_fnOnLoadDisplayTab", "isModalDlg", "doneLoadingSPGroupPermissions", "m_fnLoadSPGroupPermissions", "m_fnDisplaySPGroupPermissions", "m_fnDisplaySPGroupPermissions2", "m_fnRefresh", "curPath", "tabIndex", "paramTabIndex", "m_fnLoadRequestPermissions", "listItemEnumerator", "oListItem", "id", "number", "status", "sample", "arrActionOffice", "actionOffice", "x", "requestObject", "m_fnLoadPermsOnItem", "arrRequestIDs", "errorCount", "sTablePermissionsBody", "r", "j", "reqLength", "oRequest", "actionOffices", "permsDisplay", "hasSecialPerms", "flagItem", "errToolTip", "actionOfficeName", "groupNameActionOffice", "bFoundPermission", "z", "bError", "bFound", "name", "styleTag", "link", "m_fnLoadResponsePermissions", "responseObject", "arrErrorRequestNoSpecialPerms", "arrErrorResponseHasSpecialPerms", "arrErrorResponseActionOfficeNotInRequest", "responseLength", "oResponse", "title", "perms", "hasSpecialPerms", "bRequestSpecialPerms", "requestSpecialPerms", "arrRequestActionOffices", "requestActionOffices", "y", "responseActionOfficeIsInRequest", "errorMsg1", "m_fnGetErrorMsg", "errorMsg2", "errorMsg3", "m_fnLoadResponseFolderPermissions", "folderName", "responseFolderObject", "resFolderLength", "oResponseFolder", "responseActionOffice", "responseSpecialPerms", "arr", "msgTitle", "errorMsg", "item", "roleAssignments", "rolesEnumerator", "role", "roleMember", "memeberLoginName", "memberTitleName", "permissionType", "principalType", "roleDefs", "roleDefsEnumerator", "rd", "rdName", "pmObject", "specialPerms", "m_fnBindHandlerPermissionLinks", "OnCompleteLoading", "OnSuccess1", "listEnumerator", "groupName", "groupID", "oGroup", "OnFailure1", "itemCollection", "aos", "output", "aoCnt", "groupId", "count", "cntGroupsToLoad", "onLoadGroupSucceeded", "arrPerms", "listEnumerator1", "item1", "displayName", "users", "g", "m_fnGetFriendlyUsers", "onLoadGroupFailed", "collGroup", "collUser", "data", "arrSPGroups", "spGroupCnt", "cntSPGroupsToLoad", "onLoadSPGroupSucceeded", "onLoadSPGroupFailed", "m_fnFormatEmailBodyToAOForVerification", "group", "emailText", "m_emailCount", "m_fnGetVerification", "cb", "verificationDocDlg", "options", "OnCallbackSendVerification", "result", "value", "m_fnSendVerificationEmails", "emailList", "emailListQuery", "emailListFolderItems", "cnt", "emailSubject", "itemCreateInfo", "oListItemEmail", "m_fnUncheckCheckboxes", "m_fnCheckCheckboxes", "permArr", "LoadDDOptions", "arrResponseRequestID", "arrResponseTitle", "val", "m_fnGoToRequest", "requestNumber", "m_fnGoToResponse", "responseTitle", "m_fnBindPrintButton", "m_fnBindExportButton", "FilterRequests", "FilterResponses", "m_fnViewAOs", "m_fnAddAO", "m_fnUploadPermissions", "m_fnViewEmailHistoryFolder", "friendlyNames", "curText", "index", "OnCallbackForm", "formName", "requestID", "hide", "btnPrint", "divTbl", "pageTitle", "PrintPage", "btnExport", "fileNamePrefix", "tbl", "event", "curDate", "ExportToCsv", "container", "cssLink1", "cssLink2", "cssLink3", "divOutput", "printDateString", "cssFile1", "cssFile2", "cssFile3", "def1", "def2", "def3", "cssFileText", "html", "printWP", "fileName", "tableName", "removeHeader", "GetCellValues", "csv", "ConvertToCsv", "uri", "downloadLink", "table", "tableArray", "n", "c", "m", "text", "objArray", "array", "str", "line", "i", "array1", "m_fnViewSitePermissionsGroup", "vPermGroup", "OnCallbackFormNoRefresh", "OnCallbackFormAutoRefresh", "publicMembers", "requestNum"]
}
