{
  "version": 3,
  "sources": ["../../../src/pages/permissions/Permissions_Template.js", "../../../src/common/utilities.js", "../../../src/pages/permissions/permissions.js"],
  "sourcesContent": ["\uFEFFconst html = String.raw;\r\n\r\nexport const permissionsTemplate = html`\r\n  <div class=\"audit\">\r\n    <iframe id=\"CsvExpFrame\" style=\"display: none\"></iframe>\r\n\r\n    <div style=\"padding-bottom: 10px\">\r\n      <a\r\n        id=\"btnRefresh\"\r\n        title=\"Refresh this page\"\r\n        style=\"display: none\"\r\n        href=\"javascript:void(0)\"\r\n        onclick=\"Audit.Permissions.Report.Refresh()\"\r\n        ><span class=\"ui-icon ui-icon-refresh\"></span>Refresh</a\r\n      >\r\n    </div>\r\n\r\n    <div id=\"divLoading\" style=\"color: green; padding-bottom: 10px\">\r\n      Please Wait... Loading\r\n    </div>\r\n\r\n    <div id=\"divErrorMsg\" style=\"color: red; padding-bottom: 10px\"></div>\r\n\r\n    <div id=\"tabs\" style=\"display: none; margin-top: 20px\">\r\n      <ul>\r\n        <li><a href=\"#tabs-0\">Action Office Groups and Users</a></li>\r\n        <li><a href=\"#tabs-1\">Site Groups and Users</a></li>\r\n        <li style=\"display: none\"><a href=\"#tabs-2\">Request Permissions</a></li>\r\n        <li style=\"display: none\">\r\n          <a href=\"#tabs-3\">Response Permissions</a>\r\n        </li>\r\n        <li style=\"display: none\">\r\n          <a href=\"#tabs-4\">Response Folder Permissions</a>\r\n        </li>\r\n      </ul>\r\n\r\n      <div id=\"tabs-0\">\r\n        <fieldset style=\"width: 300px\">\r\n          <legend>Actions</legend>\r\n          <a\r\n            style=\"display: none\"\r\n            id=\"btnPrint\"\r\n            title=\"Click here to Print\"\r\n            href=\"javascript:void(0)\"\r\n            class=\"hideOnPrint\"\r\n            ><span class=\"ui-icon ui-icon-print\">Print</span></a\r\n          >\r\n          <a\r\n            style=\"display: none\"\r\n            class=\"export hideOnPrint\"\r\n            title=\"Export to CSV\"\r\n            href=\"#\"\r\n            ><span class=\"ui-icon ui-icon-disk\">Export to CSV</span></a\r\n          >\r\n\r\n          <div>\r\n            <a\r\n              id=\"linkGetVerification\"\r\n              title=\"Select Action Office(s) to Obtain Verification of User\"\r\n              disabled=\"disabled\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-gear\"></span>Obtain Action Office\r\n              Verification</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              id=\"linkEmailHistory\"\r\n              title=\"View Email History\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-search\"></span>View Email History</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              id=\"linkUploadPermissions\"\r\n              title=\"Import Users to SharePoint Groups\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-person\"></span>Import Users into\r\n              Groups</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              id=\"linkViewAO\"\r\n              title=\"View Action Offices\"\r\n              href=\"javascript:void(0)\"\r\n              ><span class=\"ui-icon ui-icon-search\"></span>View Action Office\r\n              Details</a\r\n            >\r\n          </div>\r\n          <div>\r\n            <a\r\n              title=\"Add Action Office\"\r\n              href=\"#\"\r\n              id=\"linkAddAO\"\r\n              title=\"Add Action Office\"\r\n              ><span class=\"ui-icon ui-icon-circle-plus\"></span>Add Action\r\n              Office</a\r\n            >\r\n          </div>\r\n        </fieldset>\r\n        <div id=\"divTblOutput\" style=\"width: 100%; padding-bottom: 10px\">\r\n          <table id=\"table_Groups\" class=\"tablesorter\">\r\n            <thead>\r\n              <tr>\r\n                <th class=\"removeOnExport\">\r\n                  <input\r\n                    class=\"cbAOAll\"\r\n                    id=\"cbAOAll\"\r\n                    type=\"checkbox\"\r\n                    style=\"cursor: pointer\"\r\n                  />\r\n                  Check All?\r\n                </th>\r\n                <th>Action Office</th>\r\n                <th>SharePoint Group Name</th>\r\n                <th>\r\n                  Users<a\r\n                    id=\"linkViewExportFriendly\"\r\n                    style=\"float: right\"\r\n                    title=\"View Export Friendly\"\r\n                    href=\"javascript:void(0)\"\r\n                    ><span class=\"ui-icon ui-icon-gear\"></span>View Export\r\n                    Friendly</a\r\n                  >\r\n                </th>\r\n              </tr>\r\n            </thead>\r\n            <tbody id=\"fbody\"></tbody>\r\n            <tfoot>\r\n              <tr>\r\n                <th colspan=\"4\" style=\"text-align: left; white-space: nowrap\">\r\n                  Total: <span id=\"spanTotalAOS\">0</span>\r\n                </th>\r\n              </tr>\r\n            </tfoot>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <div id=\"tabs-1\">\r\n        <div\r\n          id=\"divTblSiteUsersOutput\"\r\n          style=\"width: 100%; padding-bottom: 10px\"\r\n        >\r\n          <table id=\"table_SiteGroups\" class=\"tablesorter\">\r\n            <thead>\r\n              <tr>\r\n                <th>SharePoint Group Name</th>\r\n                <th>Users</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody id=\"fbodySPGroups\"></tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <div id=\"tabs-2\">\r\n        <table id=\"tblRequestsPermissions\" class=\"tablesorter\">\r\n          <thead>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                <select id=\"ddlRequestID\"></select>\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n            </tr>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Request Number</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Status</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Action Offices(s)</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Special Perms?</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Permissions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody></tbody>\r\n          <tfoot>\r\n            <tr valign=\"top\">\r\n              <th nowrap=\"nowrap\" colspan=\"5\">\r\n                Total: <span id=\"tblRequestsPermsTotal\">0</span>\r\n              </th>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n\r\n      <div id=\"tabs-3\" style=\"display: none\">\r\n        <table id=\"tblResponsePermissions\" class=\"tablesorter\">\r\n          <thead>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                <select id=\"ddlResponseRequestID\"></select>\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n            </tr>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Request Number</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Response ID</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Status</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Action Offices(s)\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Action Office\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Permissions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody></tbody>\r\n          <tfoot>\r\n            <tr valign=\"top\">\r\n              <th nowrap=\"nowrap\" colspan=\"8\">\r\n                Total: <span id=\"tblResponsePermsTotal\">0</span>\r\n              </th>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n\r\n      <div id=\"tabs-4\" style=\"display: none\">\r\n        <table id=\"tblResponseFolderPermissions\" class=\"tablesorter\">\r\n          <thead>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                <select id=\"ddlResponseFolderResponseID\"></select>\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n            </tr>\r\n            <tr valign=\"top\">\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Request Number</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Response ID</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Folder Name</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Response Status</th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Action Offices(s)\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Action Office\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Request Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Response Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                Folder Special Perms?\r\n              </th>\r\n              <th class=\"sorter-false\" nowrap=\"nowrap\">Permissions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody></tbody>\r\n          <tfoot>\r\n            <tr valign=\"top\">\r\n              <th nowrap=\"nowrap\" colspan=\"10\">\r\n                Total: <span id=\"tblResponseFolderPermsTotal\">0</span>\r\n              </th>\r\n            </tr>\r\n          </tfoot>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  </div>\r\n`;\r\n", "\uFEFFwindow.Audit = window.Audit || {};\r\nAudit.Common = Audit.Common || {};\r\n\r\nvar loadStart;\r\nfunction InitReport() {\r\n  loadStart = new Date();\r\n  Audit.Common.Utilities = new Audit.Common.NewUtilities();\r\n  Audit.Common.Init();\r\n}\r\n\r\nAudit.Common.Init = function () {};\r\n\r\nAudit.Common.NewUtilities = function () {\r\n  var m_siteUrl = _spPageContextInfo.webServerRelativeUrl; //IE11 in sp 2013 does not recognize L_Menu_BaseUrl\r\n\r\n  var m_listTitleRequests = \"AuditRequests\";\r\n  var m_listNameRequests = \"AuditRequests\";\r\n\r\n  var m_listTitleRequestsInternal = \"AuditRequestsInternal\";\r\n  var m_listNameRequestsInternal = \"AuditRequestsInternal\";\r\n\r\n  var m_listTitleResponses = \"AuditResponses\";\r\n  var m_listNameResponses = \"AuditResponses\";\r\n\r\n  var m_libTitleRequestDocs = \"AuditRequestDocs\";\r\n  var m_libNameRequestDocs = \"AuditRequestDocs\";\r\n\r\n  var m_libTitleCoverSheet = \"AuditCoverSheets\";\r\n  var m_libNameCoverSheet = \"AuditCoverSheets\";\r\n\r\n  var m_libTitleResponseDocs = \"AuditResponseDocs\";\r\n  var m_libNameResponseDocs = \"AuditResponseDocs\";\r\n\r\n  var m_libTitleResponseDocsEA = \"AuditResponseDocsRO\";\r\n  var m_libNameResponseDocsEA = \"AuditResponseDocsRO\";\r\n\r\n  var m_listTitleActionOffices = \"AuditOrganizations\";\r\n  var m_listNameActionOffices = \"AuditOrganizations\";\r\n\r\n  var m_listTitleEmailHistory = \"AuditEmails\";\r\n  var m_listNameEmailHistory = \"AuditEmails\";\r\n\r\n  var m_listTitleBulkResponses = \"AuditBulkResponses\";\r\n  var m_listNameBulkResponses = \"AuditBulkResponses\";\r\n\r\n  var m_listTitleBulkPermissions = \"AuditBulkPermissions\";\r\n  var m_listNameBulkPermissions = \"AuditBulkPermissions\";\r\n\r\n  var m_groupNameSpecialPermName1 = \"CGFS Special Access1\";\r\n  var m_groupNameSpecialPermName2 = \"CGFS Special Access2\";\r\n  var m_groupNameQA = \"Quality Assurance\";\r\n  var m_groupNameEA = \"External Auditors\";\r\n\r\n  var m_libResponseDocsLibraryGUID = null;\r\n\r\n  var m_arrSiteGroups = null;\r\n  var m_arrAOs = null;\r\n  /**\r\n   * Reloads the page, trys to preserve current path\r\n   * @param {bool} hard flag to remove all url params\r\n   * @returns\r\n   */\r\n  function m_fnRefresh(hard = false) {\r\n    if (hard) {\r\n      location.href = location.pathname;\r\n      return;\r\n    }\r\n    var curPath = location.pathname;\r\n\r\n    if ($(\"#tabs\").html() != null && $(\"#tabs\").html() != \"\") {\r\n      var tabIndex = 0;\r\n      try {\r\n        tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n      } catch (ex) {}\r\n\r\n      curPath += \"?Tab=\" + tabIndex;\r\n\r\n      if (tabIndex == 0 && $(\"#ddlResponseName\").val() != \"\") {\r\n        curPath += \"&ResNum=\" + $(\"#ddlResponseName\").val();\r\n      } else if (tabIndex == 1) {\r\n        var responseNumOpen = $(\"#ddlResponsesOpen\").val();\r\n        var responseNumProcessed = $(\"#ddlResponsesProcessed\").val();\r\n\r\n        if (responseNumOpen != null && responseNumOpen != \"\")\r\n          curPath += \"&ResNum=\" + responseNumOpen;\r\n        else if (responseNumProcessed != null && responseNumProcessed != \"\")\r\n          curPath += \"&ResNum=\" + responseNumProcessed;\r\n      }\r\n\r\n      location.href = curPath;\r\n    } else {\r\n      location.reload();\r\n    }\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTimeStamp() {\r\n    var curDate = new Date();\r\n    const loadTime = (curDate - loadStart) / 1000;\r\n    document.getElementById(\r\n      \"divLoading\"\r\n    ).innerHTML = `Loaded at ${curDate.format(\"MM/dd/yyyy hh:mm tt\")}<br/>\r\n    Load time: ${loadTime + \"s\"}\r\n    `;\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTabAndResponse() {\r\n    var paramTabIndex = GetUrlKeyValue(\"Tab\");\r\n    if (paramTabIndex != null && paramTabIndex != \"\") {\r\n      $(\"#tabs\").tabs(\"option\", \"active\", paramTabIndex);\r\n    }\r\n\r\n    var bFiltered = false;\r\n\r\n    var paramResponseNum = GetUrlKeyValue(\"ResNum\");\r\n    if (paramResponseNum != null && paramResponseNum != \"\") {\r\n      if (paramTabIndex == 0) {\r\n        if (\r\n          $(\"#ddlResponseName option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponseName\").val(paramResponseNum).change();\r\n          bFiltered = true;\r\n        }\r\n      } else {\r\n        if (\r\n          $(\"#ddlResponsesOpen option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponsesOpen\").val(paramResponseNum).change();\r\n        } else if (\r\n          $(\"#ddlResponsesProcessed option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponsesProcessed\").val(paramResponseNum).change();\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!bFiltered) {\r\n      $(\".sr-response-item\").show(); //hiding rows by default\r\n    }\r\n  }\r\n\r\n  function m_fnOnLoadFilterResponses(responseStatus1, responseStatus2) {\r\n    var count = 0;\r\n    var cntOpen = 0;\r\n    var cntReOpened = 0;\r\n    var resStatus1 = 0;\r\n    var resStatus2 = 0;\r\n\r\n    var eacher = $(\".sr-response-item\");\r\n\r\n    eacher.each(function () {\r\n      var reqStatus = $.trim($(this).find(\".sr-response-requestStatus\").text());\r\n      var resStatus = $.trim($(this).find(\".sr-response-status\").text());\r\n\r\n      if (\r\n        (resStatus == responseStatus1 || resStatus == responseStatus2) &&\r\n        (reqStatus == \"Open\" || reqStatus == \"ReOpened\")\r\n      ) {\r\n        $(this).addClass(\"highlighted\");\r\n        count++;\r\n\r\n        if (resStatus == responseStatus1) resStatus1++;\r\n        else if (resStatus == responseStatus2) resStatus2++;\r\n\r\n        if (reqStatus == \"Open\") cntOpen++;\r\n        else if (reqStatus == \"ReOpened\") cntReOpened++;\r\n      }\r\n    });\r\n\r\n    if (count > 0) {\r\n      $(\"#lblStatusReportResponsesMsg\").html(\r\n        \"<span class='ui-icon ui-icon-alert'></span>There are \" +\r\n          count +\r\n          \" Responses pending your review\"\r\n      );\r\n\r\n      if (resStatus1 > 0 && resStatus2 == 0)\r\n        $(\"#ddlResponseStatus\").val(responseStatus1).change();\r\n      else if (resStatus2 > 0 && resStatus1 == 0)\r\n        $(\"#ddlResponseStatus\").val(responseStatus2).change();\r\n    } else\r\n      $(\"#lblStatusReportResponsesMsg\").html(\r\n        \"<span class='ui-icon ui-icon-circle-check'></span>There are 0 Responses pending your review\"\r\n      );\r\n  }\r\n\r\n  function m_fnLoadSiteGroups(itemColl) {\r\n    m_arrSiteGroups = new Array();\r\n\r\n    var listItemEnumerator = itemColl.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_id();\r\n      var loginName = oListItem.get_loginName();\r\n      var title = oListItem.get_title();\r\n\r\n      var groupObject = new Object();\r\n      groupObject[\"ID\"] = id;\r\n      groupObject[\"loginName\"] = loginName;\r\n      groupObject[\"title\"] = title;\r\n      groupObject[\"group\"] = oListItem;\r\n\r\n      m_arrSiteGroups.push(groupObject);\r\n    }\r\n  }\r\n\r\n  function m_fnGetSPSiteGroup(groupName) {\r\n    var userGroup = null;\r\n    if (m_arrSiteGroups != null) {\r\n      for (var x = 0; x < m_arrSiteGroups.length; x++) {\r\n        if (m_arrSiteGroups[x].title == groupName) {\r\n          userGroup = m_arrSiteGroups[x].group;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return userGroup;\r\n  }\r\n\r\n  function m_fnLoadActionOffices(itemColl) {\r\n    m_arrAOs = new Array();\r\n\r\n    var listItemEnumerator = itemColl.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var title = oListItem.get_item(\"Title\");\r\n      var userGroup = oListItem.get_item(\"UserGroup\");\r\n      if (userGroup != null) {\r\n        userGroup = userGroup.get_lookupValue();\r\n      } else userGroup = \"\";\r\n\r\n      var aoObject = new Object();\r\n      aoObject[\"ID\"] = id;\r\n      aoObject[\"title\"] = title;\r\n      aoObject[\"userGroup\"] = userGroup;\r\n\r\n      m_arrAOs.push(aoObject);\r\n    }\r\n  }\r\n\r\n  function m_fnGetAOSPGroupName(groupName) {\r\n    //finds the group name corresponding to the lookup field selected\r\n    var userGroup = null;\r\n    if (m_arrAOs != null) {\r\n      for (var x = 0; x < m_arrAOs.length; x++) {\r\n        var oGroup = m_arrAOs[x];\r\n        if (oGroup.title == groupName) {\r\n          userGroup = oGroup.userGroup;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return userGroup;\r\n  }\r\n\r\n  function m_fnCheckSPItemHasGroupPermission(item, groupName, permissionLevel) {\r\n    if (\r\n      item == null ||\r\n      groupName == \"\" ||\r\n      groupName == null ||\r\n      permissionLevel == null\r\n    )\r\n      return false;\r\n\r\n    var match = false;\r\n    var roleAssignments = item.get_roleAssignments();\r\n    if (roleAssignments == null) {\r\n      alert(\"Error retrieving role assignments\");\r\n      return false;\r\n    }\r\n\r\n    var rolesEnumerator = roleAssignments.getEnumerator();\r\n    while (rolesEnumerator.moveNext()) {\r\n      var role = rolesEnumerator.get_current();\r\n      if (role != null) {\r\n        var roleMember = role.get_member();\r\n        if (roleMember.isPropertyAvailable(\"Title\")) {\r\n          var memberTitleName = roleMember.get_title();\r\n\r\n          var roleDefs = role.get_roleDefinitionBindings();\r\n          if (roleDefs != null) {\r\n            var roleDefsEnumerator = roleDefs.getEnumerator();\r\n            while (roleDefsEnumerator.moveNext()) {\r\n              var rd = roleDefsEnumerator.get_current();\r\n              var rdName = rd.get_name();\r\n\r\n              if (\r\n                memberTitleName == groupName &&\r\n                rd.get_basePermissions().has(permissionLevel)\r\n              ) {\r\n                match = true;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return match;\r\n  }\r\n\r\n  function m_fnGoToResponse(responseTitle, isIA) {\r\n    if (!isIA) {\r\n      var bFound = false;\r\n      $(\"#ddlResponsesOpen > option\").each(function () {\r\n        if ($(this).text() == responseTitle) {\r\n          bFound = true;\r\n          notifyId = SP.UI.Notify.addNotification(\r\n            \"Displaying Response (\" + responseTitle + \")\",\r\n            false\r\n          );\r\n          $(\"#ddlResponsesOpen\").val(responseTitle).change();\r\n\r\n          return false;\r\n        }\r\n      });\r\n      if (!bFound) {\r\n        $(\"#ddlResponsesProcessed > option\").each(function () {\r\n          if ($(this).text() == responseTitle) {\r\n            bFound = true;\r\n            notifyId = SP.UI.Notify.addNotification(\r\n              \"Displaying Response (\" + responseTitle + \")\",\r\n              false\r\n            );\r\n            $(\"#ddlResponsesProcessed\").val(responseTitle).change();\r\n\r\n            return false;\r\n          }\r\n        });\r\n      }\r\n\r\n      $(\"#tabs\").tabs({ active: 1 });\r\n    }\r\n  }\r\n\r\n  function m_fnGetResponseDocStyleTag2(documentStatus) {\r\n    var styleTag = {};\r\n    if (documentStatus == \"Archived\")\r\n      styleTag = { \"background-color\": \"Gainsboro\" };\r\n    else if (documentStatus == \"Approved\")\r\n      styleTag = { \"background-color\": \"PaleGreen\" };\r\n    else if (documentStatus == \"Rejected\")\r\n      styleTag = { \"background-color\": \"LightSalmon\" };\r\n    else if (documentStatus == \"Sent to QA\")\r\n      styleTag = { \"background-color\": \"LightCyan\" };\r\n    else if (documentStatus == \"Submitted\")\r\n      styleTag = { \"background-color\": \"LemonChiffon\" };\r\n    else if (documentStatus == \"Marked for Deletion\")\r\n      styleTag = {\r\n        \"background-color\": \"Gainsboro\",\r\n        \"font-style\": \"italic\",\r\n      };\r\n    return styleTag;\r\n    //\t\t\tstyleTag = \" style='background-color:Gainsboro; font-style:italic' title='Marked for Deletion by the Action Office' \";\r\n  }\r\n\r\n  function m_fnGetResponseDocStyleTag(documentStatus) {\r\n    var styleTag = \"\";\r\n\r\n    if (documentStatus == \"Archived\")\r\n      styleTag = \" style='background-color:Gainsboro;' \";\r\n    else if (documentStatus == \"Approved\")\r\n      styleTag = \" style='background-color:PaleGreen;' \";\r\n    else if (documentStatus == \"Rejected\")\r\n      styleTag = \" style='background-color:LightSalmon;' \";\r\n    else if (documentStatus == \"Sent to QA\")\r\n      styleTag = \" style='background-color:LightCyan;' \";\r\n    else if (documentStatus == \"Submitted\")\r\n      styleTag = \" style='background-color:LemonChiffon;' \";\r\n    else if (documentStatus == \"Marked for Deletion\")\r\n      styleTag =\r\n        \" style='background-color:Gainsboro; font-style:italic' title='Marked for Deletion by the Action Office' \";\r\n\r\n    return styleTag;\r\n  }\r\n\r\n  function m_fnCheckIfEmailFolderExists(items, requestNumber) {\r\n    //Check if folder exists in email library\r\n    var bFolderExists = false;\r\n    var listItemEnumerator = items.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var folderItem = listItemEnumerator.get_current();\r\n      var itemName = folderItem.get_displayName();\r\n      if (itemName == requestNumber) {\r\n        var bFolderExists = true;\r\n        break;\r\n      }\r\n    }\r\n    return bFolderExists;\r\n  }\r\n\r\n  var m_cntAddToEmailFolder = 0;\r\n  var m_cntAddedToEmailFolder = 0;\r\n\r\n  function m_fnCreateEmailFolder(list, requestNumber, requestItem, OnComplete) {\r\n    m_cntAddToEmailFolder = 0;\r\n    m_cntAddedToEmailFolder = 0;\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var itemCreateInfo = new SP.ListItemCreationInformation();\r\n    itemCreateInfo.set_underlyingObjectType(SP.FileSystemObjectType.folder);\r\n    itemCreateInfo.set_leafName(requestNumber);\r\n    const oNewEmailFolder = list.addItem(itemCreateInfo);\r\n    oNewEmailFolder.set_item(\"Title\", requestNumber);\r\n    oNewEmailFolder.update();\r\n\r\n    const currentUser = web.get_currentUser();\r\n    const ownerGroup = web.get_associatedOwnerGroup();\r\n    const memberGroup = web.get_associatedMemberGroup();\r\n    const visitorGroup = web.get_associatedVisitorGroup();\r\n\r\n    oNewEmailFolder.resetRoleInheritance();\r\n    oNewEmailFolder.breakRoleInheritance(false, false);\r\n\r\n    var roleDefBindingCollAdmin =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollAdmin.add(\r\n      web.get_roleDefinitions().getByType(SP.RoleType.administrator)\r\n    );\r\n\r\n    var roleDefBindingCollContribute =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollContribute.add(\r\n      web.get_roleDefinitions().getByType(SP.RoleType.contributor)\r\n    );\r\n\r\n    var roleDefBindingCollRestrictedRead =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollRestrictedRead.add(\r\n      web.get_roleDefinitions().getByName(\"Restricted Read\")\r\n    );\r\n\r\n    var roleDefBindingCollRestrictedContribute =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollRestrictedContribute.add(\r\n      web.get_roleDefinitions().getByName(\"Restricted Contribute\")\r\n    );\r\n\r\n    //add associated site groups\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(ownerGroup, roleDefBindingCollAdmin);\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(memberGroup, roleDefBindingCollContribute);\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(visitorGroup, roleDefBindingCollRestrictedRead);\r\n\r\n    var spGroupQA = Audit.Common.Utilities.GetSPSiteGroup(\r\n      Audit.Common.Utilities.GetGroupNameQA()\r\n    );\r\n    if (spGroupQA != null)\r\n      oNewEmailFolder\r\n        .get_roleAssignments()\r\n        .add(spGroupQA, roleDefBindingCollRestrictedContribute);\r\n\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .getByPrincipal(currentUser)\r\n      .deleteObject();\r\n\r\n    //Need to break up adding AOs because it exceeds the resource limit (request uses too many resources)\r\n    function onUpdatePermsSucceeded() {\r\n      if (this.requestItem) {\r\n        //this will be null when sending from permissions page\r\n        //add action offices\r\n        var arrActionOffice = this.requestItem.get_item(\"ActionOffice\");\r\n        if (arrActionOffice == null || arrActionOffice.length == 0) {\r\n          if (this.OnComplete) this.OnComplete(true);\r\n          return;\r\n        }\r\n\r\n        for (var x = 0; x < arrActionOffice.length; x++) {\r\n          var actionOfficeName = arrActionOffice[x].get_lookupValue();\r\n\r\n          var actionOfficeGroupName =\r\n            Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n          var actionOfficeGroup = Audit.Common.Utilities.GetSPSiteGroup(\r\n            actionOfficeGroupName\r\n          );\r\n\r\n          if (actionOfficeGroup != null) {\r\n            m_cntAddToEmailFolder++;\r\n\r\n            var currCtx2 = new SP.ClientContext.get_current();\r\n            var web2 = currCtx2.get_web();\r\n\r\n            var roleDefBindingCollRestrictedContribute =\r\n              SP.RoleDefinitionBindingCollection.newObject(currCtx2);\r\n            roleDefBindingCollRestrictedContribute.add(\r\n              web2.get_roleDefinitions().getByName(\"Restricted Contribute\")\r\n            );\r\n\r\n            this.oNewEmailFolder\r\n              .get_roleAssignments()\r\n              .add(actionOfficeGroup, roleDefBindingCollRestrictedContribute);\r\n\r\n            function onUpdateAOPermsSucceeded() {\r\n              m_cntAddedToEmailFolder++;\r\n              if (m_cntAddedToEmailFolder == m_cntAddToEmailFolder) {\r\n                if (this.OnComplete) this.OnComplete(true);\r\n              }\r\n            }\r\n            function onUpdateAOPermsFailed(sender, args) {\r\n              m_cntAddedToEmailFolder++;\r\n              if (m_cntAddedToEmailFolder == m_cntAddToEmailFolder) {\r\n                if (this.OnComplete) this.OnComplete(true);\r\n              }\r\n            }\r\n            var data = { OnComplete: this.OnComplete };\r\n            currCtx2.executeQueryAsync(\r\n              Function.createDelegate(data, onUpdateAOPermsSucceeded),\r\n              Function.createDelegate(data, onUpdateAOPermsFailed)\r\n            );\r\n          }\r\n        }\r\n      } else {\r\n        if (this.OnComplete) this.OnComplete(true);\r\n      }\r\n    }\r\n\r\n    function onUpdatePermsFailed(sender, args) {\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n    }\r\n\r\n    var data = {\r\n      /*item: oListItem, */ requestItem: requestItem,\r\n      oNewEmailFolder: oNewEmailFolder,\r\n      OnComplete: OnComplete,\r\n    };\r\n    currCtx.executeQueryAsync(\r\n      Function.createDelegate(data, onUpdatePermsSucceeded),\r\n      Function.createDelegate(data, onUpdatePermsFailed)\r\n    );\r\n  }\r\n\r\n  function m_fnSortResponseTitleNoCase(a, b) {\r\n    var aTitle = a;\r\n    var bTitle = b;\r\n    let newA, newB;\r\n\r\n    if (aTitle == null) aTitle = \"\";\r\n    if (bTitle == null) bTitle = \"\";\r\n\r\n    var aIndex = aTitle.lastIndexOf(\"-\");\r\n    if (aIndex >= 0) {\r\n      var subA = aTitle.substring(0, aIndex + 1);\r\n      var lastA = aTitle.replace(subA, \"\");\r\n      var intA = parseInt(lastA, 10);\r\n      var newIntA = Audit.Common.Utilities.PadDigits(intA, 5);\r\n      newA = subA + newIntA;\r\n    } else newA = aTitle;\r\n\r\n    var bIndex = bTitle.lastIndexOf(\"-\");\r\n    if (bIndex >= 0) {\r\n      var subB = bTitle.substring(0, bIndex + 1);\r\n      var lastB = bTitle.replace(subB, \"\");\r\n      var intB = parseInt(lastB, 10);\r\n      var newIntB = Audit.Common.Utilities.PadDigits(intB, 5);\r\n      newB = subB + newIntB;\r\n    } else newB = bTitle;\r\n\r\n    return newA.toLowerCase().localeCompare(newB.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortResponseObjectNoCase(a, b) {\r\n    var aTitle = a.title;\r\n    var bTitle = b.title;\r\n    var newA;\r\n    var newB;\r\n    if (aTitle == null) aTitle = \"\";\r\n    if (bTitle == null) bTitle = \"\";\r\n\r\n    var aIndex = aTitle.lastIndexOf(\"-\");\r\n    if (aIndex >= 0) {\r\n      var subA = aTitle.substring(0, aIndex + 1);\r\n      var lastA = aTitle.replace(subA, \"\");\r\n      var intA = parseInt(lastA, 10);\r\n      var newIntA = Audit.Common.Utilities.PadDigits(intA, 5);\r\n      newA = subA + newIntA;\r\n    } else newA = aTitle;\r\n\r\n    var bIndex = bTitle.lastIndexOf(\"-\");\r\n    if (bIndex >= 0) {\r\n      var subB = bTitle.substring(0, bIndex + 1);\r\n      var lastB = bTitle.replace(subB, \"\");\r\n      var intB = parseInt(lastB, 10);\r\n      var newIntB = Audit.Common.Utilities.PadDigits(intB, 5);\r\n      newB = subB + newIntB;\r\n    } else newB = bTitle;\r\n\r\n    return newA.toLowerCase().localeCompare(newB.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortNoCase(a, b) {\r\n    return a.toLowerCase().localeCompare(b.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortDate(a, b) {\r\n    if (a == \"\") return -1;\r\n    if (b == \"\") return 1;\r\n    return new Date(a).getTime() - new Date(b).getTime();\r\n  }\r\n\r\n  //Adds the values in the arr array to the drop down with the specified id\r\n  function m_fnAddOptions(arr, ddlID, dateSort, responseSort) {\r\n    if (arr == null) return;\r\n    if (responseSort) arr.sort(m_fnSortResponseTitleNoCase);\r\n    else if (!dateSort) arr.sort(m_fnSortNoCase);\r\n    else arr.sort(m_fnSortDate);\r\n\r\n    var rOptions = new Array(),\r\n      j = -1;\r\n    rOptions[++j] = \"<option value=''>-Select-</option>\";\r\n\r\n    var arrLength = arr.length;\r\n\r\n    /*\tvar fragment = document.createDocumentFragment();\r\n\t\t\tvar choice = document.createElement('option');\r\n\t\t\tchoice.value = \"\";\r\n\t\t\tchoice.innerHTML = \"-Select-\";\r\n\t\t\tfragment.appendChild(choice);\r\n\t\t*/\r\n    for (var x = 0; x < arrLength; x++) {\r\n      var option = $.trim(arr[x]);\r\n\r\n      rOptions[++j] = \"<option value='\" + option + \"'>\" + option + \"</option>\";\r\n\r\n      /*\t\r\n\t\t\tvar choice = document.createElement('option');\r\n\t        choice.value = option;\r\n\t        choice.innerHTML = option;\r\n\t        fragment.appendChild(choice);*/\r\n    }\r\n\r\n    //ddlID = ddlID.replace(\"#\", \"\");\r\n    //document.getElementById(ddlID).innerHTML = rOptions.join('');\r\n\r\n    var thisDDL = $(ddlID);\r\n    thisDDL.empty().append(rOptions.join(\"\"));\r\n    /*var thisDDL = $(ddlID);\r\n\t\tthisDDL.empty().html( fragment );*/\r\n  }\r\n\r\n  function m_fnExistsInArr(arr, val) {\r\n    if (arr == null) return false;\r\n\r\n    var arrLength = arr.length;\r\n    for (var x = 0; x < arrLength; x++) {\r\n      if (arr[x] == val) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function m_fnGetTrueFalseIcon(val) {\r\n    if (val == true)\r\n      return \"<span class='ui-icon ui-icon-check'>\" + val + \"</span>\";\r\n    else return \"<span class='ui-icon ui-icon-close'>\" + val + \"</span>\";\r\n  }\r\n\r\n  function m_fnGetFriendlyDisplayName(oListItem, fieldName) {\r\n    var user = oListItem.get_item(fieldName);\r\n    if (user == null) return \"\";\r\n    else return user.get_lookupValue();\r\n  }\r\n\r\n  function m_fnPadDigits(n, totalDigits) {\r\n    n = n.toString();\r\n    var pd = \"\";\r\n    if (totalDigits > n.length) {\r\n      for (let i = 0; i < totalDigits - n.length; i++) {\r\n        pd += \"0\";\r\n      }\r\n    }\r\n    return pd + n.toString();\r\n  }\r\n\r\n  function m_fnPreciseRound(num, decimals) {\r\n    var sign = num >= 0 ? 1 : -1;\r\n    return (\r\n      Math.round(num * Math.pow(10, decimals) + sign * 0.001) /\r\n      Math.pow(10, decimals)\r\n    ).toFixed(decimals);\r\n  }\r\n\r\n  function m_fnGetFriendlyFileSize(fileSize) {\r\n    if (fileSize == null || fileSize == \"\") return \"\";\r\n\r\n    if (fileSize > 1048576) {\r\n      fileSize =\r\n        Audit.Common.Utilities.PreciseRound(fileSize / 1048576, 2) + \" MB\";\r\n    } else if (fileSize > 1024) {\r\n      fileSize =\r\n        Audit.Common.Utilities.PreciseRound(fileSize / 1024, 2) + \" KB\";\r\n    } else {\r\n      fileSize += \" B\";\r\n    }\r\n    return fileSize;\r\n  }\r\n\r\n  function m_fnISODateString(d) {\r\n    function pad(n) {\r\n      return n < 10 ? \"0\" + n : n;\r\n    }\r\n\r\n    return (\r\n      d.getUTCFullYear() +\r\n      \"-\" +\r\n      pad(d.getUTCMonth() + 1) +\r\n      \"-\" +\r\n      pad(d.getUTCDate()) +\r\n      \"T\" +\r\n      pad(d.getUTCHours()) +\r\n      \":\" +\r\n      pad(d.getUTCMinutes()) +\r\n      \":\" +\r\n      pad(d.getUTCSeconds()) +\r\n      \"Z\"\r\n    );\r\n  }\r\n\r\n  function m_fnBindHandlerResponseDoc() {\r\n    $(\".requestInfo-response-doc img\").click(function (event) {\r\n      event.preventDefault();\r\n      var curIcon = $(this).attr(\"src\");\r\n      if (curIcon == \"/_layouts/images/minus.gif\")\r\n        $(this).attr(\"src\", \"/_layouts/images/plus.gif\");\r\n      else $(this).attr(\"src\", \"/_layouts/images/minus.gif\");\r\n\r\n      //$(this).nextUntil('tr.Grouping').slideToggle(200);\r\n      $(this)\r\n        .parent()\r\n        .parent()\r\n        .nextUntil(\"tr.requestInfo-response-doc\")\r\n        .each(function () {\r\n          $(this).toggleClass(\"collapsed\");\r\n        });\r\n    });\r\n  }\r\n\r\n  /************\r\n\tNotice - for some reason, when the list item opens in a dialog or not in the dialog, it renders differently causing the values to get back data differently\r\n\t********/\r\n  /*\r\n\tfunction m_fnGetLookupFieldText( fieldName )\r\n\t{\r\n\t\tvar field = $( \"select[title='\" + fieldName  + \"']\" );\r\n\t\t\r\n\t\tif( field == null || field.html() == null ) //more than 20 items in the lookup\r\n\t\t{\r\n\t\t\tfield = $( \"input[title='\" + fieldName  + \"']\" );\r\n\t\t\treturn field.val();\r\n\t\t}\r\n\t\telse return $(\"select[title='\" + fieldName  + \"'] option:selected\").text();\r\n\t}\r\n\r\n\t*/\r\n\r\n  function m_fnGetLookupFormField(fieldTitle) {\r\n    if ($(\"select[title='\" + fieldTitle + \"']\").html() !== null) {\r\n      return $(\"select[title='\" + fieldTitle + \"']\");\r\n    } else {\r\n      return $(\"input[title='\" + fieldTitle + \"']\");\r\n    }\r\n  }\r\n\r\n  function m_fnGetLookupDisplayText(fieldTitle) {\r\n    //Set default value for lookups with less that 20 items\r\n    if ($(\"select[title='\" + fieldTitle + \"']\").html() !== null) {\r\n      return $(\"select[title='\" + fieldTitle + \"'] option:selected\").text();\r\n    } else {\r\n      return $(\"input[title='\" + fieldTitle + \"']\").val();\r\n    }\r\n  }\r\n\r\n  function m_fnSetLookupFromFieldNameByText(fieldName, text) {\r\n    try {\r\n      if (text == undefined) return;\r\n      var theSelect = m_fnGetTagFromIdentifierAndTitle(\"select\", \"\", fieldName);\r\n\r\n      if (theSelect == null) {\r\n        var theInput = m_fnGetTagFromIdentifierAndTitle(\"input\", \"\", fieldName);\r\n        //builtin\r\n        ShowDropdown(theInput.id);\r\n        var opt = document.getElementById(theInput.opt);\r\n        m_fnSetSelectedOptionByText(opt, text);\r\n        //builtin\r\n        OptLoseFocus(opt);\r\n      } else {\r\n        m_fnSetSelectedOptionByText(theSelect, text);\r\n      }\r\n    } catch (ex) {}\r\n  }\r\n\r\n  function m_fnSetSelectedOptionByText(select, text) {\r\n    var opts = select.options;\r\n    var optLength = opts.length;\r\n    if (select == null) return;\r\n\r\n    for (var i = 0; i < optLength; i++) {\r\n      if (opts[i].text == text) {\r\n        select.selectedIndex = i;\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function m_fnGetTagFromIdentifierAndTitle(tagName, identifier, title) {\r\n    var idLength = identifier.length;\r\n    var tags = document.getElementsByTagName(tagName);\r\n    for (var i = 0; i < tags.length; i++) {\r\n      var tagID = tags[i].id;\r\n      if (\r\n        tags[i].title == title &&\r\n        (identifier == \"\" ||\r\n          tagID.indexOf(identifier) == tagID.length - idLength)\r\n      ) {\r\n        return tags[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function m_fnViewUserManuals(docType) {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"User Manual\";\r\n    options.height = 250;\r\n    //options.dialogReturnValueCallback = OnCallbackForm;\r\n    if (docType != null)\r\n      options.url =\r\n        Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/SitePages/AuditUserManuals.aspx?FilterField1=DocType&FilterValue1=\" +\r\n        docType;\r\n    else\r\n      options.url =\r\n        Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/SitePages/AuditUserManuals.aspx\";\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnPrintPage(pageTitle, divTbl) {\r\n    var curDate = new Date();\r\n    var siteUrl = Audit.Common.Utilities.GetSiteUrl();\r\n    var cssLink1 =\r\n      siteUrl +\r\n      \"/siteassets/css/tablesorter/style.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink2 =\r\n      siteUrl +\r\n      \"/siteAssets/css/audit_styles.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n\r\n    var divOutput = $(divTbl).html();\r\n\r\n    //remove hyperlinks pointing to the job codes\r\n    var updatedDivOutput = $(\"<div>\").append(divOutput);\r\n    updatedDivOutput.find(\".sr-response-title a\").each(function () {\r\n      $(this).removeAttr(\"onclick\");\r\n      $(this).removeAttr(\"href\");\r\n    });\r\n\r\n    divOutput = updatedDivOutput.html();\r\n\r\n    var printDateString = curDate.format(\"MM/dd/yyyy hh:mm tt\");\r\n    printDateString =\r\n      \"<div style='padding-bottom:10px;'>\" + printDateString + \"</div>\";\r\n    divOutput = printDateString + divOutput;\r\n\r\n    var cssFile1 = $(\"<div></div>\");\r\n    var cssFile2 = $(\"<div></div>\");\r\n\r\n    var def1 = $.Deferred();\r\n    var def2 = $.Deferred();\r\n\r\n    var cssFileText = \"\";\r\n    cssFile1.load(cssLink1, function () {\r\n      cssFileText += \"<style>\" + cssFile1.html() + \"</style>\";\r\n      def1.resolve();\r\n    });\r\n    cssFile2.load(cssLink2, function () {\r\n      cssFileText += \"<style>\" + cssFile2.html() + \"</style>\";\r\n      def2.resolve();\r\n    });\r\n\r\n    //gets called asynchronously after the css files have been loaded\r\n    $.when(def1, def2).done(function () {\r\n      var html =\r\n        \"<HTML>\\n\" +\r\n        \"<HEAD>\\n\\n\" +\r\n        \"<Title>\" +\r\n        pageTitle +\r\n        \"</Title>\\n\" +\r\n        cssFileText +\r\n        \"\\n\" +\r\n        \"<style>\" +\r\n        \".hideOnPrint, .rowFilters {display:none}\" +\r\n        \"</style>\\n\" +\r\n        \"</HEAD>\\n\" +\r\n        \"<BODY>\\n\" +\r\n        divOutput +\r\n        \"\\n\" +\r\n        \"</BODY>\\n\" +\r\n        \"</HTML>\";\r\n\r\n      var printWP = window.open(\"\", \"printWebPart\");\r\n      printWP.document.open();\r\n      //insert content\r\n      printWP.document.write(html);\r\n\r\n      printWP.document.close();\r\n      //open print dialog\r\n      printWP.print();\r\n    });\r\n  }\r\n\r\n  //make sure iframe with id csvexprframe is added to page up top\r\n  //http://stackoverflow.com/questions/18185660/javascript-jquery-exporting-data-in-csv-not-working-in-ie\r\n  function m_fnExportToCsv(fileName, tableName, removeHeader) {\r\n    var data = m_fnGetCellValues(tableName);\r\n\r\n    if (removeHeader == true) data = data.slice(1);\r\n\r\n    var csv = m_fnConvertToCsv(data);\r\n    //\tconsole.log( csv );\r\n    if (navigator.userAgent.search(\"Trident\") >= 0) {\r\n      window.CsvExpFrame.document.open(\"text/html\", \"replace\");\r\n      //\t\twindow.CsvExpFrame.document.open(\"application/csv\", \"replace\");\r\n      //\t\twindow.CsvExpFrame.document.charset = \"utf-8\";\r\n      //\t\twindow.CsvExpFrame.document.open(\"application/ms-excel\", \"replace\");\r\n      window.CsvExpFrame.document.write(csv);\r\n      window.CsvExpFrame.document.close();\r\n      window.CsvExpFrame.focus();\r\n      window.CsvExpFrame.document.execCommand(\r\n        \"SaveAs\",\r\n        true,\r\n        fileName + \".csv\"\r\n      );\r\n    } else {\r\n      var uri = \"data:text/csv;charset=utf-8,\" + escape(csv);\r\n      var downloadLink = document.createElement(\"a\");\r\n      downloadLink.href = uri;\r\n      downloadLink.download = fileName + \".csv\";\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n    }\r\n  }\r\n\r\n  function m_fnGetCellValues(tableName) {\r\n    var table = document.getElementById(tableName);\r\n\r\n    //remove headers and footers\r\n    if (table.innerHTML.indexOf(\"rowFilters\") >= 0) {\r\n      var deets = $(\"<div>\").append(table.outerHTML);\r\n      deets.find(\".rowFilters\").each(function () {\r\n        $(this).remove();\r\n      });\r\n      table = deets.find(\"table\")[0];\r\n    }\r\n    if (table.innerHTML.indexOf(\"footer\") >= 0) {\r\n      var deets = $(\"<div>\").append(table.outerHTML);\r\n      deets.find(\".footer\").each(function () {\r\n        $(this).remove();\r\n      });\r\n      table = deets.find(\"table\")[0];\r\n    }\r\n\r\n    var tableArray = [];\r\n    for (var r = 0, n = table.rows.length; r < n; r++) {\r\n      tableArray[r] = [];\r\n      for (var c = 0, m = table.rows[r].cells.length; c < m; c++) {\r\n        var text =\r\n          table.rows[r].cells[c].textContent ||\r\n          table.rows[r].cells[c].innerText;\r\n        tableArray[r][c] = text.trim();\r\n      }\r\n    }\r\n    return tableArray;\r\n  }\r\n\r\n  function m_fnConvertToCsv(objArray) {\r\n    var array = typeof objArray != \"object\" ? JSON.parse(objArray) : objArray;\r\n    var str = \"sep=,\\r\\n\";\r\n    var line = \"\";\r\n    var index;\r\n    var value;\r\n    for (var i = 0; i < array.length; i++) {\r\n      line = \"\";\r\n      var array1 = array[i];\r\n      for (index in array1) {\r\n        if (array1.hasOwnProperty(index)) {\r\n          value = array1[index] + \"\";\r\n          line += '\"' + value.replace(/\"/g, '\"\"') + '\",';\r\n        }\r\n      }\r\n      line = line.slice(0, -1);\r\n      str += line + \"\\r\\n\";\r\n    }\r\n    return str;\r\n  }\r\n\r\n  var publicMembers = {\r\n    GetSiteUrl: function () {\r\n      if (m_siteUrl == \"/\") return \"\";\r\n      else return m_siteUrl;\r\n    },\r\n    GetListTitleRequests: function () {\r\n      return m_listTitleRequests;\r\n    },\r\n    GetListNameRequests: function () {\r\n      return m_listNameRequests;\r\n    },\r\n    GetListTitleRequestsInternal: function () {\r\n      return m_listTitleRequestsInternal;\r\n    },\r\n    GetListNameRequestsInternal: function () {\r\n      return m_listNameRequestsInternal;\r\n    },\r\n    GetListTitleResponses: function () {\r\n      return m_listTitleResponses;\r\n    },\r\n    GetListNameResponses: function () {\r\n      return m_listNameResponses;\r\n    },\r\n    GetLibTitleRequestDocs: function () {\r\n      return m_libTitleRequestDocs;\r\n    },\r\n    GetLibNameRequestDocs: function () {\r\n      return m_libNameRequestDocs;\r\n    },\r\n    GetLibTitleCoverSheets: function () {\r\n      return m_libTitleCoverSheet;\r\n    },\r\n    GetLibNameCoverSheets: function () {\r\n      return m_libNameCoverSheet;\r\n    },\r\n    GetLibTitleResponseDocs: function () {\r\n      return m_libTitleResponseDocs;\r\n    },\r\n    GetLibNameResponseDocs: function () {\r\n      return m_libNameResponseDocs;\r\n    },\r\n    GetLibTitleResponseDocsEA: function () {\r\n      return m_libTitleResponseDocsEA;\r\n    },\r\n    GetLibNameResponseDocsEA: function () {\r\n      return m_libNameResponseDocsEA;\r\n    },\r\n    GetListTitleActionOffices: function () {\r\n      return m_listTitleActionOffices;\r\n    },\r\n    GetListNameActionOffices: function () {\r\n      return m_listNameActionOffices;\r\n    },\r\n    GetListTitleEmailHistory: function () {\r\n      return m_listTitleEmailHistory;\r\n    },\r\n    GetListNameEmailHistory: function () {\r\n      return m_listNameEmailHistory;\r\n    },\r\n    GetListTitleBulkResponses: function () {\r\n      return m_listTitleBulkResponses;\r\n    },\r\n    GetListNameBulkResponses: function () {\r\n      return m_listNameBulkResponses;\r\n    },\r\n    GetListTitleBulkPermissions: function () {\r\n      return m_listTitleBulkPermissions;\r\n    },\r\n    GetListNameBulkPermissions: function () {\r\n      return m_listNameBulkPermissions;\r\n    },\r\n    GetGroupNameSpecialPerm1: function () {\r\n      return m_groupNameSpecialPermName1;\r\n    },\r\n    GetGroupNameSpecialPerm2: function () {\r\n      return m_groupNameSpecialPermName2;\r\n    },\r\n    GetGroupNameQA: function () {\r\n      return m_groupNameQA;\r\n    },\r\n    GetGroupNameEA: function () {\r\n      return m_groupNameEA;\r\n    },\r\n    Refresh: m_fnRefresh,\r\n    OnLoadDisplayTimeStamp: m_fnOnLoadDisplayTimeStamp,\r\n    OnLoadDisplayTabAndResponse: m_fnOnLoadDisplayTabAndResponse,\r\n    OnLoadFilterResponses: function (responseStatus1, responseStatus2) {\r\n      m_fnOnLoadFilterResponses(responseStatus1, responseStatus2);\r\n    },\r\n    SetResponseDocLibGUID: function (libGUID) {\r\n      m_libResponseDocsLibraryGUID = libGUID;\r\n    },\r\n    GetResponseDocLibGUID: function () {\r\n      return m_libResponseDocsLibraryGUID;\r\n    },\r\n    LoadSiteGroups: function (itemColl) {\r\n      m_fnLoadSiteGroups(itemColl);\r\n    },\r\n    GetSPSiteGroup: function (groupName) {\r\n      return m_fnGetSPSiteGroup(groupName);\r\n    },\r\n    LoadActionOffices: function (itemColl) {\r\n      m_fnLoadActionOffices(itemColl);\r\n    },\r\n    GetActionOffices: function () {\r\n      return m_arrAOs;\r\n    },\r\n    GetAOSPGroupName: function (groupName) {\r\n      return m_fnGetAOSPGroupName(groupName);\r\n    },\r\n    CheckSPItemHasGroupPermission: function (item, groupName, permissionLevel) {\r\n      return m_fnCheckSPItemHasGroupPermission(\r\n        item,\r\n        groupName,\r\n        permissionLevel\r\n      );\r\n    },\r\n    GoToResponse: function (responseTitle, isIA) {\r\n      m_fnGoToResponse(responseTitle, isIA);\r\n    },\r\n    GetResponseDocStyleTag: function (documentStatus) {\r\n      return m_fnGetResponseDocStyleTag(documentStatus);\r\n    },\r\n    GetResponseDocStyleTag2: function (documentStatus) {\r\n      return m_fnGetResponseDocStyleTag2(documentStatus);\r\n    },\r\n    CheckIfEmailFolderExists: function (items, requestNumber) {\r\n      return m_fnCheckIfEmailFolderExists(items, requestNumber);\r\n    },\r\n    CreateEmailFolder: function (list, requestNumber, requestItem, OnComplete) {\r\n      return m_fnCreateEmailFolder(\r\n        list,\r\n        requestNumber,\r\n        requestItem,\r\n        OnComplete\r\n      );\r\n    },\r\n    AddOptions: function (arr, ddlID, dateSort, responseSort) {\r\n      m_fnAddOptions(arr, ddlID, dateSort, responseSort);\r\n    },\r\n    ExistsInArr: function (arr, val) {\r\n      return m_fnExistsInArr(arr, val);\r\n    },\r\n    GetTrueFalseIcon: function (val) {\r\n      return m_fnGetTrueFalseIcon(val);\r\n    },\r\n    PadDigits: function (n, totalDigits) {\r\n      return m_fnPadDigits(n, totalDigits);\r\n    },\r\n    PreciseRound: function (num, decimals) {\r\n      return m_fnPreciseRound(num, decimals);\r\n    },\r\n    GetFriendlyFileSize: function (fileSize) {\r\n      return m_fnGetFriendlyFileSize(fileSize);\r\n    },\r\n    GetISODateString: function (d) {\r\n      return m_fnISODateString(d);\r\n    },\r\n    GetFriendlyDisplayName: function (oListItem, fieldName) {\r\n      return m_fnGetFriendlyDisplayName(oListItem, fieldName);\r\n    },\r\n    BindHandlerResponseDoc: m_fnBindHandlerResponseDoc,\r\n    PrintStatusReport: function (pageTitle, divTbl) {\r\n      m_fnPrintPage(pageTitle, divTbl);\r\n    },\r\n    ExportToCsv: function (fileName, tableName, removeHeader) {\r\n      m_fnExportToCsv(fileName, tableName, removeHeader);\r\n    },\r\n    ViewUserManuals: function (docType) {\r\n      m_fnViewUserManuals(docType);\r\n    },\r\n    //GetLookupFieldText: function( fieldName ){ return m_fnGetLookupFieldText( fieldName); },\r\n    GetLookupDisplayText: function (fieldName) {\r\n      return m_fnGetLookupDisplayText(fieldName);\r\n    },\r\n    GetLookupFormField: function (fieldName) {\r\n      return m_fnGetLookupFormField(fieldName);\r\n    },\r\n    SetLookupFromFieldNameByText: function (fieldName, text) {\r\n      return m_fnSetLookupFromFieldNameByText(fieldName, text);\r\n    },\r\n    SortResponseObjects: function (a, b) {\r\n      return m_fnSortResponseObjectNoCase(a, b);\r\n    },\r\n    SortResponseTitles: m_fnSortResponseTitleNoCase,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n\r\n// ExecuteOrDelayUntilScriptLoaded(InitReport, \"sp.js\");\r\nInitReport();\r\n", "\uFEFFimport { permissionsTemplate } from \"./Permissions_Template.js\";\r\nimport \"../../common/utilities.js\";\r\n\r\nwindow.Audit = window.Audit || {};\r\nAudit.Permissions = Audit.Permissions || {};\r\n\r\ndocument.getElementById(\"app\").innerHTML = permissionsTemplate;\r\n\r\nif (document.readyState === \"ready\" || document.readyState === \"complete\") {\r\n  InitPermissions();\r\n} else {\r\n  document.onreadystatechange = () => {\r\n    if (document.readyState === \"complete\" || document.readyState === \"ready\") {\r\n      ExecuteOrDelayUntilScriptLoaded(function () {\r\n        SP.SOD.executeFunc(\"sp.js\", \"SP.ClientContext\", InitPermissions);\r\n      }, \"sp.js\");\r\n    }\r\n  };\r\n}\r\n\r\nfunction InitPermissions() {\r\n  Audit.Permissions.Report = new Audit.Permissions.Load();\r\n  Audit.Permissions.Init();\r\n}\r\n\r\nAudit.Permissions.Init = function () {};\r\n\r\nAudit.Permissions.Load = function () {\r\n  //var m_siteUrl = _spPageContextInfo.webServerRelativeUrl; //IE11 in sp 2013 does not recognize L_Menu_BaseUrl\r\n  var m_arrRequests = new Array();\r\n  var m_arrResponses = new Array();\r\n  var m_arrResponseFolders = new Array();\r\n\r\n  var m_arrGroups = null;\r\n  var m_collGroup = null;\r\n  var m_ownerGroupName = null;\r\n  var m_memberGroupName = null;\r\n  var m_visitorGroupName = null;\r\n\r\n  var notifyId;\r\n  var m_waitDialog;\r\n  var m_txtOutgoingEmailText = null;\r\n\r\n  var m_emailFolderName = \"AOVerifications\";\r\n\r\n  var m_oAOGroupUsers = new Object();\r\n\r\n  LoadInfo();\r\n\r\n  function LoadInfo() {\r\n    //$(\"#divTblOutput\").html(\"\");\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    /*\tvar requestList = web.get_lists().getByTitle( Audit.Common.Utilities.GetListTitleRequests() );\r\n\t\tvar requestQuery = new SP.CamlQuery();\t\r\n\t\trequestQuery.set_viewXml('<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>');\r\n\t\tm_requestItems = requestList.getItems( requestQuery );\r\n\t\t//request status has internal name as response status in the request list\r\n\t\tcurrCtx.load( m_requestItems, 'Include(ID, Title, ReqStatus, IsSample, ActionOffice, Modified, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))');\r\n\t    \r\n\t\tvar responseList = web.get_lists().getByTitle( Audit.Common.Utilities.GetListTitleResponses() );\r\n\t\tvar responseQuery = new SP.CamlQuery();\t\r\n\t\tresponseQuery.set_viewXml('<View Scope=\"RecursiveAll\"><Query><OrderBy><FieldRef Name=\"ReqNum\"/></OrderBy></Query></View>');\r\n\t\tm_responseItems = responseList.getItems( responseQuery );\r\n\t\tcurrCtx.load( m_responseItems, 'Include(ID, Title, ReqNum, ActionOffice, SampleNumber, ResStatus, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))' );\r\n\r\n\t\tvar responseDocsLibFolderslist = web.get_lists().getByTitle( Audit.Common.Utilities.GetLibTitleResponseDocs() );\r\n\t\tvar responseDocsLibFolderslistQuery = new SP.CamlQuery();\r\n\t    responseDocsLibFolderslistQuery.set_viewXml('<View><Query><OrderBy><FieldRef Name=\"Name\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\" /><Value Type=\"Lookup\">1</Value></Eq></Where></Query></View>');\r\n\t\tresponseDocsLibFolderslistQuery.set_folderServerRelativeUrl( Audit.Common.Utilities.GetSiteUrl() + \"/\" + Audit.Common.Utilities.GetLibNameResponseDocs() );\r\n\t\tm_ResponseDocsFoldersItems = responseDocsLibFolderslist.getItems(responseDocsLibFolderslistQuery);\r\n\t\tcurrCtx.load( m_ResponseDocsFoldersItems, \"Include( DisplayName, Id, ContentType, EncodedAbsUrl, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))\");\r\n\t*/\r\n    var aoList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleActionOffices());\r\n    var aoQuery = new SP.CamlQuery();\r\n    aoQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>'\r\n    );\r\n    var m_aoItems = aoList.getItems(aoQuery);\r\n    currCtx.load(m_aoItems, \"Include(ID, Title, UserGroup)\");\r\n\r\n    var ownerGroup = web.get_associatedOwnerGroup();\r\n    var memberGroup = web.get_associatedMemberGroup();\r\n    var visitorGroup = web.get_associatedVisitorGroup();\r\n    currCtx.load(ownerGroup);\r\n    currCtx.load(memberGroup);\r\n    currCtx.load(visitorGroup);\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n    function OnSuccess(sender, args) {\r\n      Audit.Common.Utilities.LoadActionOffices(m_aoItems);\r\n\r\n      m_ownerGroupName = ownerGroup.get_title();\r\n      m_memberGroupName = memberGroup.get_title();\r\n      m_visitorGroupName = visitorGroup.get_title();\r\n\r\n      /*\tm_fnLoadRequestPermissions();\r\n\t\t\tm_fnLoadResponsePermissions();\r\n\t\t\tm_fnLoadResponseFolderPermissions();\r\n\t\t\t\r\n\t\t\tLoadDDOptions();\r\n\t\t*/\r\n      $(\"#tabs\").tabs().show();\r\n\r\n      m_fnBindHandlersOnLoad();\r\n\r\n      Audit.Common.Utilities.OnLoadDisplayTimeStamp();\r\n      m_fnOnLoadDisplayTab();\r\n\r\n      var isModalDlg = GetUrlKeyValue(\"IsDlg\");\r\n      if (isModalDlg == null || isModalDlg == \"\" || isModalDlg == false) {\r\n        $(\"#btnRefresh\").show();\r\n      }\r\n\r\n      var doneLoadingSPGroupPermissions = false;\r\n      m_fnLoadSPGroupPermissions(function (doneLoadingSPGroupPermissions) {\r\n        if (doneLoadingSPGroupPermissions) {\r\n          m_fnDisplaySPGroupPermissions();\r\n          m_fnDisplaySPGroupPermissions2();\r\n        }\r\n      });\r\n    }\r\n    function OnFailure(sender, args) {\r\n      $(\"#divLoading\").hide();\r\n\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n      SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n    }\r\n  }\r\n\r\n  function m_fnRefresh() {\r\n    var curPath = location.pathname;\r\n\r\n    var tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n    curPath += \"?Tab=\" + tabIndex;\r\n\r\n    location.href = curPath;\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTab() {\r\n    var paramTabIndex = GetUrlKeyValue(\"Tab\");\r\n    if (paramTabIndex != null && paramTabIndex != \"\") {\r\n      $(\"#tabs\").tabs(\"option\", \"active\", paramTabIndex);\r\n    }\r\n  }\r\n\r\n  function m_fnLoadRequestPermissions() {\r\n    m_arrRequests = new Array();\r\n\r\n    var currCtx = SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    this.ownerGroup = web.get_associatedOwnerGroup();\r\n    this.memberGroup = web.get_associatedMemberGroup();\r\n    this.visitorGroup = web.get_associatedVisitorGroup();\r\n\r\n    var listItemEnumerator = m_requestItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var number = oListItem.get_item(\"Title\");\r\n      var status = oListItem.get_item(\"ReqStatus\");\r\n\r\n      var sample = oListItem.get_item(\"IsSample\");\r\n      var arrActionOffice = oListItem.get_item(\"ActionOffice\");\r\n      var actionOffice = \"\";\r\n      for (var x = 0; x < arrActionOffice.length; x++) {\r\n        actionOffice +=\r\n          \"<div>\" + arrActionOffice[x].get_lookupValue() + \"</div>\";\r\n      }\r\n\r\n      var requestObject = new Object();\r\n      requestObject[\"ID\"] = id;\r\n      requestObject[\"number\"] = number;\r\n      requestObject[\"status\"] = status;\r\n      requestObject[\"sample\"] = sample;\r\n      requestObject[\"responses\"] = new Array();\r\n      requestObject[\"actionOffice\"] = actionOffice;\r\n      requestObject[\"item\"] = oListItem;\r\n\r\n      m_fnLoadPermsOnItem(requestObject, oListItem);\r\n\r\n      m_arrRequests.push(requestObject);\r\n    }\r\n\r\n    var arrRequestIDs = new Array();\r\n    var errorCount = 0;\r\n    var sTablePermissionsBody = \"\";\r\n\r\n    var r = new Array(),\r\n      j = -1;\r\n\r\n    var reqLength = m_arrRequests.length;\r\n    for (var x = 0; x < reqLength; x++) {\r\n      var oRequest = m_arrRequests[x];\r\n\r\n      var number = oRequest.number;\r\n      arrRequestIDs.push(number);\r\n      var status = oRequest.status;\r\n      var actionOffices = oRequest.actionOffice;\r\n      var permsDisplay = oRequest.permissionsDisplay;\r\n      var hasSecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oRequest.hasSpecialPermissions\r\n      );\r\n\r\n      var flagItem = false;\r\n      var errToolTip = \"\";\r\n\r\n      for (var y = 0; y < oRequest.item.get_item(\"ActionOffice\").length; y++) {\r\n        var actionOfficeName = oRequest.item\r\n          .get_item(\"ActionOffice\")\r\n          [y].get_lookupValue();\r\n        var groupNameActionOffice =\r\n          Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n\r\n        var bFoundPermission = false;\r\n        for (var z = 0; z < oRequest.arrUserPermissions.length; z++)\r\n          if (oRequest.arrUserPermissions[z].name == groupNameActionOffice)\r\n            bFoundPermission = true;\r\n        for (var z = 0; z < oRequest.arrGroupPermissions.length; z++)\r\n          if (oRequest.arrGroupPermissions[z].name == groupNameActionOffice)\r\n            bFoundPermission = true;\r\n\r\n        if (!bFoundPermission) {\r\n          errToolTip =\r\n            ' title=\"Missing Action Office in this set of Permissions\" ';\r\n          flagItem = true;\r\n        }\r\n      }\r\n\r\n      if (!flagItem) {\r\n        //check if groups/users found in the permissions that are not part of the AOs\r\n        var bError = false;\r\n        for (var z = 0; z < oRequest.arrUserPermissions.length; z++) {\r\n          var bFound = false;\r\n          var name = oRequest.arrUserPermissions[z].name;\r\n          for (\r\n            var y = 0;\r\n            y < oRequest.item.get_item(\"ActionOffice\").length;\r\n            y++\r\n          ) {\r\n            var actionOfficeName = oRequest.item\r\n              .get_item(\"ActionOffice\")\r\n              [y].get_lookupValue();\r\n            var groupNameActionOffice =\r\n              Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n            if (name == groupNameActionOffice) {\r\n              bFound = true;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            if (\r\n              name == m_ownerGroupName ||\r\n              name == m_memberGroupName ||\r\n              name == m_visitorGroupName ||\r\n              name == Audit.Common.Utilities.GetGroupNameQA() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm1() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm2()\r\n            ) {\r\n              bFound = true;\r\n            } else {\r\n              bFound = false;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            bError = true;\r\n            break;\r\n          }\r\n        }\r\n        for (var z = 0; z < oRequest.arrGroupPermissions.length; z++) {\r\n          var bFound = false;\r\n          var name = oRequest.arrGroupPermissions[z].name;\r\n          for (\r\n            var y = 0;\r\n            y < oRequest.item.get_item(\"ActionOffice\").length;\r\n            y++\r\n          ) {\r\n            var actionOfficeName = oRequest.item\r\n              .get_item(\"ActionOffice\")\r\n              [y].get_lookupValue();\r\n            var groupNameActionOffice =\r\n              Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n            if (name == groupNameActionOffice) {\r\n              bFound = true;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            if (\r\n              name == m_ownerGroupName ||\r\n              name == m_memberGroupName ||\r\n              name == m_visitorGroupName ||\r\n              name == Audit.Common.Utilities.GetGroupNameQA() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm1() ||\r\n              name == Audit.Common.Utilities.GetGroupNameSpecialPerm2()\r\n            ) {\r\n              bFound = true;\r\n            } else {\r\n              bFound = false;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            bError = true;\r\n            break;\r\n          }\r\n        }\r\n\r\n        if (bError) {\r\n          errToolTip =\r\n            ' title=\"User or Group found in this set of Permissions that does not belong\" ';\r\n          flagItem = true;\r\n        }\r\n      }\r\n\r\n      //if( oRequest.hasSpecialPermissions && ( status != \"4-Approved for QA\" && status != \"7-Closed\" ) )// this should never be the case\r\n      //\tflagItem = true;\r\n\r\n      var styleTag = \"\";\r\n      if (flagItem) {\r\n        styleTag = ' style=\"background-color:lightsalmon\" ' + errToolTip;\r\n        errorCount++;\r\n      }\r\n\r\n      var link =\r\n        '<a href=\"javascript:void(0);\" onclick=\\'Audit.Permissions.Report.GoToRequest(\"' +\r\n        oRequest.number +\r\n        \"\\\")'>\" +\r\n        oRequest.number +\r\n        \"</a>\";\r\n\r\n      /*sTablePermissionsBody += '<tr class=\"request-perm-item\" ' + styleTag + '>' + \r\n\t\t\t\t'<td class=\"request-perm-item-number\" title=\"Request number\">' + link + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-status\" title=\"Request status\">' + status + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-actionOffices\" title=\"Request action offices\">' + actionOffices + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-specialPerms\" title=\"Request special permissions?\">' + hasSecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"request-perm-item-perms\" title=\"Request permissions\">' + permsDisplay + '</td>' +\r\n\t\t\t'</tr>';*/\r\n\r\n      r[++j] = '<tr class=\"request-perm-item\" ';\r\n      r[++j] = styleTag;\r\n      r[++j] = \">\";\r\n      r[++j] = '<td class=\"request-perm-item-number\" title=\"Request number\">';\r\n      r[++j] = link;\r\n      r[++j] = \"</td>\";\r\n      r[++j] = '<td class=\"request-perm-item-status\" title=\"Request status\">';\r\n      r[++j] = status;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"request-perm-item-actionOffices\" title=\"Request action offices\">';\r\n      r[++j] = actionOffices;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"request-perm-item-specialPerms\" title=\"Request special permissions?\">';\r\n      r[++j] = hasSecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"request-perm-item-perms\" title=\"Request permissions\">';\r\n      r[++j] = permsDisplay;\r\n      r[++j] = \"</td>\";\r\n      r[++j] = \"</tr>\";\r\n    }\r\n\r\n    $(\"#tblRequestsPermissions tbody\").append(r.join(\"\"));\r\n\r\n    $(\"#tblRequestsPermsTotal\").text(m_arrRequests.length);\r\n\r\n    if (errorCount > 0) {\r\n      $(\"#divErrorMsg\").html(\r\n        $(\"#divErrorMsg\").html() +\r\n          \"<div><fieldset><legend>Request Permissions</legend><span class='ui-icon ui-icon-alert'></span>There are (\" +\r\n          errorCount +\r\n          \") Requests with Permission issues detected</fielset></div>\"\r\n      );\r\n    }\r\n\r\n    Audit.Common.Utilities.AddOptions(arrRequestIDs, \"#ddlRequestID\", false);\r\n  }\r\n\r\n  function m_fnLoadResponsePermissions() {\r\n    m_arrResponses = new Array();\r\n\r\n    var listItemEnumerator = m_responseItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var number = oListItem.get_item(\"ReqNum\");\r\n      if (number != null) {\r\n        number = number.get_lookupValue();\r\n\r\n        var responseObject = new Object();\r\n        responseObject[\"ID\"] = oListItem.get_item(\"ID\");\r\n        responseObject[\"number\"] = number;\r\n        responseObject[\"title\"] = oListItem.get_item(\"Title\");\r\n        responseObject[\"item\"] = oListItem;\r\n\r\n        responseObject[\"sample\"] = oListItem.get_item(\"SampleNumber\");\r\n        if (responseObject[\"sample\"] == null) responseObject[\"sample\"] = \"\";\r\n\r\n        responseObject[\"actionOffice\"] = oListItem.get_item(\"ActionOffice\");\r\n        if (responseObject[\"actionOffice\"] == null)\r\n          responseObject[\"actionOffice\"] = \"\";\r\n        else\r\n          responseObject[\"actionOffice\"] =\r\n            responseObject[\"actionOffice\"].get_lookupValue();\r\n\r\n        responseObject[\"resStatus\"] = oListItem.get_item(\"ResStatus\");\r\n\r\n        m_fnLoadPermsOnItem(responseObject, oListItem);\r\n\r\n        m_arrResponses.push(responseObject);\r\n      }\r\n    }\r\n\r\n    var arrErrorRequestNoSpecialPerms = new Array();\r\n    var arrErrorResponseHasSpecialPerms = new Array();\r\n    var arrErrorResponseActionOfficeNotInRequest = new Array();\r\n\r\n    var errorCount = 0;\r\n    var sTablePermissionsBody = \"\";\r\n    var r = new Array(),\r\n      j = -1;\r\n\r\n    var responseLength = m_arrResponses.length;\r\n    for (var x = 0; x < responseLength; x++) {\r\n      var oResponse = m_arrResponses[x];\r\n\r\n      var number = oResponse.number;\r\n      var title = oResponse.title;\r\n      var status = oResponse.resStatus;\r\n      var actionOffice = oResponse.actionOffice;\r\n      var perms = oResponse.permissionsDisplay;\r\n      var hasSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oResponse.hasSpecialPermissions\r\n      );\r\n\r\n      var bRequestSpecialPerms = false;\r\n      var requestSpecialPerms = \"\";\r\n      var arrRequestActionOffices = null;\r\n      var requestActionOffices = \"\";\r\n      for (var y = 0; y < m_arrRequests.length; y++) {\r\n        if (m_arrRequests[y].number == number) {\r\n          bRequestSpecialPerms = m_arrRequests[y].hasSpecialPermissions;\r\n          requestSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n            m_arrRequests[y].hasSpecialPermissions\r\n          );\r\n          arrRequestActionOffices =\r\n            m_arrRequests[y].item.get_item(\"ActionOffice\");\r\n          requestActionOffices = m_arrRequests[y].actionOffice;\r\n          break;\r\n        }\r\n      }\r\n\r\n      var flagItem = false;\r\n      if (!bRequestSpecialPerms && oResponse.hasSpecialPermissions) {\r\n        // this should never be the case\r\n        flagItem = true;\r\n        arrErrorRequestNoSpecialPerms.push(title);\r\n      }\r\n      if (\r\n        oResponse.hasSpecialPermissions &&\r\n        status != \"4-Approved for QA\" &&\r\n        status != \"7-Closed\"\r\n      ) {\r\n        flagItem = true;\r\n        arrErrorResponseHasSpecialPerms.push(title);\r\n      }\r\n\r\n      var responseActionOfficeIsInRequest = false;\r\n      for (var y = 0; y < arrRequestActionOffices.length; y++) {\r\n        if (arrRequestActionOffices[y].get_lookupValue() == actionOffice) {\r\n          responseActionOfficeIsInRequest = true;\r\n        }\r\n      }\r\n\r\n      if (!responseActionOfficeIsInRequest) {\r\n        flagItem = true;\r\n        arrErrorResponseActionOfficeNotInRequest.push(title);\r\n      }\r\n\r\n      var styleTag = \"\";\r\n      if (flagItem) {\r\n        styleTag = ' style=\"background-color:lightsalmon\" ';\r\n        errorCount++;\r\n      }\r\n\r\n      var link =\r\n        '<a href=\"javascript:void(0);\" onclick=\\'Audit.Permissions.Report.GoToResponse(\"' +\r\n        title +\r\n        \"\\\")'>\" +\r\n        title +\r\n        \"</a>\";\r\n\r\n      requestActionOffices = requestActionOffices.replace(\r\n        actionOffice,\r\n        \"<b>\" + actionOffice + \"</b>\"\r\n      );\r\n      /*sTablePermissionsBody += '<tr class=\"response-perm-item\" ' + styleTag + '>' + \r\n\t\t\t\t'<td class=\"response-perm-item-number\" title=\"Request number\" nowrap>' + number + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-title\" title=\"Response title\" nowrap>' + link + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-status\" title=\"Response status\" nowrap>' + status + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>' + requestActionOffices + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-actionOffice\" title=\"Response action office\">' + actionOffice + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-requestSpecialPerms\" title=\"Special permissions?\">' + requestSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-specialPerms\" title=\"Special permissions\">' + hasSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"response-perm-item-perms\" title=\"Response permissions\" nowrap>' + perms + '</td>' +\r\n\t\t\t'</tr>';*/\r\n\r\n      r[++j] = '<tr class=\"response-perm-item\" ';\r\n      r[++j] = styleTag;\r\n      r[++j] = \">\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-number\" title=\"Request number\" nowrap>';\r\n      r[++j] = number;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-title\" title=\"Response title\" nowrap>';\r\n      r[++j] = link;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-status\" title=\"Response status\" nowrap>';\r\n      r[++j] = status;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>';\r\n      r[++j] = requestActionOffices;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-actionOffice\" title=\"Response action office\">';\r\n      r[++j] = actionOffice;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-requestSpecialPerms\" title=\"Special permissions?\">';\r\n      r[++j] = requestSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-specialPerms\" title=\"Special permissions\">';\r\n      r[++j] = hasSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"response-perm-item-perms\" title=\"Response permissions\" nowrap>';\r\n      r[++j] = perms;\r\n      r[++j] = \"</td></tr>\";\r\n    }\r\n\r\n    $(\"#tblResponsePermissions tbody\").append(r.join(\"\"));\r\n\r\n    $(\"#tblResponsePermsTotal\").text(m_arrResponses.length);\r\n\r\n    if (errorCount > 0) {\r\n      var errorMsg1 = m_fnGetErrorMsg(\r\n        arrErrorRequestNoSpecialPerms,\r\n        \"These Responses have Special Permisions, but their Requests do not\"\r\n      );\r\n      var errorMsg2 = m_fnGetErrorMsg(\r\n        arrErrorResponseHasSpecialPerms,\r\n        \"These Responses have Special Permisions, but their Response Status is NOT '4-Approved for QA' or '7-Closed'\"\r\n      );\r\n      var errorMsg3 = m_fnGetErrorMsg(\r\n        arrErrorResponseActionOfficeNotInRequest,\r\n        \"These Responses have an Action Office that is not specified in the Request's Action Offices\"\r\n      );\r\n\r\n      $(\"#divErrorMsg\").html(\r\n        $(\"#divErrorMsg\").html() +\r\n          \"<div style='padding-bottom:5px;'><fieldset><legend>Response Permissions</legend><span class='ui-icon ui-icon-alert'></span>There are (\" +\r\n          errorCount +\r\n          \") Responses with Permission issues detected.\" +\r\n          errorMsg1 +\r\n          errorMsg2 +\r\n          errorMsg3 +\r\n          \"</fielset></div>\"\r\n      );\r\n    }\r\n  }\r\n\r\n  function m_fnLoadResponseFolderPermissions() {\r\n    var m_arrResponseFolders = new Array();\r\n\r\n    var listItemEnumerator = m_ResponseDocsFoldersItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var folderName = oListItem.get_displayName();\r\n      for (var x = 0; x < m_arrResponses.length; x++) {\r\n        if (m_arrResponses[x].title == folderName) {\r\n          var responseFolderObject = new Object();\r\n          responseFolderObject[\"title\"] = folderName;\r\n          responseFolderObject[\"response\"] = m_arrResponses[x];\r\n\r\n          m_fnLoadPermsOnItem(responseFolderObject, oListItem);\r\n\r\n          m_arrResponseFolders.push(responseFolderObject);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    var arrErrorRequestNoSpecialPerms = new Array();\r\n    var arrErrorResponseHasSpecialPerms = new Array();\r\n    var arrErrorResponseActionOfficeNotInRequest = new Array();\r\n\r\n    var errorCount = 0;\r\n    var sTablePermissionsBody = \"\";\r\n    var r = new Array(),\r\n      j = -1;\r\n    var resFolderLength = m_arrResponseFolders.length;\r\n    for (var x = 0; x < resFolderLength; x++) {\r\n      var oResponseFolder = m_arrResponseFolders[x];\r\n\r\n      var number = oResponseFolder.response.number;\r\n      var title = oResponseFolder.response.title;\r\n      var folderName = oResponseFolder.title;\r\n      var status = oResponseFolder.response.resStatus;\r\n      var responseActionOffice = oResponseFolder.response.actionOffice;\r\n      var perms = oResponseFolder.response.permissionsDisplay;\r\n      var hasSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oResponseFolder.hasSpecialPermissions\r\n      );\r\n      var responseSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n        oResponseFolder.response.hasSpecialPermissions\r\n      );\r\n\r\n      var bRequestSpecialPerms = false;\r\n      var requestSpecialPerms = \"\";\r\n      var arrRequestActionOffices = null;\r\n      var requestActionOffices = \"\";\r\n      for (var y = 0; y < m_arrRequests.length; y++) {\r\n        if (m_arrRequests[y].number == number) {\r\n          bRequestSpecialPerms = m_arrRequests[y].hasSpecialPermissions;\r\n          requestSpecialPerms = Audit.Common.Utilities.GetTrueFalseIcon(\r\n            m_arrRequests[y].hasSpecialPermissions\r\n          );\r\n          arrRequestActionOffices =\r\n            m_arrRequests[y].item.get_item(\"ActionOffice\");\r\n          requestActionOffices = m_arrRequests[y].actionOffice;\r\n          break;\r\n        }\r\n      }\r\n\r\n      var flagItem = false;\r\n      if (\r\n        !bRequestSpecialPerms &&\r\n        oResponseFolder.response.hasSpecialPermissions\r\n      ) {\r\n        // this should never be the case\r\n        flagItem = true;\r\n        arrErrorRequestNoSpecialPerms.push(title);\r\n      }\r\n      if (\r\n        oResponseFolder.response.hasSpecialPermissions &&\r\n        status != \"4-Approved for QA\" &&\r\n        status != \"7-Closed\"\r\n      ) {\r\n        flagItem = true;\r\n        arrErrorResponseHasSpecialPerms.push(title);\r\n      }\r\n\r\n      var responseActionOfficeIsInRequest = false;\r\n      for (var y = 0; y < arrRequestActionOffices.length; y++) {\r\n        if (\r\n          arrRequestActionOffices[y].get_lookupValue() == responseActionOffice\r\n        ) {\r\n          responseActionOfficeIsInRequest = true;\r\n        }\r\n      }\r\n\r\n      if (!responseActionOfficeIsInRequest) {\r\n        flagItem = true;\r\n        arrErrorResponseActionOfficeNotInRequest.push(title);\r\n      }\r\n\r\n      var styleTag = \"\";\r\n      if (flagItem) {\r\n        styleTag = ' style=\"background-color:lightsalmon\" ';\r\n        errorCount++;\r\n      }\r\n\r\n      requestActionOffices = requestActionOffices.replace(\r\n        responseActionOffice,\r\n        \"<b>\" + responseActionOffice + \"</b>\"\r\n      );\r\n      /*sTablePermissionsBody += '<tr class=\"responseFolder-perm-item\" ' + styleTag + '>' + \r\n\t\t\t\t'<td class=\"responseFolder-perm-item-number\" title=\"Request number\" nowrap>' + number  + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-responseTitle\" title=\"Response title\">' + title  + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-title\" title=\"Response folder\" nowrap>' + folderName + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-status\" title=\"Response status\" nowrap>' + status + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>' + requestActionOffices + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-responseActionOffice\" title=\"Response action office\" nowrap>' + responseActionOffice + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-requestSpecialPerms\" title=\"Request special permissions?\" nowrap>' + requestSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-responseSpecialPerms\" title=\"Response special permissions?\" nowrap>' + hasSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-specialPerms\" title=\"Response folder special permissions\" nowrap>' + responseSpecialPerms + '</td>' +\r\n\t\t\t\t'<td class=\"responseFolder-perm-item-perms\" title=\"Folder permissions\" nowrap>' + perms + '</td>' +\r\n\t\t\t'</tr>';*/\r\n\r\n      r[++j] = '<tr class=\"responseFolder-perm-item\" ';\r\n      r[++j] = styleTag;\r\n      r[++j] = \">\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-number\" title=\"Request number\" nowrap>';\r\n      r[++j] = number;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-responseTitle\" title=\"Response title\">';\r\n      r[++j] = title;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-title\" title=\"Response folder\" nowrap>';\r\n      r[++j] = folderName;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-status\" title=\"Response status\" nowrap>';\r\n      r[++j] = status;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-requestActionOffices\" title=\"Request action offices\" nowrap>';\r\n      r[++j] = requestActionOffices;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-responseActionOffice\" title=\"Response action office\" nowrap>';\r\n      r[++j] = responseActionOffice;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-requestSpecialPerms\" title=\"Request special permissions?\" nowrap>';\r\n      r[++j] = requestSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-responseSpecialPerms\" title=\"Response special permissions?\" nowrap>';\r\n      r[++j] = hasSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-specialPerms\" title=\"Response folder special permissions\" nowrap>';\r\n      r[++j] = responseSpecialPerms;\r\n      r[++j] = \"</td>\";\r\n      r[++j] =\r\n        '<td class=\"responseFolder-perm-item-perms\" title=\"Folder permissions\" nowrap>';\r\n      r[++j] = perms;\r\n      r[++j] = \"</td></tr>\";\r\n    }\r\n\r\n    $(\"#tblResponseFolderPermissions tbody\").append(r.join(\"\"));\r\n\r\n    $(\"#tblResponseFolderPermsTotal\").text(m_arrResponseFolders.length);\r\n\r\n    if (errorCount > 0) {\r\n      var errorMsg1 = m_fnGetErrorMsg(\r\n        arrErrorRequestNoSpecialPerms,\r\n        \"These Response Folders have Special Permisions, but their Requests do not\"\r\n      );\r\n      var errorMsg2 = m_fnGetErrorMsg(\r\n        arrErrorResponseHasSpecialPerms,\r\n        \"These Response Folders have Special Permisions, but their Reponse Status is NOT '4-Approved for QA' or '7-Closed'\"\r\n      );\r\n      var errorMsg3 = m_fnGetErrorMsg(\r\n        arrErrorResponseActionOfficeNotInRequest,\r\n        \"These Response Folders have an Action Office that is not specified in the Request's Action Offices\"\r\n      );\r\n\r\n      $(\"#divErrorMsg\").html(\r\n        $(\"#divErrorMsg\").html() +\r\n          \"<div style='padding-bottom:5px;'><fieldset><legend>Response Folder Permissions</legend><span class='ui-icon ui-icon-alert'></span>There are (\" +\r\n          errorCount +\r\n          \") Response Folders with Permission issues detected.\" +\r\n          errorMsg1 +\r\n          errorMsg2 +\r\n          errorMsg3 +\r\n          \"</fieldset></div>\"\r\n      );\r\n    }\r\n  }\r\n\r\n  function m_fnGetErrorMsg(arr, msgTitle) {\r\n    var errorMsg = \"\";\r\n    if (arr.length > 0) {\r\n      errorMsg = \"<div style='padding-bottom:5px;'>\" + msgTitle + \"<ul>\";\r\n      for (var x = 0; x < arr.length; x++) {\r\n        errorMsg += \"<li>\" + arr + \"</li>\";\r\n      }\r\n      errorMsg += \"</ul></div>\";\r\n    }\r\n    return errorMsg;\r\n  }\r\n\r\n  function m_fnLoadPermsOnItem(item, oListItem) {\r\n    item[\"UserPermissions\"] = new Array();\r\n    item[\"GroupPermissions\"] = new Array();\r\n\r\n    item[\"arrUserPermissions\"] = new Array();\r\n    item[\"arrGroupPermissions\"] = new Array();\r\n\r\n    var roleAssignments = oListItem.get_roleAssignments();\r\n    var rolesEnumerator = roleAssignments.getEnumerator();\r\n    while (rolesEnumerator.moveNext()) {\r\n      var role = rolesEnumerator.get_current();\r\n      var roleMember = role.get_member();\r\n      var memeberLoginName = roleMember.get_loginName();\r\n      var memberTitleName = roleMember.get_title();\r\n\r\n      var permissionType = \"UserPermissions\";\r\n      var principalType = roleMember.get_principalType();\r\n      if (\r\n        principalType == SP.Utilities.PrincipalType.securityGroup ||\r\n        principalType == SP.Utilities.PrincipalType.sharePointGroup\r\n      ) {\r\n        permissionType = \"GroupPermissions\";\r\n      }\r\n\r\n      var roleDefs = role.get_roleDefinitionBindings();\r\n\r\n      var roleDefsEnumerator = roleDefs.getEnumerator();\r\n      while (roleDefsEnumerator.moveNext()) {\r\n        var rd = roleDefsEnumerator.get_current();\r\n        var rdName = rd.get_name();\r\n\r\n        item[permissionType].push(rdName + \" - \" + memberTitleName);\r\n\r\n        var pmObject = new Object();\r\n        pmObject.name = memberTitleName;\r\n        pmObject.permissionLevel = rdName;\r\n\r\n        item[\"arr\" + permissionType].push(pmObject);\r\n      }\r\n    }\r\n\r\n    var perms = \"\";\r\n    for (var z = 0; z < item.UserPermissions.length; z++)\r\n      perms +=\r\n        \"<div style='white-space:nowrap'>\" + item.UserPermissions[z] + \"</div>\";\r\n    for (var z = 0; z < item.GroupPermissions.length; z++)\r\n      perms +=\r\n        \"<div style='white-space:nowrap'>\" +\r\n        item.GroupPermissions[z] +\r\n        \"</div>\";\r\n\r\n    var specialPerms = false;\r\n    if (\r\n      perms.indexOf(Audit.Common.Utilities.GetGroupNameSpecialPerm1()) >= 0 &&\r\n      perms.indexOf(Audit.Common.Utilities.GetGroupNameSpecialPerm2()) >= 0\r\n    ) {\r\n      specialPerms = true;\r\n    }\r\n\r\n    if (perms != \"\")\r\n      perms =\r\n        \"<div class='permsLink' style='cursor:pointer' title='Click to view' ><a href='javascript:void(0)'>View</a><div class='permsInfo collapsed'>\" +\r\n        perms +\r\n        \"</div></div>\";\r\n    item[\"permissionsDisplay\"] = perms;\r\n    item[\"hasSpecialPermissions\"] = specialPerms;\r\n  }\r\n\r\n  function m_fnBindHandlerPermissionLinks() {\r\n    $(\".permsLink\").click(function () {\r\n      $(this).find(\".permsInfo\").toggleClass(\"collapsed\");\r\n    });\r\n  }\r\n\r\n  function m_fnLoadSPGroupPermissions(OnCompleteLoading) {\r\n    m_arrGroups = new Array();\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    m_collGroup = currCtx.get_web().get_siteGroups();\r\n    currCtx.load(m_collGroup);\r\n\r\n    function OnSuccess1(sender, args) {\r\n      m_arrGroups = new Array();\r\n      var listEnumerator = m_collGroup.getEnumerator();\r\n      while (listEnumerator.moveNext()) {\r\n        var item = listEnumerator.get_current();\r\n        var groupName = item.get_title();\r\n        groupName = $.trim(groupName);\r\n        var groupID = item.get_id();\r\n\r\n        var oGroup = new Object();\r\n        oGroup[\"Title\"] = groupName;\r\n        oGroup[\"ID\"] = groupID;\r\n        oGroup[\"Users\"] = null;\r\n        m_arrGroups.push(oGroup);\r\n      }\r\n\r\n      OnCompleteLoading(true);\r\n    }\r\n    function OnFailure1(sender, args) {\r\n      OnCompleteLoading(true);\r\n    }\r\n    currCtx.executeQueryAsync(OnSuccess1, OnFailure1);\r\n  }\r\n\r\n  /*\tfunction m_fnLoadSPGroupPermissions( OnCompleteLoading )\r\n\t{\r\n\t\tm_arrGroups = new Array();\r\n\t\t\r\n\t\tvar currCtx = new SP.ClientContext.get_current();\r\n\t\tvar web = currCtx.get_web();\r\n\t\t\r\n\t\tm_collGroup = currCtx.get_web().get_siteGroups();\r\n\t    currCtx.load( m_collGroup );\r\n\t   \tcurrCtx.load( m_collGroup, \"Include(Users)\")\r\n\t   \t\r\n\t\tfunction OnSuccess1(sender, args)\r\n\t\t{\r\n\t\t\tm_arrGroups = new Array();\r\n\t\t\tvar listEnumerator = m_collGroup.getEnumerator(); \r\n\t\t\twhile (listEnumerator.moveNext()) \r\n\t\t\t{ \r\n\t\t\t\tvar item = listEnumerator.get_current(); \r\n\t\t\t\tgroupName = item.get_title(); \t\t\t\r\n\t\t\t\tgroupName = $.trim(groupName);\r\n\t\t\t\tgroupID = item.get_id();\r\n\t\r\n\t\t\t\tvar arrPerms = new Array();\r\n\t\t\t\tvar listEnumerator1 = item.get_users().getEnumerator(); \r\n\t\t\t\twhile (listEnumerator1.moveNext()) \r\n\t\t\t\t{\r\n\t\t\t\t\t var item1 = listEnumerator1.get_current();\t\t\t\t\t\t\t \r\n\t\t\t\t\t var displayName = item1.get_loginName();\r\n\t\t\t\t\t arrPerms.push( displayName );\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tarrPerms.sort();\t\t\t\t\t\t\r\n\t\t\t\tvar users = \"\";\r\n\t\t\t\tfor( var g = 0; g < arrPerms.length; g++ )\r\n\t\t\t\t{\r\n\t\t\t\t\t users += arrPerms[g] + \"; \";\t\t\t\t\t\t\t \r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tvar oGroup = new Object();\r\n\t\t\t\toGroup[\"Title\"] = groupName;\r\n\t\t\t\toGroup[\"ID\"] = groupID;\r\n\t\t\t\toGroup[\"Users\"] = users;\r\n\t\t\t\tm_arrGroups.push( oGroup );\r\n\t\t\t} \r\n\t\t\t\r\n\t\t\tOnCompleteLoading ( true );\r\n\t\t}\r\n\t\tfunction OnFailure1(sender, args)\r\n\t\t{\r\n\t\t\tOnCompleteLoading ( true );\r\n\t\t}\t\t\t\t\r\n\t\tcurrCtx.executeQueryAsync(OnSuccess1, OnFailure1);\t\r\n\t}\r\n*/\r\n  function m_fnDisplaySPGroupPermissions(itemCollection) {\r\n    m_oAOGroupUsers = new Object();\r\n\r\n    $(\"#linkGetVerification\").prop(\"disabled\", true);\r\n\r\n    var aos = Audit.Common.Utilities.GetActionOffices();\r\n    var output = \"\";\r\n    var aoCnt = 0;\r\n    for (var x = 0; x < aos.length; x++) {\r\n      var actionOfficeName = aos[x].title;\r\n      if (actionOfficeName.indexOf(\"Select Action\") > 0) continue;\r\n\r\n      aoCnt++;\r\n\r\n      var groupName = aos[x].userGroup;\r\n      var groupId = \"\";\r\n      var perms = \"\";\r\n\r\n      if (groupName != null && groupName != \"\") {\r\n        for (var y = 0; y < m_arrGroups.length; y++) {\r\n          if (m_arrGroups[y].Title == groupName) {\r\n            groupId = m_arrGroups[y].ID;\r\n            //perms = m_arrGroups[y].Users;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (groupId != \"\")\r\n        output +=\r\n          \"<tr class='trGroup'><td class='removeOnExport'><input class='cbAO' id='cbAO\" +\r\n          x +\r\n          \"' type='checkbox' style='cursor: pointer;'></td><td class='actionOfficeName'>\" +\r\n          actionOfficeName +\r\n          \"</td><td class='groupName' style='white-space:nowrap'><a href='javascript:void(0)' onclick='Audit.Permissions.Report.ViewSitePermissionsGroup(\\\"\" +\r\n          groupId +\r\n          '\",\"' +\r\n          groupName +\r\n          \"\\\")'>\" +\r\n          groupName +\r\n          \"</a></td><td class='groupPerms' id='groupPerms\" +\r\n          x +\r\n          \"' >\" +\r\n          \"</td></tr>\";\r\n      else\r\n        output +=\r\n          \"<tr class='trGroup'><td class='removeOnExport'><input class='cbAO' id='cbAO\" +\r\n          x +\r\n          \"' type='checkbox' style='cursor: pointer;'></td><td class='actionOfficeName'>\" +\r\n          actionOfficeName +\r\n          \"</td><td class='groupName' style='white-space:nowrap'></td><td class='groupPerms' id='groupPerms\" +\r\n          x +\r\n          \"' ></td></tr>\";\r\n    }\r\n\r\n    if (aos.length == 0) {\r\n      output = \"<div>0 Action Groups found</div>\";\r\n    } else {\r\n      $(\"#fbody\").html(output);\r\n      $(\"#spanTotalAOS\").text(aoCnt);\r\n    }\r\n\r\n    $(\".cbAO\").click(function () {\r\n      var count = 0;\r\n      $(\".cbAO\").each(function () {\r\n        if ($(this).is(\":checked\")) {\r\n          count++;\r\n          return;\r\n        }\r\n      });\r\n\r\n      if (count > 0) $(\"#linkGetVerification\").prop(\"disabled\", false);\r\n      else $(\"#linkGetVerification\").prop(\"disabled\", true);\r\n    });\r\n\r\n    var cntGroupsToLoad = 0;\r\n    for (var x = 0; x < aos.length; x++) {\r\n      var actionOfficeName = aos[x].title;\r\n      if (actionOfficeName.indexOf(\"Select Action\") > 0) continue;\r\n\r\n      var groupName = aos[x].userGroup;\r\n      var groupId = null;\r\n      for (var y = 0; y < m_arrGroups.length; y++) {\r\n        if (m_arrGroups[y].Title == groupName) {\r\n          groupId = m_arrGroups[y].ID;\r\n          //perms = m_arrGroups[y].Users;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (groupId != null) {\r\n        cntGroupsToLoad++;\r\n\r\n        var currCtx = new SP.ClientContext.get_current();\r\n        var web = currCtx.get_web();\r\n        var collGroup = web.get_siteGroups();\r\n\r\n        var oGroup = collGroup.getById(groupId);\r\n        var collUser = oGroup.get_users();\r\n        currCtx.load(collUser);\r\n\r\n        var data = { x: x, groupName: groupName, collUser: collUser };\r\n        function onLoadGroupSucceeded() {\r\n          var arrPerms = new Array();\r\n          var listEnumerator1 = this.collUser.getEnumerator();\r\n          while (listEnumerator1.moveNext()) {\r\n            var item1 = listEnumerator1.get_current();\r\n            var displayName =\r\n              item1.get_loginName() + \" (\" + item1.get_title() + \")\";\r\n            arrPerms.push(displayName);\r\n          }\r\n\r\n          arrPerms = arrPerms.sort();\r\n          var users = \"\";\r\n          for (var g = 0; g < arrPerms.length; g++) {\r\n            users += arrPerms[g] + \"; \";\r\n          }\r\n\r\n          $(\"#groupPerms\" + this.x).html(m_fnGetFriendlyUsers(users));\r\n\r\n          m_oAOGroupUsers[this.groupName] = users;\r\n        }\r\n\r\n        function onLoadGroupFailed(sender, args) {}\r\n\r\n        currCtx.executeQueryAsync(\r\n          Function.createDelegate(data, onLoadGroupSucceeded),\r\n          Function.createDelegate(data, onLoadGroupFailed)\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnDisplaySPGroupPermissions2(itemCollection) {\r\n    var aos = Audit.Common.Utilities.GetActionOffices();\r\n    var output = \"\";\r\n\r\n    var arrSPGroups = new Array();\r\n    arrSPGroups.push(m_ownerGroupName);\r\n    arrSPGroups.push(m_memberGroupName);\r\n    arrSPGroups.push(m_visitorGroupName);\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameQA());\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameEA());\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameSpecialPerm1());\r\n    arrSPGroups.push(Audit.Common.Utilities.GetGroupNameSpecialPerm2());\r\n\r\n    var spGroupCnt = 0;\r\n    for (var x = 0; x < arrSPGroups.length; x++) {\r\n      spGroupCnt++;\r\n\r\n      var groupName = arrSPGroups[x];\r\n      var groupId = \"\";\r\n      var perms = \"\";\r\n\r\n      for (var y = 0; y < m_arrGroups.length; y++) {\r\n        if (m_arrGroups[y].Title == groupName) {\r\n          groupId = m_arrGroups[y].ID;\r\n          break;\r\n        }\r\n      }\r\n\r\n      output +=\r\n        \"<tr class='trSPGroup'><td class='spgroupName' style='white-space:nowrap'><a href='javascript:void(0)' onclick='Audit.Permissions.Report.ViewSitePermissionsGroup(\\\"\" +\r\n        groupId +\r\n        '\",\"' +\r\n        groupName +\r\n        \"\\\")'>\" +\r\n        groupName +\r\n        \"</a></td><td class='spgroupPerms' id='spgroupPerms\" +\r\n        x +\r\n        \"' >\" +\r\n        \"</td></tr>\";\r\n    }\r\n\r\n    $(\"#fbodySPGroups\").html(output);\r\n\r\n    var cntSPGroupsToLoad = 0;\r\n    for (var x = 0; x < arrSPGroups.length; x++) {\r\n      var groupName = arrSPGroups[x];\r\n      var groupId = null;\r\n      for (var y = 0; y < m_arrGroups.length; y++) {\r\n        if (m_arrGroups[y].Title == groupName) {\r\n          groupId = m_arrGroups[y].ID;\r\n          //perms = m_arrGroups[y].Users;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (groupId != null) {\r\n        cntSPGroupsToLoad++;\r\n\r\n        var currCtx = new SP.ClientContext.get_current();\r\n        var web = currCtx.get_web();\r\n        var collGroup = web.get_siteGroups();\r\n\r\n        var oGroup = collGroup.getById(groupId);\r\n        var collUser = oGroup.get_users();\r\n        currCtx.load(collUser);\r\n\r\n        var data = { x: x, collUser: collUser };\r\n        function onLoadSPGroupSucceeded() {\r\n          var arrPerms = new Array();\r\n          var listEnumerator1 = this.collUser.getEnumerator();\r\n          while (listEnumerator1.moveNext()) {\r\n            var item1 = listEnumerator1.get_current();\r\n            var displayName =\r\n              item1.get_loginName() + \" (\" + item1.get_title() + \")\";\r\n            arrPerms.push(displayName);\r\n          }\r\n\r\n          arrPerms = arrPerms.sort();\r\n          var users = \"\";\r\n          for (var g = 0; g < arrPerms.length; g++) {\r\n            users += arrPerms[g] + \"; \";\r\n          }\r\n\r\n          $(\"#spgroupPerms\" + this.x).html(m_fnGetFriendlyUsers(users));\r\n        }\r\n\r\n        function onLoadSPGroupFailed(sender, args) {}\r\n\r\n        currCtx.executeQueryAsync(\r\n          Function.createDelegate(data, onLoadSPGroupSucceeded),\r\n          Function.createDelegate(data, onLoadSPGroupFailed)\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnFormatEmailBodyToAOForVerification(\r\n    m_txtOutgoingEmailText,\r\n    group,\r\n    users\r\n  ) {\r\n    var emailText =\r\n      m_txtOutgoingEmailText +\r\n      \"<br/>\" +\r\n      \"Please verify the following users for <b>\" +\r\n      group +\r\n      \"</b><br/>\" +\r\n      \"<div>\" +\r\n      users +\r\n      \"</div>\";\r\n\r\n    return emailText;\r\n  }\r\n\r\n  var m_emailCount = 0;\r\n  function m_fnGetVerification() {\r\n    m_txtOutgoingEmailText = \"\";\r\n\r\n    var aos = \"\";\r\n    $(\".trGroup\").each(function () {\r\n      var cb = $(this).find(\"input\");\r\n      if (cb && cb.is(\":checked\")) {\r\n        var group = $.trim($(this).find(\".groupName\").text());\r\n        if (group != null && group != \"\") aos += \"<li>\" + group + \"</li>\";\r\n      }\r\n    });\r\n\r\n    if (aos == \"\") {\r\n      notifyId = SP.UI.Notify.addNotification(\r\n        \"Please select an Action Office\",\r\n        false\r\n      );\r\n      return;\r\n    } else {\r\n      aos = \"<ul style='color:green'>\" + aos + \"</ul>\";\r\n    }\r\n\r\n    var verificationDocDlg =\r\n      \"<div id='verificationDocDlg' style='padding:20px; height:100px'><div style='padding:20px; width:600px'>Are you sure you would like to Email the following Action Offices for Verification?<p style='padding-top:10px'>\" +\r\n      aos +\r\n      \"</p> <p style='padding-top:10px'>If so, please specify any Custom Message to Append to the Outgoing Email Text: </p><p><input id='txtOutgoingEmailText' maxlength='300' size='100' onkeyup='Audit.Permissions.Report.GetEmailText()'></input></p></span></div>\" +\r\n      \"<table style='padding-top:10px; width:400px; margin:0px auto'>\" +\r\n      \"<tr><td><input id='btnClientOk1' type='button' class='ms-ButtonHeightWidth' value='Yes Send Email' onclick='SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK)'/></td>\" +\r\n      \"<td class='ms-separator'>&#160;</td><td><input id='btnCancel' type='button' class='ms-ButtonHeightWidth' value='Close' onclick='SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.cancel)'/></td></tr>\" +\r\n      \"</table></div>\";\r\n\r\n    $(\"body\").append(verificationDocDlg);\r\n\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Email Action Office for User Verification\";\r\n    options.dialogReturnValueCallback = OnCallbackSendVerification;\r\n    options.html = document.getElementById(\"verificationDocDlg\");\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function OnCallbackSendVerification(result, value) {\r\n    if (result === SP.UI.DialogResult.OK) {\r\n      m_waitDialog = SP.UI.ModalDialog.showWaitScreenWithNoClose(\r\n        \"Sending Emails\",\r\n        \"Please wait... Sending Emails\",\r\n        200,\r\n        400\r\n      );\r\n\r\n      setTimeout(function () {\r\n        m_fnSendVerificationEmails();\r\n      }, 1000);\r\n    }\r\n  }\r\n\r\n  function m_fnSendVerificationEmails() {\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var emailList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleEmailHistory());\r\n    var emailListQuery = new SP.CamlQuery();\r\n    emailListQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"ID\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\"/><Value Type=\"Text\">1</Value></Eq></Where></Query></View>'\r\n    );\r\n    var emailListFolderItems = emailList.getItems(emailListQuery);\r\n    currCtx.load(\r\n      emailListFolderItems,\r\n      \"Include(ID, FSObjType, Title, DisplayName)\"\r\n    );\r\n\r\n    function OnSuccess(sender, args) {\r\n      //document.body.style.cursor = 'wait';\r\n\r\n      if (\r\n        !Audit.Common.Utilities.CheckIfEmailFolderExists(\r\n          emailListFolderItems,\r\n          m_emailFolderName\r\n        )\r\n      ) {\r\n        Audit.Common.Utilities.CreateEmailFolder(\r\n          emailList,\r\n          m_emailFolderName,\r\n          null\r\n        );\r\n      }\r\n\r\n      m_emailCount = 0;\r\n      $(\".trGroup\").each(function () {\r\n        var cb = $(this).find(\"input\");\r\n        if (cb && cb.is(\":checked\")) {\r\n          var group = $.trim($(this).find(\".groupName\").text());\r\n          if (group != null && group != \"\") m_emailCount++;\r\n        }\r\n      });\r\n\r\n      if (m_emailCount == 0) {\r\n        notifyId = SP.UI.Notify.addNotification(\r\n          \"Please select an Action Office\",\r\n          false\r\n        );\r\n        //document.body.style.cursor = 'default';\r\n        m_waitDialog.close();\r\n      }\r\n\r\n      var cnt = 0;\r\n      $(\".trGroup\").each(function () {\r\n        var cb = $(this).find(\"input\");\r\n        //var aoName = $.trim( $(this).find(\".actionOfficeName\").text() );\r\n        var group = $.trim($(this).find(\".groupName\").text());\r\n        //var users = $.trim( $(this).find(\".groupPerms\").html() );\r\n\r\n        if (cb && cb.is(\":checked\") && group != null && group != \"\") {\r\n          var users = m_oAOGroupUsers[group];\r\n          users = m_fnGetFriendlyUsers(users); //for some reason, doing this instead of getting .groupperms above outputs correctly in email without extra lines\r\n\r\n          var emailSubject =\r\n            \"Please review the Audit Tool users for (\" + group + \")\";\r\n          var emailText = m_fnFormatEmailBodyToAOForVerification(\r\n            m_txtOutgoingEmailText,\r\n            group,\r\n            users\r\n          );\r\n          var itemCreateInfo = new SP.ListItemCreationInformation();\r\n          itemCreateInfo.set_folderUrl(\r\n            location.protocol +\r\n              \"//\" +\r\n              location.host +\r\n              Audit.Common.Utilities.GetSiteUrl() +\r\n              \"/Lists/\" +\r\n              Audit.Common.Utilities.GetListNameEmailHistory() +\r\n              \"/\" +\r\n              m_emailFolderName\r\n          );\r\n          var oListItemEmail = emailList.addItem(itemCreateInfo);\r\n          oListItemEmail.set_item(\"Title\", emailSubject);\r\n          oListItemEmail.set_item(\"Body\", emailText);\r\n          oListItemEmail.set_item(\"To\", group);\r\n          oListItemEmail.set_item(\"NotificationType\", \"AO Verification\");\r\n          oListItemEmail.update();\r\n\r\n          currCtx.executeQueryAsync(\r\n            function () {\r\n              cnt++;\r\n              if (cnt == m_emailCount) {\r\n                m_waitDialog.close();\r\n                //document.body.style.cursor = 'default';\r\n                notifyId = SP.UI.Notify.addNotification(\r\n                  \"Completed Sending Email Verifications\",\r\n                  false\r\n                );\r\n\r\n                m_fnUncheckCheckboxes();\r\n                //m_fnViewEmailHistoryFolder();\r\n              }\r\n            },\r\n            function (sender, args) {\r\n              //document.body.style.cursor = 'default';\r\n              m_waitDialog.close();\r\n              alert(\r\n                \"Request failed: \" +\r\n                  args.get_message() +\r\n                  \"\\n\" +\r\n                  args.get_stackTrace()\r\n              );\r\n              m_fnRefresh();\r\n            }\r\n          );\r\n        }\r\n      });\r\n    }\r\n    function OnFailure(sender, args) {\r\n      m_waitDialog.close();\r\n    }\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n  }\r\n\r\n  function m_fnCheckCheckboxes() {\r\n    $(\"#linkGetVerification\").prop(\"disabled\", false);\r\n\r\n    $(\".trGroup\").each(function () {\r\n      var cb = $(this).find(\"input\");\r\n      if (cb && !cb.is(\":checked\")) {\r\n        cb.prop(\"checked\", true);\r\n      }\r\n    });\r\n  }\r\n\r\n  function m_fnUncheckCheckboxes() {\r\n    $(\"#linkGetVerification\").prop(\"disabled\", true);\r\n\r\n    $(\".trGroup\").each(function () {\r\n      var cb = $(this).find(\"input\");\r\n      if (cb && cb.is(\":checked\")) {\r\n        cb.prop(\"checked\", false);\r\n      }\r\n    });\r\n  }\r\n\r\n  function m_fnGetFriendlyUsers(perms) {\r\n    if (perms == null || perms == \"\") return \"\";\r\n\r\n    perms = perms.replace(/; /gi, \";\");\r\n    var permArr = perms.split(\";\");\r\n    permArr = permArr.sort();\r\n    var output = \"<ul>\";\r\n    for (var x = 0; x < permArr.length; x++) {\r\n      if (permArr[x] != null && $.trim(permArr[x])) {\r\n        output += \"<li>\" + permArr[x] + \"</li>\";\r\n      }\r\n    }\r\n    output += \"</ul>\";\r\n    return output;\r\n  }\r\n  /*function m_fnDisplaySPGroupPermissions( itemCollection )\r\n\t{\r\n\t\tvar arrGroups = new Array();\r\n\t\tvar listEnumerator = itemCollection.getEnumerator(); \r\n\t\twhile (listEnumerator.moveNext()) \r\n\t\t{ \r\n\t\t\tvar item = listEnumerator.get_current(); \r\n\t\t\tgroupName = item.get_title(); \t\t\t\r\n\t\t\tgroupName = $.trim(groupName);\r\n\t\t\tgroupID = item.get_id();\r\n\r\n\t\t\tvar arrPerms = new Array();\r\n\t\t\tvar listEnumerator1 = item.get_users().getEnumerator(); \r\n\t\t\twhile (listEnumerator1.moveNext()) \r\n\t\t\t{\r\n\t\t\t\t var item1 = listEnumerator1.get_current();\t\t\t\t\t\t\t \r\n\t\t\t\t var displayName = item1.get_loginName();\r\n\t\t\t\t arrPerms.push( displayName );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tarrPerms.sort();\t\t\t\t\t\t\r\n\t\t\tvar users = \"\";\r\n\t\t\tfor( var g = 0; g < arrPerms.length; g++ )\r\n\t\t\t{\r\n\t\t\t\t users += arrPerms[g] + \"; \";\t\t\t\t\t\t\t \r\n\t\t\t}\r\n\r\n\t\t\tvar oGroup = new Object();\r\n\t\t\toGroup[\"Title\"] = groupName;\r\n\t\t\toGroup[\"ID\"] = groupID;\r\n\t\t\toGroup[\"Users\"] = users;\r\n\t\t\tarrGroups.push( oGroup );\r\n\t\t} \r\n\t\t\t\r\n\t\tvar output = \"<table id='table_Groups' class='tablesorter' style='width:800px'><thead><tr><th>SharePoint Group Name</th><th>Users</th></tr></thead><tbody id='fbody'>\";\r\n\t\t\r\n\t\tfor( var x = 0; x < arrGroups.length; x++ )\r\n\t\t{\r\n\t\t\tvar groupName = arrGroups[x].Title;\r\n\t\t\tvar groupId = arrGroups[x].ID;\r\n\t\t\tvar perms = arrGroups[x].Users;\r\n\t\t\t\r\n\t\t\toutput += \"<tr><td class='groupName' style='white-space:nowrap'><a href='javascript:void(0)' onclick='Audit.Permissions.Report.ViewSitePermissionsGroup(\\\"\" + groupId + \"\\\",\\\"\" + groupName + \"\\\")'>\" + groupName + \"</a></td><td id='groupPerms\" + x +\"' >\" + perms + \"</td></tr>\";\r\n\t\t}\r\n\t\toutput += \"</tbody><tfoot><tr><th colspan = '3' style='text-align:left;white-space:nowrap'>Total: \" + arrGroups.length + \"</th></tr></tfoot></table>\";\r\n\t\t\r\n\t\tif( arrGroups.length == 0 )\r\n\t\t{\r\n\t\t\toutput = \"<div>0 Groups found</div>\";\r\n\t\t}\r\n\t\t\r\n\t\t$(\"#divTblOutput\").html( output );\r\n\t}*/\r\n\r\n  function LoadDDOptions() {\r\n    var arrResponseRequestID = new Array();\r\n    var arrResponseTitle = new Array();\r\n\r\n    $(\".request-perm-item-number\").each(function () {\r\n      var val = $(this).text();\r\n      if (!Audit.Common.Utilities.ExistsInArr(arrResponseRequestID, val))\r\n        arrResponseRequestID.push(val);\r\n    });\r\n\r\n    $(\".response-perm-item-title\").each(function () {\r\n      var val = $(this).text();\r\n      if (!Audit.Common.Utilities.ExistsInArr(arrResponseTitle, val))\r\n        arrResponseTitle.push(val);\r\n    });\r\n\r\n    Audit.Common.Utilities.AddOptions(\r\n      arrResponseRequestID,\r\n      \"#ddlResponseRequestID\",\r\n      false\r\n    );\r\n    Audit.Common.Utilities.AddOptions(\r\n      arrResponseTitle,\r\n      \"#ddlResponseFolderResponseID\",\r\n      false\r\n    );\r\n  }\r\n\r\n  function m_fnGoToRequest(requestNumber) {\r\n    notifyId = SP.UI.Notify.addNotification(\r\n      \"Displaying Request (\" + requestNumber + \")\",\r\n      false\r\n    );\r\n\r\n    $(\"#ddlResponseRequestID\").val(requestNumber).change();\r\n\r\n    $(\"#tabs\").tabs({ active: 1 });\r\n  }\r\n\r\n  function m_fnGoToResponse(responseTitle) {\r\n    notifyId = SP.UI.Notify.addNotification(\r\n      \"Displaying Response (\" + responseTitle + \")\",\r\n      false\r\n    );\r\n\r\n    $(\"#ddlResponseFolderResponseID\").val(responseTitle).change();\r\n\r\n    $(\"#tabs\").tabs({ active: 2 });\r\n  }\r\n\r\n  function m_fnBindHandlersOnLoad() {\r\n    m_fnBindPrintButton(\"#btnPrint\", \"#divTblOutput\");\r\n\r\n    /**Note: for the export to work, make sure this is added to the html: <iframe id=\"CsvExpFrame\" style=\"display: none\"></iframe>**/\r\n    m_fnBindExportButton(\".export\", \"GroupPermissions_\", \"table_Groups\");\r\n\r\n    m_fnBindHandlerPermissionLinks();\r\n\r\n    $(\"#ddlRequestID\").change(function () {\r\n      $(\"#ddlResponseRequestID\").val($(this).val());\r\n\r\n      setTimeout(function () {\r\n        FilterRequests();\r\n      }, 10);\r\n    });\r\n\r\n    $(\"#ddlResponseRequestID\").change(function () {\r\n      $(\"#ddlRequestID\").val($(this).val());\r\n\r\n      setTimeout(function () {\r\n        FilterRequests();\r\n      }, 10);\r\n    });\r\n\r\n    $(\"#ddlResponseFolderResponseID\").change(function () {\r\n      setTimeout(function () {\r\n        FilterResponses();\r\n      }, 10);\r\n    });\r\n\r\n    $(\"#linkViewAO\").click(function () {\r\n      m_fnViewAOs();\r\n    });\r\n    $(\"#linkAddAO\").click(function () {\r\n      m_fnAddAO();\r\n    });\r\n\r\n    $(\"#linkUploadPermissions\").click(function () {\r\n      m_fnUploadPermissions();\r\n    });\r\n\r\n    $(\"#linkGetVerification\").click(function () {\r\n      m_fnGetVerification();\r\n    });\r\n\r\n    $(\"#linkEmailHistory\").click(function () {\r\n      m_fnViewEmailHistoryFolder();\r\n    });\r\n\r\n    $(\"#linkViewExportFriendly\").click(function () {\r\n      $(\".removeOnExport\").toggle();\r\n\r\n      $(\".groupPerms\").each(function () {\r\n        if ($(this).html().toLowerCase().indexOf(\"<ul>\") >= 0) {\r\n          var friendlyNames = \"\";\r\n\r\n          $(this)\r\n            .find(\"LI\")\r\n            .each(function () {\r\n              var curText = $(this).text();\r\n              var index = curText.indexOf(\"(\");\r\n              if (index >= 0) curText = curText.substring(0, index);\r\n              curText = $.trim(curText);\r\n\r\n              friendlyNames += curText + \";\";\r\n            });\r\n\r\n          $(this).html(friendlyNames);\r\n        }\r\n      });\r\n    });\r\n\r\n    $(\"#cbAOAll\").click(function () {\r\n      if ($(this).is(\":checked\")) m_fnCheckCheckboxes();\r\n      else m_fnUncheckCheckboxes();\r\n    });\r\n  }\r\n\r\n  function m_fnViewAOs() {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"View Action Office Details\";\r\n    //options.height = \"800\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/lists/\" +\r\n      Audit.Common.Utilities.GetListNameActionOffices();\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnAddAO() {\r\n    var formName = \"NewForm.aspx\";\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Add Action Office\";\r\n    //options.height = \"800\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/lists/\" +\r\n      Audit.Common.Utilities.GetListNameActionOffices() +\r\n      \"/\" +\r\n      formName;\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  //Captures the values from all of the drop downs and uses them to filter the rows\r\n  function FilterRequests() {\r\n    var requestID = $(\"#ddlRequestID\").val();\r\n\r\n    //each row in the data form web part is marked with this class; it iterates through each to find the containing class to see if it matches\r\n    //the value that has been selected in the drop down\r\n    $(\".request-perm-item\").each(function () {\r\n      var hide = false;\r\n\r\n      if (\r\n        !hide &&\r\n        requestID != \"\" &&\r\n        $.trim($(this).find(\".request-perm-item-number\").text()) != requestID\r\n      ) {\r\n        hide = true;\r\n      }\r\n\r\n      if (hide) $(this).hide();\r\n      else $(this).show();\r\n    });\r\n\r\n    //each row in the data form web part is marked with this class; it iterates through each to find the containing class to see if it matches\r\n    //the value that has been selected in the drop down\r\n    $(\".response-perm-item\").each(function () {\r\n      var hide = false;\r\n\r\n      if (\r\n        !hide &&\r\n        requestID != \"\" &&\r\n        $.trim($(this).find(\".response-perm-item-number\").text()) != requestID\r\n      ) {\r\n        hide = true;\r\n      }\r\n\r\n      if (hide) $(this).hide();\r\n      else $(this).show();\r\n    });\r\n  }\r\n\r\n  //Captures the values from all of the drop downs and uses them to filter the rows\r\n  function FilterResponses() {\r\n    var responseTitle = $(\"#ddlResponseFolderResponseID\").val();\r\n\r\n    //each row in the data form web part is marked with this class; it iterates through each to find the containing class to see if it matches\r\n    //the value that has been selected in the drop down\r\n    $(\".responseFolder-perm-item\").each(function () {\r\n      var hide = false;\r\n\r\n      if (\r\n        !hide &&\r\n        responseTitle != \"\" &&\r\n        $.trim($(this).find(\".responseFolder-perm-item-title\").text()) !=\r\n          responseTitle\r\n      ) {\r\n        hide = true;\r\n      }\r\n\r\n      if (hide) $(this).hide();\r\n      else $(this).show();\r\n    });\r\n  }\r\n\r\n  function m_fnBindPrintButton(btnPrint, divTbl) {\r\n    var pageTitle = \"Audit Site Group Permissions (SharePoint Site)\";\r\n    $(btnPrint).on(\"click\", function () {\r\n      PrintPage(pageTitle, divTbl);\r\n    });\r\n  }\r\n\r\n  function m_fnBindExportButton(btnExport, fileNamePrefix, tbl) {\r\n    $(btnExport).on(\"click\", function (event) {\r\n      var curDate = new Date().format(\"yyyyMMdd\");\r\n      ExportToCsv(fileNamePrefix + curDate, tbl);\r\n    });\r\n  }\r\n\r\n  //This function will grab the html from the container var to display in a new window.\r\n  //It also loads the css files that are on the current page and appends it to the output that is displayed in a new window to maintain the styles\r\n  function PrintPage(title, container) {\r\n    var curDate = new Date();\r\n    var cssLink1 =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/siteassets/css/tablesorter/style.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink2 =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/siteassets/css/audit_styles.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink3 =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/siteassets/css/audit_page_reports.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n\r\n    var divOutput = $(container).html();\r\n\r\n    var printDateString = curDate.format(\"MM/dd/yyyy hh:mm tt\");\r\n    printDateString =\r\n      \"<div style='padding-bottom:10px;'>\" + printDateString + \"</div>\";\r\n    divOutput = printDateString + divOutput;\r\n\r\n    var cssFile1 = $(\"<div></div>\");\r\n    var cssFile2 = $(\"<div></div>\");\r\n    var cssFile3 = $(\"<div></div>\");\r\n\r\n    var def1 = $.Deferred();\r\n    var def2 = $.Deferred();\r\n    var def3 = $.Deferred();\r\n\r\n    var cssFileText = \"\";\r\n    cssFile1.load(cssLink1, function () {\r\n      cssFileText += \"<style>\" + cssFile1.html() + \"</style>\";\r\n      def1.resolve();\r\n    });\r\n    cssFile2.load(cssLink2, function () {\r\n      cssFileText += \"<style>\" + cssFile2.html() + \"</style>\";\r\n      def2.resolve();\r\n    });\r\n    cssFile3.load(cssLink3, function () {\r\n      cssFileText += \"<style>\" + cssFile3.html() + \"</style>\";\r\n      def3.resolve();\r\n    });\r\n\r\n    $.when(def1, def2, def3).done(function () {\r\n      var html =\r\n        \"<HTML>\\n\" +\r\n        \"<HEAD>\\n\\n\" +\r\n        \"<Title>\" +\r\n        title +\r\n        \"</Title>\\n\" +\r\n        cssFileText +\r\n        \"\\n\" +\r\n        \"<style>\" +\r\n        \".hideOnPrint {display:none}\" +\r\n        \"</style>\\n\" +\r\n        \"</HEAD>\\n\" +\r\n        \"<BODY>\\n\" +\r\n        divOutput +\r\n        \"\\n\" +\r\n        \"</BODY>\\n\" +\r\n        \"</HTML>\";\r\n\r\n      var printWP = window.open(\"\", \"printWebPart\");\r\n      printWP.document.open();\r\n      //insert content\r\n      printWP.document.write(html);\r\n\r\n      printWP.document.close();\r\n      //open print dialog\r\n      printWP.print();\r\n    });\r\n  }\r\n  //make sure iframe with id csvexprframe is added to page up top\r\n  //http://stackoverflow.com/questions/18185660/javascript-jquery-exporting-data-in-csv-not-working-in-ie\r\n  function ExportToCsv(fileName, tableName, removeHeader) {\r\n    var data = GetCellValues(tableName);\r\n    if (removeHeader == true) data = data.slice(1);\r\n\r\n    var csv = ConvertToCsv(data);\r\n    if (navigator.userAgent.search(\"Trident\") >= 0) {\r\n      window.CsvExpFrame.document.open(\"text/html\", \"replace\");\r\n      window.CsvExpFrame.document.write(csv);\r\n      window.CsvExpFrame.document.close();\r\n      window.CsvExpFrame.focus();\r\n      window.CsvExpFrame.document.execCommand(\r\n        \"SaveAs\",\r\n        true,\r\n        fileName + \".csv\"\r\n      );\r\n    } else {\r\n      var uri = \"data:text/csv;charset=utf-8,\" + escape(csv);\r\n      var downloadLink = document.createElement(\"a\");\r\n      downloadLink.href = uri;\r\n      downloadLink.download = fileName + \".csv\";\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n    }\r\n  }\r\n\r\n  function GetCellValues(tableName) {\r\n    var table = document.getElementById(tableName);\r\n\r\n    var tableArray = [];\r\n    for (var r = 0, n = table.rows.length; r < n; r++) {\r\n      tableArray[r] = [];\r\n      for (var c = 0, m = table.rows[r].cells.length; c < m; c++) {\r\n        var text =\r\n          table.rows[r].cells[c].textContent ||\r\n          table.rows[r].cells[c].innerText;\r\n        tableArray[r][c] = text.trim();\r\n      }\r\n    }\r\n    return tableArray;\r\n  }\r\n\r\n  function ConvertToCsv(objArray) {\r\n    var array = typeof objArray != \"object\" ? JSON.parse(objArray) : objArray;\r\n    var str = \"sep=,\\r\\n\";\r\n    var line = \"\";\r\n    var index;\r\n    var value;\r\n    for (var i = 0; i < array.length; i++) {\r\n      line = \"\";\r\n      var array1 = array[i];\r\n      for (index in array1) {\r\n        if (array1.hasOwnProperty(index)) {\r\n          value = array1[index] + \"\";\r\n          line += '\"' + value.replace(/\"/g, '\"\"') + '\",';\r\n        }\r\n      }\r\n      line = line.slice(0, -1);\r\n      str += line + \"\\r\\n\";\r\n    }\r\n    return str;\r\n  }\r\n\r\n  function m_fnViewSitePermissionsGroup(groupID, groupName) {\r\n    ///The call back on this does not refresh the page BECAUSE if you add/remove a user on that dialog with the group users, it will try to refresh and it will look\r\n    //odd. so don't refresh here.\r\n    /*var options = SP.UI.$create_DialogOptions();\t\r\n\t\toptions.title = \"View Site Permissions on Group \" + groupName;\r\n\t\t//options.dialogReturnValueCallback = OnCallbackFormNoRefresh;\r\n\t\toptions.url = Audit.Common.Utilities.GetSiteUrl() + \"/_layouts/people.aspx?MembershipGroupId=\" + groupID;\r\n\r\n\t\tSP.UI.ModalDialog.showModalDialog(options);*/\r\n\r\n    //doing it this way instead because on add new user, it keeps redirecting to permissions page\r\n    var vPermGroup = window.open(\r\n      location.protocol +\r\n        \"//\" +\r\n        location.host +\r\n        Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/_layouts/people.aspx?MembershipGroupId=\" +\r\n        groupID +\r\n        \"&IsDlg=1\"\r\n    ); //pass isdlg so that it hides left nav\r\n    //vPermGroup.document.title = groupName;\r\n\r\n    setTimeout(function () {\r\n      vPermGroup.document.title = \"Group: \" + groupName;\r\n    }, 2000);\r\n  }\r\n\r\n  function m_fnViewEmailHistoryFolder() {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"View Email History\";\r\n    //options.height = \"600\";\r\n    //options.width = \"900\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/SitePages/AuditEmailHistory.aspx?RootFolder=\" +\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/Lists/\" +\r\n      Audit.Common.Utilities.GetListNameEmailHistory() +\r\n      \"/\" +\r\n      m_emailFolderName;\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnUploadPermissions() {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Upload Permissions\";\r\n    options.height = \"800\";\r\n    options.autoSize = true;\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/SitePages/AuditUpdateSiteGroups.aspx\";\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function OnCallbackFormNoRefresh(result, value) {\r\n    //do nothing\r\n  }\r\n\r\n  function OnCallbackFormAutoRefresh(result, value) {\r\n    m_fnRefresh();\r\n  }\r\n\r\n  function OnCallbackForm(result, value) {\r\n    if (result === SP.UI.DialogResult.OK) {\r\n      m_fnRefresh();\r\n    }\r\n  }\r\n\r\n  var publicMembers = {\r\n    GoToRequest: function (requestNum) {\r\n      m_fnGoToRequest(requestNum);\r\n    },\r\n    GoToResponse: function (responseTitle) {\r\n      m_fnGoToResponse(responseTitle);\r\n    },\r\n    ViewSitePermissionsGroup: function (groupID, groupName) {\r\n      m_fnViewSitePermissionsGroup(groupID, groupName);\r\n    },\r\n    GetEmailText: function () {\r\n      m_txtOutgoingEmailText = $(\"#txtOutgoingEmailText\").val();\r\n      /*if( $.trim(m_txtOutgoingEmailText) == \"\" )\r\n\t\t\t\t$(\"#btnClientOk1\").attr(\"disabled\",\"disabled\");\r\n\t\t\telse\r\n\t\t\t\t$(\"#btnClientOk1\").removeAttr(\"disabled\");*/\r\n      return m_txtOutgoingEmailText;\r\n    },\r\n    Refresh: m_fnRefresh,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n"],
  "mappings": ";;AAAC,MAAM,OAAO,OAAO;AAEd,MAAM,sBAAsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;A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",
  "names": ["onUpdateAOPermsSucceeded", "onUpdateAOPermsFailed", "roleDefBindingCollRestrictedContribute", "data", "html", "notifyId", "doneLoadingSPGroupPermissions", "m_arrResponseFolders", "m_txtOutgoingEmailText", "sender", "args", "html"]
}
