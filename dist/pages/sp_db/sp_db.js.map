{
  "version": 3,
  "sources": ["../../../src/pages/sp_db/SP_DB_Template.js", "../../../src/common/utilities.js", "../../../src/pages/sp_db/sp_db.js"],
  "sourcesContent": ["\uFEFFconst html = String.raw;\r\n\r\nexport const spDbTemplate = html`\r\n  <div class=\"audit\">\r\n    <iframe id=\"CsvExpFrame\" style=\"display: none\"></iframe>\r\n\r\n    <div\r\n      id=\"divCounter\"\r\n      style=\"display: none\"\r\n      title=\"used to auto refresh the page\"\r\n    >\r\n      600\r\n    </div>\r\n\r\n    <div style=\"padding-bottom: 10px; display: none\" id=\"divRefresh\">\r\n      <a\r\n        title=\"Refresh this page\"\r\n        href=\"javascript:void(0)\"\r\n        onclick=\"Audit.SPReport.Report.Refresh()\"\r\n        ><span class=\"ui-icon ui-icon-refresh\"></span>Refresh</a\r\n      >\r\n    </div>\r\n\r\n    <div id=\"divLoading\" style=\"color: green; padding-bottom: 10px\">\r\n      Please Wait... Loading\r\n    </div>\r\n\r\n    <div id=\"tabs\" style=\"display: none; margin-top: 20px\">\r\n      <ul>\r\n        <li><a href=\"#tabs-0\">Status Report</a></li>\r\n        <li><a href=\"#tabs-1\">Responses</a></li>\r\n      </ul>\r\n      <div id=\"tabs-0\">\r\n        <div\r\n          id=\"lblStatusReportResponsesMsg\"\r\n          style=\"padding-top: 5px; color: green\"\r\n          data-bind=\"visible: arrResponses().length == 0\"\r\n        >\r\n          <span class=\"ui-icon ui-icon-info\"></span>There are 0 responses for\r\n          your review\r\n        </div>\r\n        <div\r\n          id=\"divButtons\"\r\n          style=\"padding-top: 3px\"\r\n          data-bind=\"visible: arrResponses().length > 0\"\r\n        >\r\n          <a\r\n            id=\"btnPrint1\"\r\n            title=\"Click here to Print\"\r\n            href=\"javascript:void(0)\"\r\n            class=\"hideOnPrint\"\r\n            ><span class=\"ui-icon ui-icon-print\">Print</span></a\r\n          >\r\n          <a class=\"export1 hideOnPrint\" title=\"Export to CSV\" href=\"#\"\r\n            ><span class=\"ui-icon ui-icon-disk\">Export to CSV</span></a\r\n          >\r\n          <a\r\n            id=\"btnViewAll\"\r\n            title=\"View All\"\r\n            href=\"javascript:void(0)\"\r\n            data-bind=\"visible: arrFilteredResponsesCount() < arrResponses().length, click: ClearFilters\"\r\n            ><span class=\"ui-icon ui-icon-circle-zoomout\"></span>View All\r\n            Responses</a\r\n          >\r\n        </div>\r\n\r\n        <div id=\"divStatusReportRespones\">\r\n          <table\r\n            id=\"tblStatusReportResponses\"\r\n            class=\"tablesorter report\"\r\n            data-bind=\"visible: arrResponses().length > 0\"\r\n          >\r\n            <thead>\r\n              <tr\r\n                valign=\"top\"\r\n                class=\"rowFilters\"\r\n                data-bind=\"visible: arrResponses().length > 0\"\r\n              >\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                  <select\r\n                    id=\"ddlResponseRequestID\"\r\n                    data-bind=\"options: GetDistinctResponsesDDVals('reqNumber'), value: filterRequestID, optionsCaption: '-Select-', event:{ change: FilterChanged}\"\r\n                  ></select>\r\n                </th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                  <select\r\n                    id=\"ddlResponseRequestStatus\"\r\n                    data-bind=\"options: GetDistinctResponsesDDVals('requestStatus'), value: filterRequestStatus, optionsCaption: '-Select-', event:{ change: FilterChanged}\"\r\n                  ></select>\r\n                </th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                  <select\r\n                    id=\"ddlResponseRequestInternalDueDate\"\r\n                    data-bind=\"options: GetDistinctResponsesDDVals('internalDueDate'), value: filterRequestIntDueDate, optionsCaption: '-Select-', event:{ change: FilterChanged}\"\r\n                  ></select>\r\n                </th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                  <select\r\n                    id=\"ddlResponseSampleNum\"\r\n                    data-bind=\"options: GetDistinctResponsesDDVals('sample'), value: filterSampleNum, optionsCaption: '-Select-', event:{ change: FilterChanged}\"\r\n                  ></select>\r\n                </th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                  <select\r\n                    id=\"ddlResponseName\"\r\n                    data-bind=\"options: GetDistinctResponsesDDVals('title'), value: filterResponseName, optionsCaption: '-Select-', event:{ change: FilterChanged}\"\r\n                  ></select>\r\n                </th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\">\r\n                  <select\r\n                    id=\"ddlResponseStatus\"\r\n                    data-bind=\"options: GetDistinctResponsesDDVals('status'), value: filterResponseStatus, optionsCaption: '-Select-', event:{ change: FilterChanged}\"\r\n                  ></select>\r\n                </th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n                <th class=\"sorter-false\" nowrap=\"nowrap\"></th>\r\n              </tr>\r\n              <tr valign=\"top\">\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Request #</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Request Status</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Internal Due Date</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Sample #</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Response Name</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Status</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\"># of Documents</th>\r\n                <th class=\"sorter-true\" nowrap=\"nowrap\">Modified</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody id=\"fbody\" data-bind=\"foreach: arrResponses\">\r\n              <tr class=\"sr-response-item\" data-bind=\"visible: visibleRow\">\r\n                <td class=\"sr-response-requestNum\">\r\n                  <span data-bind=\"text: reqNumber\"></span>\r\n                </td>\r\n                <td class=\"sr-response-requestStatus\">\r\n                  <span data-bind=\"text: requestStatus\"></span>\r\n                </td>\r\n                <td class=\"sr-response-internalDueDate\">\r\n                  <span data-bind=\"text: internalDueDate\"></span>\r\n                </td>\r\n                <td class=\"sr-response-sample\">\r\n                  <span data-bind=\"text: sample\"></span>\r\n                </td>\r\n                <td class=\"sr-response-title\">\r\n                  <a\r\n                    href=\"javascript:void(0);\"\r\n                    title=\"Go to Response Details\"\r\n                    data-bind=\"click: $parent.GoToResponse\"\r\n                    ><span data-bind=\"text: title\"></span\r\n                  ></a>\r\n                </td>\r\n                <td class=\"sr-response-status\">\r\n                  <span data-bind=\"text: status\"></span>\r\n                </td>\r\n                <td class=\"sr-response-docCount\">\r\n                  <span data-bind=\"text: docCount\"></span>\r\n                </td>\r\n                <td class=\"sr-response-modified\">\r\n                  <span data-bind=\"text: modified\"></span>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n            <tfoot class=\"footer\">\r\n              <tr>\r\n                <th colspan=\"8\">\r\n                  Displaying\r\n                  <span\r\n                    id=\"spanResponsesDisplayedTotal\"\r\n                    style=\"color: green\"\r\n                    data-bind=\"text: arrFilteredResponsesCount()\"\r\n                    >0</span\r\n                  >\r\n                  out of\r\n                  <span\r\n                    style=\"color: green\"\r\n                    data-bind=\"text: arrResponses().length\"\r\n                  ></span>\r\n                  Responses\r\n                </th>\r\n              </tr>\r\n            </tfoot>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      <div id=\"tabs-1\">\r\n        <div style=\"padding-bottom: 15px\">\r\n          <table>\r\n            <tr>\r\n              <td><span>Responses:</span></td>\r\n              <td>\r\n                <select\r\n                  id=\"ddlResponses\"\r\n                  data-bind=\"options: GetDistinctResponsesDDVals('title'), value: filterResponseName2, optionsCaption: '-Select-'\"\r\n                ></select>\r\n              </td>\r\n            </tr>\r\n          </table>\r\n        </div>\r\n\r\n        <div id=\"divResponseInfo\" data-bind=\"with: currentResponse\">\r\n          <fieldset>\r\n            <legend>Response Information</legend>\r\n            <table id=\"tblResponseInfo\" class=\"tablesorter\">\r\n              <tbody>\r\n                <tr>\r\n                  <td>Request #</td>\r\n                  <td>\r\n                    <span id=\"requestInfoNum\" data-bind=\"text: number\"></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Request Status</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"requestInfoStatus\"\r\n                      data-bind=\"text: $parent.currentResponseRequestStatus, style: { color: $parent.currentResponseRequestStatusStyle }\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Subject</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"requestInfoSub\"\r\n                      data-bind=\"text: request.subject\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Due Date</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"requestInfoInternalDueDate\"\r\n                      data-bind=\"text: request.internalDueDate\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Sample?</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"requestInfoSample\"\r\n                      data-bind=\"text: request.sample, css: request.sample == true ? 'ui-icon ui-icon-check' : 'ui-icon ui-icon-close'\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Response</td>\r\n                  <td>\r\n                    <span id=\"responseInfoName\" data-bind=\"text: title\"></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Response Status</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"responseInfoStatus\"\r\n                      data-bind=\"text: $parent.currentResponseStatus, style: { color:  resStatus == '7-Closed' ? 'red' : 'green' }\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Sample #</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"responseInfoSampleNum\"\r\n                      data-bind=\"text: sample\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Action Office</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"responseInfoAO\"\r\n                      data-bind=\"text: actionOffice\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Related Audit</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"requestInfoRelatedAudit\"\r\n                      data-bind=\"text: request.relatedAudit\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Action Items</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"requestInfoActionItems\"\r\n                      data-bind=\"html: request.actionItems \"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n                <tr>\r\n                  <td>Comments</td>\r\n                  <td>\r\n                    <span\r\n                      id=\"responseInfoComments\"\r\n                      data-bind=\"html: comments\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </fieldset>\r\n        </div>\r\n\r\n        <div id=\"divCoverSheets\" data-bind=\"visible: currentResponse\">\r\n          <fieldset>\r\n            <legend>Cover Sheets/Supplemental Documents</legend>\r\n            <div\r\n              id=\"divEmptyCoversheetsMsg\"\r\n              style=\"border: 0px !important; font-style: italic\"\r\n              data-bind=\"visible: arrCoverSheets().length <= 0\"\r\n            >\r\n              There are 0 cover sheets or supplemental documents\r\n            </div>\r\n            <table\r\n              id=\"tblCoverSheets\"\r\n              class=\"tablesorter report\"\r\n              data-bind=\"visible: arrCoverSheets().length > 0\"\r\n            >\r\n              <thead>\r\n                <tr valign=\"top\">\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Name</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody data-bind=\"foreach: arrCoverSheets\">\r\n                <tr class=\"coversheet-item\">\r\n                  <td class=\"coversheet-title\" title=\"Click to Download\">\r\n                    <a\r\n                      data-bind=\"attr: { href: 'javascript:void(0)', onclick: link}\"\r\n                      ><span data-bind=\"text: title\"></span\r\n                    ></a>\r\n                  </td>\r\n                </tr>\r\n              </tbody>\r\n              <tfoot>\r\n                <tr valign=\"top\">\r\n                  <th nowrap=\"nowrap\">\r\n                    Total:\r\n                    <span\r\n                      id=\"tblCoverSheetsTotal\"\r\n                      data-bind=\"text: arrCoverSheets().length\"\r\n                      >0</span\r\n                    >\r\n                  </th>\r\n                </tr>\r\n              </tfoot>\r\n            </table>\r\n          </fieldset>\r\n        </div>\r\n\r\n        <div id=\"divResponseDocs\" data-bind=\"visible: currentResponse\">\r\n          <fieldset>\r\n            <legend>Response Documents</legend>\r\n            <div\r\n              id=\"divEmptyResponseDocsMsg\"\r\n              style=\"border: 0px !important; font-style: italic\"\r\n              data-bind=\"visible: arrResponseDocs().length <= 0\"\r\n            >\r\n              There are 0 response documents\r\n            </div>\r\n            <table\r\n              id=\"tblResponseDocs\"\r\n              class=\"tablesorter report\"\r\n              data-bind=\"visible: arrResponseDocs().length > 0\"\r\n            >\r\n              <thead>\r\n                <tr valign=\"top\">\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Type</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Name</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Receipt Date</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">File Size</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Checked Out</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Status</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Reason</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Modified</th>\r\n                  <th class=\"sorter-false\" nowrap=\"nowrap\">Modified By</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody\r\n                data-bind=\"foreach: { data: arrResponseDocs, as: 'responseDocSummary'} \"\r\n              >\r\n                <tr class=\"requestInfo-response-doc\">\r\n                  <td colspan=\"10\">\r\n                    <img\r\n                      style=\"background-color: transparent\"\r\n                      src=\"/_layouts/images/minus.gif\"\r\n                      title=\"Expand/Collapse\"\r\n                    /><span\r\n                      data-bind=\"text: responseDocSummary.responseTitle\"\r\n                    ></span>\r\n                  </td>\r\n                </tr>\r\n\r\n                <!-- ko foreach: responseDocSummary.responseDocs-->\r\n\r\n                <tr\r\n                  class=\"requestInfo-response-doc-item\"\r\n                  data-bind=\"style: styleTag\"\r\n                >\r\n                  <td>\r\n                    <img\r\n                      data-bind=\"attr:{ src: $parent.siteUrl + '/_layouts/images/' + docIcon}\"\r\n                    />\r\n                  </td>\r\n                  <td\r\n                    class=\"requestInfo-response-doc-title\"\r\n                    title=\"Click to Download\"\r\n                  >\r\n                    <a\r\n                      data-bind=\"attr: { href: 'javascript:void(0)', onclick: link}\"\r\n                      ><span data-bind=\"text: title\"></span\r\n                    ></a>\r\n                  </td>\r\n                  <td nowrap data-bind=\"text: receiptDate\"></td>\r\n                  <td nowrap data-bind=\"text: fileSize\"></td>\r\n                  <td nowrap data-bind=\"text: checkedOutBy\"></td>\r\n                  <td nowrap data-bind=\"text: documentStatus\"></td>\r\n                  <td nowrap data-bind=\"text: rejectReason\"></td>\r\n                  <td\r\n                    class=\"requestInfo-response-doc-modified\"\r\n                    data-bind=\"text: modifiedDate\"\r\n                  ></td>\r\n                  <td\r\n                    class=\"requestInfo-response-doc-modifiedBy\"\r\n                    data-bind=\"text: modifiedBy\"\r\n                  ></td>\r\n                </tr>\r\n\r\n                <!-- /ko -->\r\n              </tbody>\r\n              <tfoot>\r\n                <tr valign=\"top\">\r\n                  <th colspan=\"9\" nowrap=\"nowrap\">\r\n                    Total:\r\n                    <span\r\n                      id=\"tblResponseDocsTotal\"\r\n                      data-bind=\"text: cntResponseDocs\"\r\n                      >0</span\r\n                    >\r\n                  </th>\r\n                </tr>\r\n              </tfoot>\r\n            </table>\r\n          </fieldset>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div id=\"divTest\"></div>\r\n  </div>\r\n`;\r\n", "\uFEFFwindow.Audit = window.Audit || {};\r\nAudit.Common = Audit.Common || {};\r\n\r\nfunction InitReport() {\r\n  Audit.Common.Utilities = new Audit.Common.NewUtilities();\r\n  Audit.Common.Init();\r\n}\r\n\r\nAudit.Common.Init = function () {};\r\n\r\nAudit.Common.NewUtilities = function () {\r\n  var m_siteUrl = _spPageContextInfo.webServerRelativeUrl; //IE11 in sp 2013 does not recognize L_Menu_BaseUrl\r\n\r\n  var m_listTitleRequests = \"AuditRequests\";\r\n  var m_listNameRequests = \"AuditRequests\";\r\n\r\n  var m_listTitleRequestsInternal = \"AuditRequestsInternal\";\r\n  var m_listNameRequestsInternal = \"AuditRequestsInternal\";\r\n\r\n  var m_listTitleResponses = \"AuditResponses\";\r\n  var m_listNameResponses = \"AuditResponses\";\r\n\r\n  var m_libTitleRequestDocs = \"AuditRequestDocs\";\r\n  var m_libNameRequestDocs = \"AuditRequestDocs\";\r\n\r\n  var m_libTitleCoverSheet = \"AuditCoverSheets\";\r\n  var m_libNameCoverSheet = \"AuditCoverSheets\";\r\n\r\n  var m_libTitleResponseDocs = \"AuditResponseDocs\";\r\n  var m_libNameResponseDocs = \"AuditResponseDocs\";\r\n\r\n  var m_libTitleResponseDocsEA = \"AuditResponseDocsEA\";\r\n  var m_libNameResponseDocsEA = \"AuditResponseDocsEA\";\r\n\r\n  var m_listTitleActionOffices = \"AuditOrganizations\";\r\n  var m_listNameActionOffices = \"AuditOrganizations\";\r\n\r\n  var m_listTitleEmailHistory = \"AuditEmails\";\r\n  var m_listNameEmailHistory = \"AuditEmails\";\r\n\r\n  var m_listTitleBulkResponses = \"AuditBulkResponses\";\r\n  var m_listNameBulkResponses = \"AuditBulkResponses\";\r\n\r\n  var m_listTitleBulkPermissions = \"AuditBulkPermissions\";\r\n  var m_listNameBulkPermissions = \"AuditBulkPermissions\";\r\n\r\n  var m_groupNameSpecialPermName1 = \"CGFS Special Access1\";\r\n  var m_groupNameSpecialPermName2 = \"CGFS Special Access2\";\r\n  var m_groupNameQA = \"Quality Assurance\";\r\n  var m_groupNameEA = \"External Auditors\";\r\n\r\n  var m_libResponseDocsLibraryGUID = null;\r\n\r\n  var m_arrSiteGroups = null;\r\n  var m_arrAOs = null;\r\n  /**\r\n   * Reloads the page, trys to preserve current path\r\n   * @param {bool} hard flag to remove all url params\r\n   * @returns\r\n   */\r\n  function m_fnRefresh(hard = false) {\r\n    if (hard) {\r\n      location.href = location.pathname;\r\n      return;\r\n    }\r\n    var curPath = location.pathname;\r\n\r\n    if ($(\"#tabs\").html() != null && $(\"#tabs\").html() != \"\") {\r\n      var tabIndex = 0;\r\n      try {\r\n        tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n      } catch (ex) {}\r\n\r\n      curPath += \"?Tab=\" + tabIndex;\r\n\r\n      if (tabIndex == 0 && $(\"#ddlResponseName\").val() != \"\") {\r\n        curPath += \"&ResNum=\" + $(\"#ddlResponseName\").val();\r\n      } else if (tabIndex == 1) {\r\n        var responseNumOpen = $(\"#ddlResponsesOpen\").val();\r\n        var responseNumProcessed = $(\"#ddlResponsesProcessed\").val();\r\n\r\n        if (responseNumOpen != null && responseNumOpen != \"\")\r\n          curPath += \"&ResNum=\" + responseNumOpen;\r\n        else if (responseNumProcessed != null && responseNumProcessed != \"\")\r\n          curPath += \"&ResNum=\" + responseNumProcessed;\r\n      }\r\n\r\n      location.href = curPath;\r\n    } else {\r\n      location.reload();\r\n    }\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTimeStamp() {\r\n    var curDate = new Date();\r\n    $(\"#divLoading\").text(\"Loaded at \" + curDate.format(\"MM/dd/yyyy hh:mm tt\"));\r\n  }\r\n\r\n  function m_fnOnLoadDisplayTabAndResponse() {\r\n    var paramTabIndex = GetUrlKeyValue(\"Tab\");\r\n    if (paramTabIndex != null && paramTabIndex != \"\") {\r\n      $(\"#tabs\").tabs(\"option\", \"active\", paramTabIndex);\r\n    }\r\n\r\n    var bFiltered = false;\r\n\r\n    var paramResponseNum = GetUrlKeyValue(\"ResNum\");\r\n    if (paramResponseNum != null && paramResponseNum != \"\") {\r\n      if (paramTabIndex == 0) {\r\n        if (\r\n          $(\"#ddlResponseName option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponseName\").val(paramResponseNum).change();\r\n          bFiltered = true;\r\n        }\r\n      } else {\r\n        if (\r\n          $(\"#ddlResponsesOpen option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponsesOpen\").val(paramResponseNum).change();\r\n        } else if (\r\n          $(\"#ddlResponsesProcessed option[value='\" + paramResponseNum + \"']\")\r\n            .length > 0\r\n        ) {\r\n          $(\"#ddlResponsesProcessed\").val(paramResponseNum).change();\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!bFiltered) {\r\n      $(\".sr-response-item\").show(); //hiding rows by default\r\n    }\r\n  }\r\n\r\n  function m_fnOnLoadFilterResponses(responseStatus1, responseStatus2) {\r\n    var count = 0;\r\n    var cntOpen = 0;\r\n    var cntReOpened = 0;\r\n    var resStatus1 = 0;\r\n    var resStatus2 = 0;\r\n\r\n    var eacher = $(\".sr-response-item\");\r\n\r\n    eacher.each(function () {\r\n      var reqStatus = $.trim($(this).find(\".sr-response-requestStatus\").text());\r\n      var resStatus = $.trim($(this).find(\".sr-response-status\").text());\r\n\r\n      if (\r\n        (resStatus == responseStatus1 || resStatus == responseStatus2) &&\r\n        (reqStatus == \"Open\" || reqStatus == \"ReOpened\")\r\n      ) {\r\n        $(this).addClass(\"highlighted\");\r\n        count++;\r\n\r\n        if (resStatus == responseStatus1) resStatus1++;\r\n        else if (resStatus == responseStatus2) resStatus2++;\r\n\r\n        if (reqStatus == \"Open\") cntOpen++;\r\n        else if (reqStatus == \"ReOpened\") cntReOpened++;\r\n      }\r\n    });\r\n\r\n    if (count > 0) {\r\n      $(\"#lblStatusReportResponsesMsg\").html(\r\n        \"<span class='ui-icon ui-icon-alert'></span>There are \" +\r\n          count +\r\n          \" Responses pending your review\"\r\n      );\r\n\r\n      if (resStatus1 > 0 && resStatus2 == 0)\r\n        $(\"#ddlResponseStatus\").val(responseStatus1).change();\r\n      else if (resStatus2 > 0 && resStatus1 == 0)\r\n        $(\"#ddlResponseStatus\").val(responseStatus2).change();\r\n    } else\r\n      $(\"#lblStatusReportResponsesMsg\").html(\r\n        \"<span class='ui-icon ui-icon-circle-check'></span>There are 0 Responses pending your review\"\r\n      );\r\n  }\r\n\r\n  function m_fnLoadSiteGroups(itemColl) {\r\n    m_arrSiteGroups = new Array();\r\n\r\n    var listItemEnumerator = itemColl.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_id();\r\n      var loginName = oListItem.get_loginName();\r\n      var title = oListItem.get_title();\r\n\r\n      var groupObject = new Object();\r\n      groupObject[\"ID\"] = id;\r\n      groupObject[\"loginName\"] = loginName;\r\n      groupObject[\"title\"] = title;\r\n      groupObject[\"group\"] = oListItem;\r\n\r\n      m_arrSiteGroups.push(groupObject);\r\n    }\r\n  }\r\n\r\n  function m_fnGetSPSiteGroup(groupName) {\r\n    var userGroup = null;\r\n    if (m_arrSiteGroups != null) {\r\n      for (var x = 0; x < m_arrSiteGroups.length; x++) {\r\n        if (m_arrSiteGroups[x].title == groupName) {\r\n          userGroup = m_arrSiteGroups[x].group;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return userGroup;\r\n  }\r\n\r\n  function m_fnLoadActionOffices(itemColl) {\r\n    m_arrAOs = new Array();\r\n\r\n    var listItemEnumerator = itemColl.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var title = oListItem.get_item(\"Title\");\r\n      var userGroup = oListItem.get_item(\"UserGroup\");\r\n      if (userGroup != null) {\r\n        userGroup = userGroup.get_lookupValue();\r\n      } else userGroup = \"\";\r\n\r\n      var aoObject = new Object();\r\n      aoObject[\"ID\"] = id;\r\n      aoObject[\"title\"] = title;\r\n      aoObject[\"userGroup\"] = userGroup;\r\n\r\n      m_arrAOs.push(aoObject);\r\n    }\r\n  }\r\n\r\n  function m_fnGetAOSPGroupName(groupName) {\r\n    //finds the group name corresponding to the lookup field selected\r\n    var userGroup = null;\r\n    if (m_arrAOs != null) {\r\n      for (var x = 0; x < m_arrAOs.length; x++) {\r\n        var oGroup = m_arrAOs[x];\r\n        if (oGroup.title == groupName) {\r\n          userGroup = oGroup.userGroup;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return userGroup;\r\n  }\r\n\r\n  function m_fnCheckSPItemHasGroupPermission(item, groupName, permissionLevel) {\r\n    if (\r\n      item == null ||\r\n      groupName == \"\" ||\r\n      groupName == null ||\r\n      permissionLevel == null\r\n    )\r\n      return false;\r\n\r\n    var match = false;\r\n    var roleAssignments = item.get_roleAssignments();\r\n    if (roleAssignments == null) {\r\n      alert(\"Error retrieving role assignments\");\r\n      return false;\r\n    }\r\n\r\n    var rolesEnumerator = roleAssignments.getEnumerator();\r\n    while (rolesEnumerator.moveNext()) {\r\n      var role = rolesEnumerator.get_current();\r\n      if (role != null) {\r\n        var roleMember = role.get_member();\r\n        if (roleMember.isPropertyAvailable(\"Title\")) {\r\n          var memberTitleName = roleMember.get_title();\r\n\r\n          var roleDefs = role.get_roleDefinitionBindings();\r\n          if (roleDefs != null) {\r\n            var roleDefsEnumerator = roleDefs.getEnumerator();\r\n            while (roleDefsEnumerator.moveNext()) {\r\n              var rd = roleDefsEnumerator.get_current();\r\n              var rdName = rd.get_name();\r\n\r\n              if (\r\n                memberTitleName == groupName &&\r\n                rd.get_basePermissions().has(permissionLevel)\r\n              ) {\r\n                match = true;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return match;\r\n  }\r\n\r\n  function m_fnGoToResponse(responseTitle, isIA) {\r\n    if (!isIA) {\r\n      var bFound = false;\r\n      $(\"#ddlResponsesOpen > option\").each(function () {\r\n        if ($(this).text() == responseTitle) {\r\n          bFound = true;\r\n          notifyId = SP.UI.Notify.addNotification(\r\n            \"Displaying Response (\" + responseTitle + \")\",\r\n            false\r\n          );\r\n          $(\"#ddlResponsesOpen\").val(responseTitle).change();\r\n\r\n          return false;\r\n        }\r\n      });\r\n      if (!bFound) {\r\n        $(\"#ddlResponsesProcessed > option\").each(function () {\r\n          if ($(this).text() == responseTitle) {\r\n            bFound = true;\r\n            notifyId = SP.UI.Notify.addNotification(\r\n              \"Displaying Response (\" + responseTitle + \")\",\r\n              false\r\n            );\r\n            $(\"#ddlResponsesProcessed\").val(responseTitle).change();\r\n\r\n            return false;\r\n          }\r\n        });\r\n      }\r\n\r\n      $(\"#tabs\").tabs({ active: 1 });\r\n    }\r\n  }\r\n\r\n  function m_fnGetResponseDocStyleTag2(documentStatus) {\r\n    var styleTag = {};\r\n    if (documentStatus == \"Archived\")\r\n      styleTag = { \"background-color\": \"Gainsboro\" };\r\n    else if (documentStatus == \"Approved\")\r\n      styleTag = { \"background-color\": \"PaleGreen\" };\r\n    else if (documentStatus == \"Rejected\")\r\n      styleTag = { \"background-color\": \"LightSalmon\" };\r\n    else if (documentStatus == \"Sent to QA\")\r\n      styleTag = { \"background-color\": \"LightCyan\" };\r\n    else if (documentStatus == \"Submitted\")\r\n      styleTag = { \"background-color\": \"LemonChiffon\" };\r\n    else if (documentStatus == \"Marked for Deletion\")\r\n      styleTag = {\r\n        \"background-color\": \"Gainsboro\",\r\n        \"font-style\": \"italic\",\r\n      };\r\n    return styleTag;\r\n    //\t\t\tstyleTag = \" style='background-color:Gainsboro; font-style:italic' title='Marked for Deletion by the Action Office' \";\r\n  }\r\n\r\n  function m_fnGetResponseDocStyleTag(documentStatus) {\r\n    var styleTag = \"\";\r\n\r\n    if (documentStatus == \"Archived\")\r\n      styleTag = \" style='background-color:Gainsboro;' \";\r\n    else if (documentStatus == \"Approved\")\r\n      styleTag = \" style='background-color:PaleGreen;' \";\r\n    else if (documentStatus == \"Rejected\")\r\n      styleTag = \" style='background-color:LightSalmon;' \";\r\n    else if (documentStatus == \"Sent to QA\")\r\n      styleTag = \" style='background-color:LightCyan;' \";\r\n    else if (documentStatus == \"Submitted\")\r\n      styleTag = \" style='background-color:LemonChiffon;' \";\r\n    else if (documentStatus == \"Marked for Deletion\")\r\n      styleTag =\r\n        \" style='background-color:Gainsboro; font-style:italic' title='Marked for Deletion by the Action Office' \";\r\n\r\n    return styleTag;\r\n  }\r\n\r\n  function m_fnCheckIfEmailFolderExists(items, requestNumber) {\r\n    //Check if folder exists in email library\r\n    var bFolderExists = false;\r\n    var listItemEnumerator = items.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var folderItem = listItemEnumerator.get_current();\r\n      var itemName = folderItem.get_displayName();\r\n      if (itemName == requestNumber) {\r\n        var bFolderExists = true;\r\n        break;\r\n      }\r\n    }\r\n    return bFolderExists;\r\n  }\r\n\r\n  var m_cntAddToEmailFolder = 0;\r\n  var m_cntAddedToEmailFolder = 0;\r\n\r\n  function m_fnCreateEmailFolder(list, requestNumber, requestItem, OnComplete) {\r\n    m_cntAddToEmailFolder = 0;\r\n    m_cntAddedToEmailFolder = 0;\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var itemCreateInfo = new SP.ListItemCreationInformation();\r\n    itemCreateInfo.set_underlyingObjectType(SP.FileSystemObjectType.folder);\r\n    itemCreateInfo.set_leafName(requestNumber);\r\n    oNewEmailFolder = list.addItem(itemCreateInfo);\r\n    oNewEmailFolder.set_item(\"Title\", requestNumber);\r\n    oNewEmailFolder.update();\r\n\r\n    this.currentUser = web.get_currentUser();\r\n    this.ownerGroup = web.get_associatedOwnerGroup();\r\n    this.memberGroup = web.get_associatedMemberGroup();\r\n    this.visitorGroup = web.get_associatedVisitorGroup();\r\n\r\n    oNewEmailFolder.resetRoleInheritance();\r\n    oNewEmailFolder.breakRoleInheritance(false, false);\r\n\r\n    var roleDefBindingCollAdmin =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollAdmin.add(\r\n      web.get_roleDefinitions().getByType(SP.RoleType.administrator)\r\n    );\r\n\r\n    var roleDefBindingCollContribute =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollContribute.add(\r\n      web.get_roleDefinitions().getByType(SP.RoleType.contributor)\r\n    );\r\n\r\n    var roleDefBindingCollRestrictedRead =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollRestrictedRead.add(\r\n      web.get_roleDefinitions().getByName(\"Restricted Read\")\r\n    );\r\n\r\n    var roleDefBindingCollRestrictedContribute =\r\n      SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n    roleDefBindingCollRestrictedContribute.add(\r\n      web.get_roleDefinitions().getByName(\"Restricted Contribute\")\r\n    );\r\n\r\n    //add associated site groups\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(ownerGroup, roleDefBindingCollAdmin);\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(memberGroup, roleDefBindingCollContribute);\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .add(visitorGroup, roleDefBindingCollRestrictedRead);\r\n\r\n    var spGroupQA = Audit.Common.Utilities.GetSPSiteGroup(\r\n      Audit.Common.Utilities.GetGroupNameQA()\r\n    );\r\n    if (spGroupQA != null)\r\n      oNewEmailFolder\r\n        .get_roleAssignments()\r\n        .add(spGroupQA, roleDefBindingCollRestrictedContribute);\r\n\r\n    oNewEmailFolder\r\n      .get_roleAssignments()\r\n      .getByPrincipal(currentUser)\r\n      .deleteObject();\r\n\r\n    //Need to break up adding AOs because it exceeds the resource limit (request uses too many resources)\r\n    function onUpdatePermsSucceeded() {\r\n      if (this.requestItem) {\r\n        //this will be null when sending from permissions page\r\n        //add action offices\r\n        var arrActionOffice = this.requestItem.get_item(\"ActionOffice\");\r\n        if (arrActionOffice == null || arrActionOffice.length == 0) {\r\n          if (this.OnComplete) this.OnComplete(true);\r\n          return;\r\n        }\r\n\r\n        for (var x = 0; x < arrActionOffice.length; x++) {\r\n          var actionOfficeName = arrActionOffice[x].get_lookupValue();\r\n\r\n          var actionOfficeGroupName =\r\n            Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n          var actionOfficeGroup = Audit.Common.Utilities.GetSPSiteGroup(\r\n            actionOfficeGroupName\r\n          );\r\n\r\n          if (actionOfficeGroup != null) {\r\n            m_cntAddToEmailFolder++;\r\n\r\n            var currCtx2 = new SP.ClientContext.get_current();\r\n            var web2 = currCtx2.get_web();\r\n\r\n            var roleDefBindingCollRestrictedContribute =\r\n              SP.RoleDefinitionBindingCollection.newObject(currCtx2);\r\n            roleDefBindingCollRestrictedContribute.add(\r\n              web2.get_roleDefinitions().getByName(\"Restricted Contribute\")\r\n            );\r\n\r\n            this.oNewEmailFolder\r\n              .get_roleAssignments()\r\n              .add(actionOfficeGroup, roleDefBindingCollRestrictedContribute);\r\n\r\n            function onUpdateAOPermsSucceeded() {\r\n              m_cntAddedToEmailFolder++;\r\n              if (m_cntAddedToEmailFolder == m_cntAddToEmailFolder) {\r\n                if (this.OnComplete) this.OnComplete(true);\r\n              }\r\n            }\r\n            function onUpdateAOPermsFailed(sender, args) {\r\n              m_cntAddedToEmailFolder++;\r\n              if (m_cntAddedToEmailFolder == m_cntAddToEmailFolder) {\r\n                if (this.OnComplete) this.OnComplete(true);\r\n              }\r\n            }\r\n            var data = { OnComplete: this.OnComplete };\r\n            currCtx2.executeQueryAsync(\r\n              Function.createDelegate(data, onUpdateAOPermsSucceeded),\r\n              Function.createDelegate(data, onUpdateAOPermsFailed)\r\n            );\r\n          }\r\n        }\r\n      } else {\r\n        if (this.OnComplete) this.OnComplete(true);\r\n      }\r\n    }\r\n\r\n    function onUpdatePermsFailed(sender, args) {\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n    }\r\n\r\n    var data = {\r\n      /*item: oListItem, */ requestItem: requestItem,\r\n      oNewEmailFolder: oNewEmailFolder,\r\n      OnComplete: OnComplete,\r\n    };\r\n    currCtx.executeQueryAsync(\r\n      Function.createDelegate(data, onUpdatePermsSucceeded),\r\n      Function.createDelegate(data, onUpdatePermsFailed)\r\n    );\r\n  }\r\n\r\n  function m_fnSortResponseTitleNoCase(a, b) {\r\n    var aTitle = a;\r\n    var bTitle = b;\r\n    let newA, newB;\r\n\r\n    if (aTitle == null) aTitle = \"\";\r\n    if (bTitle == null) bTitle = \"\";\r\n\r\n    var aIndex = aTitle.lastIndexOf(\"-\");\r\n    if (aIndex >= 0) {\r\n      var subA = aTitle.substring(0, aIndex + 1);\r\n      var lastA = aTitle.replace(subA, \"\");\r\n      var intA = parseInt(lastA, 10);\r\n      var newIntA = Audit.Common.Utilities.PadDigits(intA, 5);\r\n      newA = subA + newIntA;\r\n    } else newA = aTitle;\r\n\r\n    var bIndex = bTitle.lastIndexOf(\"-\");\r\n    if (bIndex >= 0) {\r\n      var subB = bTitle.substring(0, bIndex + 1);\r\n      var lastB = bTitle.replace(subB, \"\");\r\n      var intB = parseInt(lastB, 10);\r\n      var newIntB = Audit.Common.Utilities.PadDigits(intB, 5);\r\n      newB = subB + newIntB;\r\n    } else newB = bTitle;\r\n\r\n    return newA.toLowerCase().localeCompare(newB.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortResponseObjectNoCase(a, b) {\r\n    var aTitle = a.title;\r\n    var bTitle = b.title;\r\n    var newA;\r\n    var newB;\r\n    if (aTitle == null) aTitle = \"\";\r\n    if (bTitle == null) bTitle = \"\";\r\n\r\n    var aIndex = aTitle.lastIndexOf(\"-\");\r\n    if (aIndex >= 0) {\r\n      var subA = aTitle.substring(0, aIndex + 1);\r\n      var lastA = aTitle.replace(subA, \"\");\r\n      var intA = parseInt(lastA, 10);\r\n      var newIntA = Audit.Common.Utilities.PadDigits(intA, 5);\r\n      newA = subA + newIntA;\r\n    } else newA = aTitle;\r\n\r\n    var bIndex = bTitle.lastIndexOf(\"-\");\r\n    if (bIndex >= 0) {\r\n      var subB = bTitle.substring(0, bIndex + 1);\r\n      var lastB = bTitle.replace(subB, \"\");\r\n      var intB = parseInt(lastB, 10);\r\n      var newIntB = Audit.Common.Utilities.PadDigits(intB, 5);\r\n      newB = subB + newIntB;\r\n    } else newB = bTitle;\r\n\r\n    return newA.toLowerCase().localeCompare(newB.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortNoCase(a, b) {\r\n    return a.toLowerCase().localeCompare(b.toLowerCase());\r\n  }\r\n\r\n  function m_fnSortDate(a, b) {\r\n    if (a == \"\") return -1;\r\n    if (b == \"\") return 1;\r\n    return new Date(a).getTime() - new Date(b).getTime();\r\n  }\r\n\r\n  //Adds the values in the arr array to the drop down with the specified id\r\n  function m_fnAddOptions(arr, ddlID, dateSort, responseSort) {\r\n    if (arr == null) return;\r\n    if (responseSort) arr.sort(m_fnSortResponseTitleNoCase);\r\n    else if (!dateSort) arr.sort(m_fnSortNoCase);\r\n    else arr.sort(m_fnSortDate);\r\n\r\n    var rOptions = new Array(),\r\n      j = -1;\r\n    rOptions[++j] = \"<option value=''>-Select-</option>\";\r\n\r\n    var arrLength = arr.length;\r\n\r\n    /*\tvar fragment = document.createDocumentFragment();\r\n\t\t\tvar choice = document.createElement('option');\r\n\t\t\tchoice.value = \"\";\r\n\t\t\tchoice.innerHTML = \"-Select-\";\r\n\t\t\tfragment.appendChild(choice);\r\n\t\t*/\r\n    for (var x = 0; x < arrLength; x++) {\r\n      var option = $.trim(arr[x]);\r\n\r\n      rOptions[++j] = \"<option value='\" + option + \"'>\" + option + \"</option>\";\r\n\r\n      /*\t\r\n\t\t\tvar choice = document.createElement('option');\r\n\t        choice.value = option;\r\n\t        choice.innerHTML = option;\r\n\t        fragment.appendChild(choice);*/\r\n    }\r\n\r\n    //ddlID = ddlID.replace(\"#\", \"\");\r\n    //document.getElementById(ddlID).innerHTML = rOptions.join('');\r\n\r\n    var thisDDL = $(ddlID);\r\n    thisDDL.empty().append(rOptions.join(\"\"));\r\n    /*var thisDDL = $(ddlID);\r\n\t\tthisDDL.empty().html( fragment );*/\r\n  }\r\n\r\n  function m_fnExistsInArr(arr, val) {\r\n    if (arr == null) return false;\r\n\r\n    var arrLength = arr.length;\r\n    for (var x = 0; x < arrLength; x++) {\r\n      if (arr[x] == val) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function m_fnGetTrueFalseIcon(val) {\r\n    if (val == true)\r\n      return \"<span class='ui-icon ui-icon-check'>\" + val + \"</span>\";\r\n    else return \"<span class='ui-icon ui-icon-close'>\" + val + \"</span>\";\r\n  }\r\n\r\n  function m_fnGetFriendlyDisplayName(oListItem, fieldName) {\r\n    var user = oListItem.get_item(fieldName);\r\n    if (user == null) return \"\";\r\n    else return user.get_lookupValue();\r\n  }\r\n\r\n  function m_fnPadDigits(n, totalDigits) {\r\n    n = n.toString();\r\n    var pd = \"\";\r\n    if (totalDigits > n.length) {\r\n      for (let i = 0; i < totalDigits - n.length; i++) {\r\n        pd += \"0\";\r\n      }\r\n    }\r\n    return pd + n.toString();\r\n  }\r\n\r\n  function m_fnPreciseRound(num, decimals) {\r\n    var sign = num >= 0 ? 1 : -1;\r\n    return (\r\n      Math.round(num * Math.pow(10, decimals) + sign * 0.001) /\r\n      Math.pow(10, decimals)\r\n    ).toFixed(decimals);\r\n  }\r\n\r\n  function m_fnGetFriendlyFileSize(fileSize) {\r\n    if (fileSize == null || fileSize == \"\") return \"\";\r\n\r\n    if (fileSize > 1048576) {\r\n      fileSize =\r\n        Audit.Common.Utilities.PreciseRound(fileSize / 1048576, 2) + \" MB\";\r\n    } else if (fileSize > 1024) {\r\n      fileSize =\r\n        Audit.Common.Utilities.PreciseRound(fileSize / 1024, 2) + \" KB\";\r\n    } else {\r\n      fileSize += \" B\";\r\n    }\r\n    return fileSize;\r\n  }\r\n\r\n  function m_fnISODateString(d) {\r\n    function pad(n) {\r\n      return n < 10 ? \"0\" + n : n;\r\n    }\r\n\r\n    return (\r\n      d.getUTCFullYear() +\r\n      \"-\" +\r\n      pad(d.getUTCMonth() + 1) +\r\n      \"-\" +\r\n      pad(d.getUTCDate()) +\r\n      \"T\" +\r\n      pad(d.getUTCHours()) +\r\n      \":\" +\r\n      pad(d.getUTCMinutes()) +\r\n      \":\" +\r\n      pad(d.getUTCSeconds()) +\r\n      \"Z\"\r\n    );\r\n  }\r\n\r\n  function m_fnBindHandlerResponseDoc() {\r\n    $(\".requestInfo-response-doc img\").click(function (event) {\r\n      event.preventDefault();\r\n      var curIcon = $(this).attr(\"src\");\r\n      if (curIcon == \"/_layouts/images/minus.gif\")\r\n        $(this).attr(\"src\", \"/_layouts/images/plus.gif\");\r\n      else $(this).attr(\"src\", \"/_layouts/images/minus.gif\");\r\n\r\n      //$(this).nextUntil('tr.Grouping').slideToggle(200);\r\n      $(this)\r\n        .parent()\r\n        .parent()\r\n        .nextUntil(\"tr.requestInfo-response-doc\")\r\n        .each(function () {\r\n          $(this).toggleClass(\"collapsed\");\r\n        });\r\n    });\r\n  }\r\n\r\n  /************\r\n\tNotice - for some reason, when the list item opens in a dialog or not in the dialog, it renders differently causing the values to get back data differently\r\n\t********/\r\n  /*\r\n\tfunction m_fnGetLookupFieldText( fieldName )\r\n\t{\r\n\t\tvar field = $( \"select[title='\" + fieldName  + \"']\" );\r\n\t\t\r\n\t\tif( field == null || field.html() == null ) //more than 20 items in the lookup\r\n\t\t{\r\n\t\t\tfield = $( \"input[title='\" + fieldName  + \"']\" );\r\n\t\t\treturn field.val();\r\n\t\t}\r\n\t\telse return $(\"select[title='\" + fieldName  + \"'] option:selected\").text();\r\n\t}\r\n\r\n\t*/\r\n\r\n  function m_fnGetLookupFormField(fieldTitle) {\r\n    if ($(\"select[title='\" + fieldTitle + \"']\").html() !== null) {\r\n      return $(\"select[title='\" + fieldTitle + \"']\");\r\n    } else {\r\n      return $(\"input[title='\" + fieldTitle + \"']\");\r\n    }\r\n  }\r\n\r\n  function m_fnGetLookupDisplayText(fieldTitle) {\r\n    //Set default value for lookups with less that 20 items\r\n    if ($(\"select[title='\" + fieldTitle + \"']\").html() !== null) {\r\n      return $(\"select[title='\" + fieldTitle + \"'] option:selected\").text();\r\n    } else {\r\n      return $(\"input[title='\" + fieldTitle + \"']\").val();\r\n    }\r\n  }\r\n\r\n  function m_fnSetLookupFromFieldNameByText(fieldName, text) {\r\n    try {\r\n      if (text == undefined) return;\r\n      var theSelect = m_fnGetTagFromIdentifierAndTitle(\"select\", \"\", fieldName);\r\n\r\n      if (theSelect == null) {\r\n        var theInput = m_fnGetTagFromIdentifierAndTitle(\"input\", \"\", fieldName);\r\n        //builtin\r\n        ShowDropdown(theInput.id);\r\n        var opt = document.getElementById(theInput.opt);\r\n        m_fnSetSelectedOptionByText(opt, text);\r\n        //builtin\r\n        OptLoseFocus(opt);\r\n      } else {\r\n        m_fnSetSelectedOptionByText(theSelect, text);\r\n      }\r\n    } catch (ex) {}\r\n  }\r\n\r\n  function m_fnSetSelectedOptionByText(select, text) {\r\n    var opts = select.options;\r\n    var optLength = opts.length;\r\n    if (select == null) return;\r\n\r\n    for (var i = 0; i < optLength; i++) {\r\n      if (opts[i].text == text) {\r\n        select.selectedIndex = i;\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  function m_fnGetTagFromIdentifierAndTitle(tagName, identifier, title) {\r\n    var idLength = identifier.length;\r\n    var tags = document.getElementsByTagName(tagName);\r\n    for (var i = 0; i < tags.length; i++) {\r\n      var tagID = tags[i].id;\r\n      if (\r\n        tags[i].title == title &&\r\n        (identifier == \"\" ||\r\n          tagID.indexOf(identifier) == tagID.length - idLength)\r\n      ) {\r\n        return tags[i];\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  function m_fnViewUserManuals(docType) {\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"User Manual\";\r\n    options.height = 250;\r\n    //options.dialogReturnValueCallback = OnCallbackForm;\r\n    if (docType != null)\r\n      options.url =\r\n        Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/pages/AuditUserManuals.aspx?FilterField1=DocType&FilterValue1=\" +\r\n        docType;\r\n    else\r\n      options.url =\r\n        Audit.Common.Utilities.GetSiteUrl() + \"/pages/AuditUserManuals.aspx\";\r\n\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  function m_fnPrintPage(pageTitle, divTbl) {\r\n    var curDate = new Date();\r\n    var siteUrl = Audit.Common.Utilities.GetSiteUrl();\r\n    var cssLink1 =\r\n      siteUrl +\r\n      \"/siteassets/css/tablesorter/style.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n    var cssLink2 =\r\n      siteUrl +\r\n      \"/siteAssets/css/audit_styles.css?v=\" +\r\n      curDate.format(\"MM_dd_yyyy\");\r\n\r\n    var divOutput = $(divTbl).html();\r\n\r\n    //remove hyperlinks pointing to the job codes\r\n    var updatedDivOutput = $(\"<div>\").append(divOutput);\r\n    updatedDivOutput.find(\".sr-response-title a\").each(function () {\r\n      $(this).removeAttr(\"onclick\");\r\n      $(this).removeAttr(\"href\");\r\n    });\r\n\r\n    divOutput = updatedDivOutput.html();\r\n\r\n    var printDateString = curDate.format(\"MM/dd/yyyy hh:mm tt\");\r\n    printDateString =\r\n      \"<div style='padding-bottom:10px;'>\" + printDateString + \"</div>\";\r\n    divOutput = printDateString + divOutput;\r\n\r\n    var cssFile1 = $(\"<div></div>\");\r\n    var cssFile2 = $(\"<div></div>\");\r\n\r\n    var def1 = $.Deferred();\r\n    var def2 = $.Deferred();\r\n\r\n    var cssFileText = \"\";\r\n    cssFile1.load(cssLink1, function () {\r\n      cssFileText += \"<style>\" + cssFile1.html() + \"</style>\";\r\n      def1.resolve();\r\n    });\r\n    cssFile2.load(cssLink2, function () {\r\n      cssFileText += \"<style>\" + cssFile2.html() + \"</style>\";\r\n      def2.resolve();\r\n    });\r\n\r\n    //gets called asynchronously after the css files have been loaded\r\n    $.when(def1, def2).done(function () {\r\n      var html =\r\n        \"<HTML>\\n\" +\r\n        \"<HEAD>\\n\\n\" +\r\n        \"<Title>\" +\r\n        pageTitle +\r\n        \"</Title>\\n\" +\r\n        cssFileText +\r\n        \"\\n\" +\r\n        \"<style>\" +\r\n        \".hideOnPrint, .rowFilters {display:none}\" +\r\n        \"</style>\\n\" +\r\n        \"</HEAD>\\n\" +\r\n        \"<BODY>\\n\" +\r\n        divOutput +\r\n        \"\\n\" +\r\n        \"</BODY>\\n\" +\r\n        \"</HTML>\";\r\n\r\n      var printWP = window.open(\"\", \"printWebPart\");\r\n      printWP.document.open();\r\n      //insert content\r\n      printWP.document.write(html);\r\n\r\n      printWP.document.close();\r\n      //open print dialog\r\n      printWP.print();\r\n    });\r\n  }\r\n\r\n  //make sure iframe with id csvexprframe is added to page up top\r\n  //http://stackoverflow.com/questions/18185660/javascript-jquery-exporting-data-in-csv-not-working-in-ie\r\n  function m_fnExportToCsv(fileName, tableName, removeHeader) {\r\n    var data = m_fnGetCellValues(tableName);\r\n\r\n    if (removeHeader == true) data = data.slice(1);\r\n\r\n    var csv = m_fnConvertToCsv(data);\r\n    //\tconsole.log( csv );\r\n    if (navigator.userAgent.search(\"Trident\") >= 0) {\r\n      window.CsvExpFrame.document.open(\"text/html\", \"replace\");\r\n      //\t\twindow.CsvExpFrame.document.open(\"application/csv\", \"replace\");\r\n      //\t\twindow.CsvExpFrame.document.charset = \"utf-8\";\r\n      //\t\twindow.CsvExpFrame.document.open(\"application/ms-excel\", \"replace\");\r\n      window.CsvExpFrame.document.write(csv);\r\n      window.CsvExpFrame.document.close();\r\n      window.CsvExpFrame.focus();\r\n      window.CsvExpFrame.document.execCommand(\r\n        \"SaveAs\",\r\n        true,\r\n        fileName + \".csv\"\r\n      );\r\n    } else {\r\n      var uri = \"data:text/csv;charset=utf-8,\" + escape(csv);\r\n      var downloadLink = document.createElement(\"a\");\r\n      downloadLink.href = uri;\r\n      downloadLink.download = fileName + \".csv\";\r\n      document.body.appendChild(downloadLink);\r\n      downloadLink.click();\r\n      document.body.removeChild(downloadLink);\r\n    }\r\n  }\r\n\r\n  function m_fnGetCellValues(tableName) {\r\n    var table = document.getElementById(tableName);\r\n\r\n    //remove headers and footers\r\n    if (table.innerHTML.indexOf(\"rowFilters\") >= 0) {\r\n      var deets = $(\"<div>\").append(table.outerHTML);\r\n      deets.find(\".rowFilters\").each(function () {\r\n        $(this).remove();\r\n      });\r\n      table = deets.find(\"table\")[0];\r\n    }\r\n    if (table.innerHTML.indexOf(\"footer\") >= 0) {\r\n      var deets = $(\"<div>\").append(table.outerHTML);\r\n      deets.find(\".footer\").each(function () {\r\n        $(this).remove();\r\n      });\r\n      table = deets.find(\"table\")[0];\r\n    }\r\n\r\n    var tableArray = [];\r\n    for (var r = 0, n = table.rows.length; r < n; r++) {\r\n      tableArray[r] = [];\r\n      for (var c = 0, m = table.rows[r].cells.length; c < m; c++) {\r\n        var text =\r\n          table.rows[r].cells[c].textContent ||\r\n          table.rows[r].cells[c].innerText;\r\n        tableArray[r][c] = text.trim();\r\n      }\r\n    }\r\n    return tableArray;\r\n  }\r\n\r\n  function m_fnConvertToCsv(objArray) {\r\n    var array = typeof objArray != \"object\" ? JSON.parse(objArray) : objArray;\r\n    var str = \"sep=,\\r\\n\";\r\n    var line = \"\";\r\n    var index;\r\n    var value;\r\n    for (var i = 0; i < array.length; i++) {\r\n      line = \"\";\r\n      var array1 = array[i];\r\n      for (index in array1) {\r\n        if (array1.hasOwnProperty(index)) {\r\n          value = array1[index] + \"\";\r\n          line += '\"' + value.replace(/\"/g, '\"\"') + '\",';\r\n        }\r\n      }\r\n      line = line.slice(0, -1);\r\n      str += line + \"\\r\\n\";\r\n    }\r\n    return str;\r\n  }\r\n\r\n  var publicMembers = {\r\n    GetSiteUrl: function () {\r\n      if (m_siteUrl == \"/\") return \"\";\r\n      else return m_siteUrl;\r\n    },\r\n    GetListTitleRequests: function () {\r\n      return m_listTitleRequests;\r\n    },\r\n    GetListNameRequests: function () {\r\n      return m_listNameRequests;\r\n    },\r\n    GetListTitleRequestsInternal: function () {\r\n      return m_listTitleRequestsInternal;\r\n    },\r\n    GetListNameRequestsInternal: function () {\r\n      return m_listNameRequestsInternal;\r\n    },\r\n    GetListTitleResponses: function () {\r\n      return m_listTitleResponses;\r\n    },\r\n    GetListNameResponses: function () {\r\n      return m_listNameResponses;\r\n    },\r\n    GetLibTitleRequestDocs: function () {\r\n      return m_libTitleRequestDocs;\r\n    },\r\n    GetLibNameRequestDocs: function () {\r\n      return m_libNameRequestDocs;\r\n    },\r\n    GetLibTitleCoverSheets: function () {\r\n      return m_libTitleCoverSheet;\r\n    },\r\n    GetLibNameCoverSheets: function () {\r\n      return m_libNameCoverSheet;\r\n    },\r\n    GetLibTitleResponseDocs: function () {\r\n      return m_libTitleResponseDocs;\r\n    },\r\n    GetLibNameResponseDocs: function () {\r\n      return m_libNameResponseDocs;\r\n    },\r\n    GetLibTitleResponseDocsEA: function () {\r\n      return m_libTitleResponseDocsEA;\r\n    },\r\n    GetLibNameResponseDocsEA: function () {\r\n      return m_libNameResponseDocsEA;\r\n    },\r\n    GetListTitleActionOffices: function () {\r\n      return m_listTitleActionOffices;\r\n    },\r\n    GetListNameActionOffices: function () {\r\n      return m_listNameActionOffices;\r\n    },\r\n    GetListTitleEmailHistory: function () {\r\n      return m_listTitleEmailHistory;\r\n    },\r\n    GetListNameEmailHistory: function () {\r\n      return m_listNameEmailHistory;\r\n    },\r\n    GetListTitleBulkResponses: function () {\r\n      return m_listTitleBulkResponses;\r\n    },\r\n    GetListNameBulkResponses: function () {\r\n      return m_listNameBulkResponses;\r\n    },\r\n    GetListTitleBulkPermissions: function () {\r\n      return m_listTitleBulkPermissions;\r\n    },\r\n    GetListNameBulkPermissions: function () {\r\n      return m_listNameBulkPermissions;\r\n    },\r\n    GetGroupNameSpecialPerm1: function () {\r\n      return m_groupNameSpecialPermName1;\r\n    },\r\n    GetGroupNameSpecialPerm2: function () {\r\n      return m_groupNameSpecialPermName2;\r\n    },\r\n    GetGroupNameQA: function () {\r\n      return m_groupNameQA;\r\n    },\r\n    GetGroupNameEA: function () {\r\n      return m_groupNameEA;\r\n    },\r\n    Refresh: m_fnRefresh,\r\n    OnLoadDisplayTimeStamp: m_fnOnLoadDisplayTimeStamp,\r\n    OnLoadDisplayTabAndResponse: m_fnOnLoadDisplayTabAndResponse,\r\n    OnLoadFilterResponses: function (responseStatus1, responseStatus2) {\r\n      m_fnOnLoadFilterResponses(responseStatus1, responseStatus2);\r\n    },\r\n    SetResponseDocLibGUID: function (libGUID) {\r\n      m_libResponseDocsLibraryGUID = libGUID;\r\n    },\r\n    GetResponseDocLibGUID: function () {\r\n      return m_libResponseDocsLibraryGUID;\r\n    },\r\n    LoadSiteGroups: function (itemColl) {\r\n      m_fnLoadSiteGroups(itemColl);\r\n    },\r\n    GetSPSiteGroup: function (groupName) {\r\n      return m_fnGetSPSiteGroup(groupName);\r\n    },\r\n    LoadActionOffices: function (itemColl) {\r\n      m_fnLoadActionOffices(itemColl);\r\n    },\r\n    GetActionOffices: function () {\r\n      return m_arrAOs;\r\n    },\r\n    GetAOSPGroupName: function (groupName) {\r\n      return m_fnGetAOSPGroupName(groupName);\r\n    },\r\n    CheckSPItemHasGroupPermission: function (item, groupName, permissionLevel) {\r\n      return m_fnCheckSPItemHasGroupPermission(\r\n        item,\r\n        groupName,\r\n        permissionLevel\r\n      );\r\n    },\r\n    GoToResponse: function (responseTitle, isIA) {\r\n      m_fnGoToResponse(responseTitle, isIA);\r\n    },\r\n    GetResponseDocStyleTag: function (documentStatus) {\r\n      return m_fnGetResponseDocStyleTag(documentStatus);\r\n    },\r\n    GetResponseDocStyleTag2: function (documentStatus) {\r\n      return m_fnGetResponseDocStyleTag2(documentStatus);\r\n    },\r\n    CheckIfEmailFolderExists: function (items, requestNumber) {\r\n      return m_fnCheckIfEmailFolderExists(items, requestNumber);\r\n    },\r\n    CreateEmailFolder: function (list, requestNumber, requestItem, OnComplete) {\r\n      return m_fnCreateEmailFolder(\r\n        list,\r\n        requestNumber,\r\n        requestItem,\r\n        OnComplete\r\n      );\r\n    },\r\n    AddOptions: function (arr, ddlID, dateSort, responseSort) {\r\n      m_fnAddOptions(arr, ddlID, dateSort, responseSort);\r\n    },\r\n    ExistsInArr: function (arr, val) {\r\n      return m_fnExistsInArr(arr, val);\r\n    },\r\n    GetTrueFalseIcon: function (val) {\r\n      return m_fnGetTrueFalseIcon(val);\r\n    },\r\n    PadDigits: function (n, totalDigits) {\r\n      return m_fnPadDigits(n, totalDigits);\r\n    },\r\n    PreciseRound: function (num, decimals) {\r\n      return m_fnPreciseRound(num, decimals);\r\n    },\r\n    GetFriendlyFileSize: function (fileSize) {\r\n      return m_fnGetFriendlyFileSize(fileSize);\r\n    },\r\n    GetISODateString: function (d) {\r\n      return m_fnISODateString(d);\r\n    },\r\n    GetFriendlyDisplayName: function (oListItem, fieldName) {\r\n      return m_fnGetFriendlyDisplayName(oListItem, fieldName);\r\n    },\r\n    BindHandlerResponseDoc: m_fnBindHandlerResponseDoc,\r\n    PrintStatusReport: function (pageTitle, divTbl) {\r\n      m_fnPrintPage(pageTitle, divTbl);\r\n    },\r\n    ExportToCsv: function (fileName, tableName, removeHeader) {\r\n      m_fnExportToCsv(fileName, tableName, removeHeader);\r\n    },\r\n    ViewUserManuals: function (docType) {\r\n      m_fnViewUserManuals(docType);\r\n    },\r\n    //GetLookupFieldText: function( fieldName ){ return m_fnGetLookupFieldText( fieldName); },\r\n    GetLookupDisplayText: function (fieldName) {\r\n      return m_fnGetLookupDisplayText(fieldName);\r\n    },\r\n    GetLookupFormField: function (fieldName) {\r\n      return m_fnGetLookupFormField(fieldName);\r\n    },\r\n    SetLookupFromFieldNameByText: function (fieldName, text) {\r\n      return m_fnSetLookupFromFieldNameByText(fieldName, text);\r\n    },\r\n    SortResponseObjects: function (a, b) {\r\n      return m_fnSortResponseObjectNoCase(a, b);\r\n    },\r\n    SortResponseTitles: m_fnSortResponseTitleNoCase,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n\r\n// ExecuteOrDelayUntilScriptLoaded(InitReport, \"sp.js\");\r\nInitReport();\r\n", "\uFEFFimport { spDbTemplate } from \"./SP_DB_Template.js\";\r\n\r\nimport \"../../common/utilities.js\";\r\n\r\ndocument.getElementById(\"app\").innerHTML = spDbTemplate;\r\n\r\nwindow.Audit = window.Audit || {};\r\nAudit.SPReport = Audit.SPReport || {};\r\n\r\nvar paramShowSiteActionsToAnyone = GetUrlKeyValue(\"ShowSiteActions\");\r\nif (paramShowSiteActionsToAnyone != true) {\r\n  //hide it even for owners unless this param is passed into the URL; pass in param if you want to change the page web parts/settings\r\n  $(\"#RibbonContainer-TabRowLeft\").hide();\r\n  $(\".ms-siteactionsmenu\").hide();\r\n}\r\n\r\nif (document.readyState === \"ready\" || document.readyState === \"complete\") {\r\n  InitReport();\r\n} else {\r\n  document.onreadystatechange = () => {\r\n    if (document.readyState === \"complete\" || document.readyState === \"ready\") {\r\n      ExecuteOrDelayUntilScriptLoaded(function () {\r\n        SP.SOD.executeFunc(\"sp.js\", \"SP.ClientContext\", InitReport);\r\n      }, \"sp.js\");\r\n    }\r\n  };\r\n}\r\n\r\nfunction InitReport() {\r\n  Audit.SPReport.Report = new Audit.SPReport.NewReportPage();\r\n  Audit.SPReport.Init();\r\n}\r\n\r\nAudit.SPReport.Init = function () {\r\n  var paramShowSiteActionsToAnyone = GetUrlKeyValue(\"ShowSiteActions\");\r\n  if (paramShowSiteActionsToAnyone != true) {\r\n    //hide it even for owners unless this param is passed into the URL; pass in param if you want to change the page web parts/settings\r\n    $(\"#RibbonContainer-TabRowLeft\").hide();\r\n    $(\".ms-siteactionsmenu\").hide();\r\n  }\r\n\r\n  setInterval(function () {\r\n    var divVal = $(\"#divCounter\").text();\r\n    var count = divVal * 1 - 1;\r\n    $(\"#divCounter\").text(count);\r\n    if (count <= 0) {\r\n      Audit.Common.Utilities.Refresh();\r\n    }\r\n  }, 1000);\r\n};\r\n\r\nAudit.SPReport.NewReportPage = function () {\r\n  var m_bigMap = new Object();\r\n  var m_arrRequests = new Array();\r\n  var m_arrResponses = new Array();\r\n\r\n  var m_requestItems;\r\n  var m_responseItems;\r\n  var m_ResponseDocsItems;\r\n\r\n  var statusId;\r\n\r\n  var m_bHasAccessToViewPerms = false;\r\n\r\n  ko.extenders.logChangeInArr = function (target, option) {\r\n    target.subscribe(function (newValue) {\r\n      console.log(option + \": \" + JSON.stringify(newValue));\r\n\r\n      console.log(newValue.length);\r\n    });\r\n    return target;\r\n  };\r\n\r\n  function ViewModel() {\r\n    var self = this;\r\n\r\n    self.siteUrl = Audit.Common.Utilities.GetSiteUrl();\r\n\r\n    self.arrResponses = ko.observableArray(null);\r\n\r\n    self.arrFilteredResponsesCount = ko.observable(0);\r\n\r\n    self.filterRequestID = ko.observable();\r\n    self.filterRequestStatus = ko.observable();\r\n    self.filterRequestIntDueDate = ko.observable();\r\n    self.filterSampleNum = ko.observable();\r\n    self.filterResponseName = ko.observable();\r\n    self.filterResponseStatus = ko.observable();\r\n\r\n    self.filterResponseName2 = ko.observable();\r\n    self.currentResponse = ko.observable();\r\n    self.arrCoverSheets = ko.observableArray(null);\r\n    self.arrResponseDocs = ko.observableArray(null);\r\n    self.cntResponseDocs = ko.observable(0);\r\n\r\n    self.doSort = ko.observable(false);\r\n\r\n    self.currentResponseStatus = ko\r\n      .computed(function () {\r\n        if (self.currentResponse()) {\r\n          if (self.currentResponse().resStatus == \"7-Closed\")\r\n            return (\r\n              self.currentResponse().resStatus +\r\n              \" on \" +\r\n              self.currentResponse().closedDate +\r\n              \" by \" +\r\n              self.currentResponse().closedBy\r\n            );\r\n\r\n          return self.currentResponse().resStatus;\r\n        }\r\n        return \"\";\r\n      }, self)\r\n      .extend({ notify: \"always\" });\r\n\r\n    self.currentResponseRequestStatus = ko.computed(function () {\r\n      if (self.currentResponse()) {\r\n        if (self.currentResponse().request.status == \"Closed\")\r\n          return (\r\n            self.currentResponse().request.status +\r\n            \" on \" +\r\n            self.currentResponse().request.closedDate\r\n          );\r\n\r\n        return self.currentResponse().request.status;\r\n      }\r\n      return \"\";\r\n    }, self);\r\n\r\n    self.currentResponseRequestStatusStyle = ko.computed(function () {\r\n      if (self.currentResponseStatus() != \"\") {\r\n        if (\r\n          self.currentResponse().request.status == \"Closed\" ||\r\n          self.currentResponse().request.status == \"Canceled\"\r\n        )\r\n          return \"red\";\r\n        else return \"green\";\r\n      }\r\n      return \"\";\r\n    }, self);\r\n\r\n    /** Behaviors **/\r\n\r\n    self.ClearFilters = function () {\r\n      self.filterRequestID(\"\");\r\n      self.filterRequestStatus(\"\");\r\n      self.filterRequestIntDueDate(\"\");\r\n      self.filterSampleNum(\"\");\r\n      self.filterResponseName(\"\");\r\n      self.filterResponseStatus(\"\");\r\n    };\r\n\r\n    self.GetDistinctResponsesDDVals = function (fieldName) {\r\n      return ko.computed(\r\n        {\r\n          read: function () {\r\n            var types = ko.utils.arrayMap(self.arrResponses(), function (item) {\r\n              return item[fieldName];\r\n            });\r\n\r\n            var ddArr = ko.utils.arrayGetDistinctValues(types).sort();\r\n            return ddArr;\r\n          },\r\n        },\r\n        self\r\n      );\r\n    };\r\n\r\n    self.GoToResponse = function (response) {\r\n      $(\"#tabs\").tabs({ active: 1 });\r\n      self.filterResponseName2(response.title);\r\n    };\r\n\r\n    /** Subscriptions **/\r\n\r\n    self.arrResponses.subscribe(function (newValue) {\r\n      if (self.arrResponses().length > 0 && self.doSort()) {\r\n        //should trigger only once\r\n        self.arrFilteredResponsesCount(self.arrResponses().length);\r\n\r\n        setTimeout(function () {\r\n          $(\"#tblStatusReportResponses\").tablesorter({\r\n            sortList: [[7, 1]],\r\n            selectorHeaders: \".sorter-true\",\r\n          });\r\n        }, 200);\r\n      }\r\n    });\r\n\r\n    /* second tab */\r\n    self.filterResponseName2.subscribe(function (newValue) {\r\n      var oResponse = m_bigMap[\"response-\" + self.filterResponseName2()];\r\n      if (oResponse) {\r\n        self.currentResponse(oResponse);\r\n\r\n        LoadTabResponseInfoCoverSheets(oResponse);\r\n        LoadTabResponseInfoResponseDocs(oResponse);\r\n      } else {\r\n        self.currentResponse(null);\r\n        self.arrCoverSheets([]);\r\n        self.arrResponseDocs([]);\r\n        self.cntResponseDocs(0);\r\n      }\r\n    });\r\n\r\n    /*var Item = function(reqNumber, requestStatus, internalDueDate, sample, title, status, docCount, modified, visibleRow) {\r\n\t\t    this.reqNumber= ko.observable(reqNumber);\r\n\t\t    this.requestStatus= ko.observable(requestStatus);    \r\n\t\t    this.internalDueDate= ko.observable(internalDueDate);    \r\n\t\t    this.sample= ko.observable(sample);    \r\n\t\t    this.title= ko.observable(title);    \r\n\t\t    this.status= ko.observable(status);    \r\n\t\t    this.docCount= ko.observable(docCount);    \r\n\t\t    this.modified= ko.observable(modified);    \r\n\t\t    this.visibleRow = ko.observable(visibleRow);    \r\n\t\t};*/\r\n\r\n    /*\tself.addNewData = function(newData) {\r\n  \t\t  var newItems = ko.utils.arrayMap(newData, function(item) {\r\n       \t\treturn {\r\n       \t\t\treqNumber: item.reqNumber,\r\n       \t\t\trequestStatus: item.requestStatus,\r\n       \t\t\tinternalDueDate: item.internalDueDate,\r\n       \t\t\tsample: item.sample,\r\n       \t\t\ttitle: item.title,\r\n       \t\t\tstatus: item.status,\r\n       \t\t\tdocCount: item.docCount,\r\n       \t\t\tmodified: item.modified,\r\n       \t\t\tvisibleRow: item.visibleRow,\r\n\t\t };\r\n   \t\t });\r\n\t    //take advantage of push accepting variable arguments\r\n\t    self.arrResponses.push.apply(self.arrResponses, newItems);\r\n\t};*/\r\n\r\n    /*\r\n\r\n\tself.addNewData = function(newData) {\r\n  \t\t  var newItems = ko.utils.arrayMap(newData, function(item) {\r\n       \t\treturn {\r\n       \t\t\treqNumber: item.reqNumber,\r\n       \t\t\trequestStatus: item.requestStatus,\r\n       \t\t\tinternalDueDate: item.internalDueDate,\r\n       \t\t\tsample: item.sample,\r\n       \t\t\ttitle: item.title,\r\n       \t\t\tstatus: item.status,\r\n       \t\t\tdocCount: item.docCount,\r\n       \t\t\tmodified: item.modified,\r\n       \t\t\tvisibleRow: item.visibleRow,\r\n\t\t };\r\n   \t\t });\r\n\t    //take advantage of push accepting variable arguments\r\n\t    self.arrResponses.push.apply(self.arrResponses, newItems);\r\n\t};*/\r\n\r\n    self.FilterChanged = function () {\r\n      setTimeout(function () {\r\n        var requestID = self.filterRequestID();\r\n        var requestStatus = self.filterRequestStatus();\r\n        var requestIntDueDate = self.filterRequestIntDueDate();\r\n        var sampleNum = self.filterSampleNum();\r\n        var responseName = self.filterResponseName();\r\n        var responseStatus = self.filterResponseStatus();\r\n\r\n        if (\r\n          !requestID &&\r\n          !requestStatus &&\r\n          !requestIntDueDate &&\r\n          !sampleNum &&\r\n          !responseName &&\r\n          !responseStatus\r\n        ) {\r\n          ko.utils.arrayForEach(self.arrResponses(), function (item) {\r\n            item.visibleRow(true);\r\n          });\r\n\r\n          self.arrFilteredResponsesCount(self.arrResponses().length);\r\n        }\r\n\r\n        var result = [];\r\n\r\n        requestID = !requestID ? \"\" : requestID;\r\n        requestStatus = !requestStatus ? \"\" : requestStatus;\r\n        requestIntDueDate = !requestIntDueDate ? \"\" : requestIntDueDate;\r\n        sampleNum = !sampleNum ? \"\" : sampleNum;\r\n        responseName = !responseName ? \"\" : responseName;\r\n        responseStatus = !responseStatus ? \"\" : responseStatus;\r\n\r\n        var count = 0;\r\n        ko.utils.arrayForEach(self.arrResponses(), function (item) {\r\n          var hide = false;\r\n          if (!hide && requestID != \"\" && item.reqNumber != requestID)\r\n            hide = true;\r\n          if (\r\n            !hide &&\r\n            requestStatus != \"\" &&\r\n            item.requestStatus != requestStatus\r\n          )\r\n            hide = true;\r\n          if (\r\n            !hide &&\r\n            requestIntDueDate != \"\" &&\r\n            item.internalDueDate != requestIntDueDate\r\n          )\r\n            hide = true;\r\n          if (!hide && sampleNum != \"\" && item.sample != sampleNum) hide = true;\r\n          if (!hide && responseName != \"\" && item.title != responseName)\r\n            hide = true;\r\n          if (!hide && responseStatus != \"\" && item.status != responseStatus)\r\n            hide = true;\r\n\r\n          item.visibleRow(!hide);\r\n\r\n          if (!hide) count++;\r\n        });\r\n\r\n        self.arrFilteredResponsesCount(count);\r\n      }, 100);\r\n    };\r\n  }\r\n\r\n  var _myViewModel = new ViewModel();\r\n  ko.applyBindings(_myViewModel);\r\n\r\n  LoadInfo();\r\n\r\n  function LoadInfo() {\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    const m_currentUser = web.get_currentUser();\r\n    currCtx.load(m_currentUser);\r\n\r\n    var requestList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleRequests());\r\n    var requestQuery = new SP.CamlQuery();\r\n    requestQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>'\r\n    );\r\n    m_requestItems = requestList.getItems(requestQuery);\r\n    currCtx.load(\r\n      m_requestItems,\r\n      \"Include(ID, Title, ReqSubject, ReqStatus, IsSample, InternalDueDate, ActionOffice, Comments, RelatedAudit, ActionItems, EmailSent, ClosedDate, Modified)\"\r\n    );\r\n\r\n    var responseList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleResponses());\r\n    var responseQuery = new SP.CamlQuery();\r\n    responseQuery.set_viewXml(\r\n      '<View Scope=\"RecursiveAll\"><Query><OrderBy><FieldRef Name=\"ReqNum\"/></OrderBy></Query></View>'\r\n    );\r\n    m_responseItems = responseList.getItems(responseQuery);\r\n    currCtx.load(\r\n      m_responseItems,\r\n      \"Include(ID, Title, ReqNum, ActionOffice, SampleNumber, ResStatus, Comments, Modified, ClosedDate, ClosedBy)\"\r\n    );\r\n\r\n    //make sure to only pull documents (fsobjtype = 0)\r\n    var responseDocsLib = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetLibTitleResponseDocs());\r\n    var responseDocsQuery = new SP.CamlQuery();\r\n    responseDocsQuery.set_viewXml(\r\n      '<View Scope=\"RecursiveAll\"><Query><OrderBy><FieldRef Name=\"ReqNum\"/><FieldRef Name=\"ResID\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\"/><Value Type=\"Text\">0</Value></Eq></Where></Query></View>'\r\n    );\r\n    m_ResponseDocsItems = responseDocsLib.getItems(responseDocsQuery);\r\n    currCtx.load(\r\n      m_ResponseDocsItems,\r\n      \"Include(ID, FSObjType, Title, ReqNum, ResID, DocumentStatus, RejectReason, ReceiptDate, FileLeafRef, FileDirRef, File_x0020_Size, CheckoutUser, Modified, Editor)\"\r\n    );\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n    function OnSuccess(sender, args) {\r\n      var requestList = web\r\n        .get_lists()\r\n        .getByTitle(Audit.Common.Utilities.GetListTitleRequests());\r\n      var requestQuery = new SP.CamlQuery();\r\n      requestQuery.set_viewXml(\r\n        '<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>'\r\n      );\r\n      var m_requestItemsWithPerms = requestList.getItems(requestQuery);\r\n      currCtx.load(\r\n        m_requestItemsWithPerms,\r\n        \"Include(ID, Title, ReqSubject, ReqStatus, IsSample, InternalDueDate, ActionOffice, Comments, RelatedAudit, ActionItems, EmailSent, ClosedDate, Modified, HasUniqueRoleAssignments, RoleAssignments, RoleAssignments.Include(Member, RoleDefinitionBindings))\"\r\n      );\r\n\r\n      function OnSuccess2(sender, args) {\r\n        m_bHasAccessToViewPerms = true;\r\n        m_requestItems = m_requestItemsWithPerms;\r\n        $(\"#divRefresh\").show();\r\n        m_fnLoadData();\r\n      }\r\n      function OnFailure2(sender, args) {\r\n        $(\"#divRefresh\").show();\r\n        m_fnLoadData();\r\n      }\r\n\r\n      currCtx.executeQueryAsync(OnSuccess2, OnFailure2);\r\n    }\r\n    function OnFailure(sender, args) {\r\n      $(\"#divRefresh\").hide();\r\n      $(\"#divLoading\").hide();\r\n\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n      SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n    }\r\n  }\r\n\r\n  function m_fnLoadData() {\r\n    LoadRequests();\r\n    LoadResponses();\r\n    LoadResponseDocs();\r\n\r\n    $(\"#tabs\").tabs().show();\r\n\r\n    LoadTabStatusReport(m_arrResponses);\r\n  }\r\n\r\n  function OnLoadDisplayTabAndRequest() {\r\n    var paramResponseNum = GetUrlKeyValue(\"ResNum\");\r\n    if (paramResponseNum != null && paramResponseNum != \"\") {\r\n      _myViewModel.filterResponseName2(paramResponseNum);\r\n    }\r\n\r\n    var paramTabIndex = GetUrlKeyValue(\"Tab\");\r\n    if (paramTabIndex != null && paramTabIndex != \"\") {\r\n      $(\"#tabs\").tabs(\"option\", \"active\", paramTabIndex);\r\n    }\r\n  }\r\n\r\n  function LoadRequests() {\r\n    m_bigMap = new Object();\r\n    m_arrRequests = new Array();\r\n\r\n    var cnt = 0;\r\n    var listItemEnumerator = m_requestItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var number = oListItem.get_item(\"Title\");\r\n      var status = oListItem.get_item(\"ReqStatus\");\r\n      var sample = oListItem.get_item(\"IsSample\");\r\n      var emailSent = oListItem.get_item(\"EmailSent\");\r\n      var subject = oListItem.get_item(\"ReqSubject\");\r\n      if (subject == null) subject = \"\";\r\n\r\n      var internalDueDate = oListItem.get_item(\"InternalDueDate\");\r\n      var closedDate = oListItem.get_item(\"ClosedDate\");\r\n\r\n      internalDueDate != null\r\n        ? (internalDueDate = internalDueDate.format(\"MM/dd/yyyy\"))\r\n        : (internalDueDate = \"\");\r\n      closedDate != null\r\n        ? (closedDate = closedDate.format(\"MM/dd/yyyy\"))\r\n        : (closedDate = \"\");\r\n\r\n      var arrActionOffice = oListItem.get_item(\"ActionOffice\");\r\n      var actionOffice = \"\";\r\n      for (var x = 0; x < arrActionOffice.length; x++) {\r\n        actionOffice +=\r\n          \"<div>\" + arrActionOffice[x].get_lookupValue() + \"</div>\";\r\n      }\r\n\r\n      var comments = oListItem.get_item(\"Comments\");\r\n      var relatedAudit = oListItem.get_item(\"RelatedAudit\");\r\n      var actionItems = oListItem.get_item(\"ActionItems\");\r\n\r\n      if (comments == null) comments = \"\";\r\n      if (relatedAudit == null) relatedAudit = \"\";\r\n      if (actionItems == null) actionItems = \"\";\r\n\r\n      var requestObject = new Object();\r\n      requestObject[\"ID\"] = id;\r\n      requestObject[\"number\"] = number;\r\n      requestObject[\"subject\"] = subject;\r\n      requestObject[\"status\"] = status;\r\n      requestObject[\"internalDueDate\"] = internalDueDate;\r\n      requestObject[\"sample\"] = sample;\r\n      requestObject[\"responses\"] = new Array();\r\n      requestObject[\"actionOffice\"] = actionOffice;\r\n      requestObject[\"comments\"] = comments;\r\n      requestObject[\"emailSent\"] = emailSent;\r\n      requestObject[\"closedDate\"] = closedDate;\r\n      requestObject[\"relatedAudit\"] = relatedAudit;\r\n      requestObject[\"actionItems\"] = actionItems;\r\n\r\n      //if logged in user is a site owner, we want to see if the request has special perms so that the site owner only sees a filtered set of requests that have been specifically given special perms.\r\n      //otherwise, if it's a user in the special perms group, this check is skipped and they'll see whatever they have access to\r\n      if (m_bHasAccessToViewPerms) {\r\n        try {\r\n          var permissionsToCheck = SP.PermissionKind.viewListItems;\r\n          var match1 = Audit.Common.Utilities.CheckSPItemHasGroupPermission(\r\n            oListItem,\r\n            Audit.Common.Utilities.GetGroupNameSpecialPerm1(),\r\n            permissionsToCheck\r\n          );\r\n          var match2 = Audit.Common.Utilities.CheckSPItemHasGroupPermission(\r\n            oListItem,\r\n            Audit.Common.Utilities.GetGroupNameSpecialPerm2(),\r\n            permissionsToCheck\r\n          );\r\n\r\n          if (!match1 && !match2) continue;\r\n        } catch (err) {}\r\n      }\r\n\r\n      requestObject[\"arrIndex\"] = cnt;\r\n      m_arrRequests.push(requestObject);\r\n\r\n      m_bigMap[\"request-\" + number] = requestObject;\r\n      cnt++;\r\n    }\r\n  }\r\n\r\n  function LoadResponses() {\r\n    m_arrResponses = new Array();\r\n\r\n    var cnt = 0;\r\n    var listItemEnumerator = m_responseItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var number = oListItem.get_item(\"ReqNum\");\r\n      if (number != null) {\r\n        number = number.get_lookupValue();\r\n\r\n        var responseObject = new Object();\r\n        responseObject[\"request\"] = m_bigMap[\"request-\" + number]; //GetRequest( number );\r\n        if (!responseObject.request || !responseObject.request.emailSent)\r\n          //they should see it if they have access; then there's probably a permissions issue\r\n          continue;\r\n\r\n        //Special permissions users should only see responses that have been approved for QA or closed. The permissions should take care of this, but this is an extra safety measure\r\n        responseObject[\"resStatus\"] = oListItem.get_item(\"ResStatus\");\r\n        if (\r\n          responseObject[\"resStatus\"] != \"4-Approved for QA\" &&\r\n          responseObject[\"resStatus\"] != \"7-Closed\" &&\r\n          responseObject[\"resStatus\"] != \"6-Reposted After Rejection\"\r\n        )\r\n          continue;\r\n\r\n        responseObject[\"actionOffice\"] = oListItem.get_item(\"ActionOffice\");\r\n        if (responseObject[\"actionOffice\"] == null)\r\n          responseObject[\"actionOffice\"] = \"\";\r\n        else\r\n          responseObject[\"actionOffice\"] =\r\n            responseObject[\"actionOffice\"].get_lookupValue();\r\n        if (responseObject[\"actionOffice\"] == \"\") continue;\r\n\r\n        responseObject[\"ID\"] = oListItem.get_item(\"ID\");\r\n        responseObject[\"number\"] = number;\r\n\r\n        var title = oListItem.get_item(\"Title\");\r\n        responseObject[\"title\"] = title;\r\n\r\n        var modified = oListItem.get_item(\"Modified\");\r\n        modified != null\r\n          ? (modified = modified.format(\"MM/dd/yyyy hh:mm tt\"))\r\n          : (modified = \"\");\r\n        responseObject[\"modified\"] = modified;\r\n\r\n        var closedDate = oListItem.get_item(\"ClosedDate\");\r\n        closedDate != null\r\n          ? (closedDate = closedDate.format(\"MM/dd/yyyy\"))\r\n          : (closedDate = \"\");\r\n        responseObject[\"closedDate\"] = closedDate;\r\n\r\n        var comments = oListItem.get_item(\"Comments\");\r\n        if (comments == null) comments = \"\";\r\n        responseObject[\"comments\"] = comments;\r\n\r\n        responseObject[\"closedBy\"] =\r\n          Audit.Common.Utilities.GetFriendlyDisplayName(oListItem, \"ClosedBy\");\r\n\r\n        responseObject[\"sample\"] = oListItem.get_item(\"SampleNumber\");\r\n        if (responseObject[\"sample\"] == null) responseObject[\"sample\"] = \"\";\r\n\r\n        responseObject[\"coversheets\"] = new Array();\r\n        responseObject[\"responseDocs\"] = new Array();\r\n\r\n        responseObject[\"arrIndex\"] = cnt;\r\n        m_arrResponses.push(responseObject);\r\n\r\n        m_bigMap[\"response-\" + title] = responseObject;\r\n        cnt++;\r\n      }\r\n    }\r\n  }\r\n\r\n  function LoadResponseDocs() {\r\n    var listItemEnumerator = m_ResponseDocsItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n      if (\r\n        oListItem.get_item(\"DocumentStatus\") == \"Open\" ||\r\n        oListItem.get_item(\"DocumentStatus\") == \"Marked for Deletion\" ||\r\n        oListItem.get_item(\"DocumentStatus\") == \"Submitted\"\r\n      )\r\n        //shouldn't see any documents that have been uploaded by AO but not sent to them by IA\r\n        continue;\r\n\r\n      var responseDocID = oListItem.get_item(\"ID\");\r\n\r\n      var requestNumber = oListItem.get_item(\"ReqNum\");\r\n      if (requestNumber != null)\r\n        requestNumber = requestNumber.get_lookupValue();\r\n\r\n      var responseID = oListItem.get_item(\"ResID\");\r\n      if (responseID != null) responseID = responseID.get_lookupValue();\r\n\r\n      if (requestNumber == null || responseID == null) continue;\r\n\r\n      try {\r\n        var bigMapItem = m_bigMap[\"response-\" + responseID];\r\n        var indexOfArrResponses = bigMapItem.arrIndex;\r\n        var oResponse = m_arrResponses[indexOfArrResponses];\r\n        if (oResponse) {\r\n          var responseDocObject = new Object();\r\n          responseDocObject[\"ID\"] = oListItem.get_item(\"ID\");\r\n          responseDocObject[\"title\"] = oListItem.get_item(\"FileLeafRef\");\r\n          responseDocObject[\"folder\"] = oListItem.get_item(\"FileDirRef\");\r\n          responseDocObject[\"documentStatus\"] =\r\n            oListItem.get_item(\"DocumentStatus\");\r\n\r\n          responseDocObject[\"rejectReason\"] =\r\n            oListItem.get_item(\"RejectReason\");\r\n          if (responseDocObject[\"rejectReason\"] == null)\r\n            responseDocObject[\"rejectReason\"] = \"\";\r\n\r\n          var fileSize = oListItem.get_item(\"File_x0020_Size\");\r\n          fileSize = Audit.Common.Utilities.GetFriendlyFileSize(fileSize);\r\n          responseDocObject[\"fileSize\"] = fileSize;\r\n\r\n          var receiptDate = \"\";\r\n          if (\r\n            oListItem.get_item(\"ReceiptDate\") != null &&\r\n            oListItem.get_item(\"ReceiptDate\") != \"\"\r\n          )\r\n            receiptDate = oListItem\r\n              .get_item(\"ReceiptDate\")\r\n              .format(\"MM/dd/yyyy\");\r\n          responseDocObject[\"receiptDate\"] = receiptDate;\r\n\r\n          var modifiedDate = \"\";\r\n          if (\r\n            oListItem.get_item(\"Modified\") != null &&\r\n            oListItem.get_item(\"Modified\") != \"\"\r\n          )\r\n            modifiedDate = oListItem\r\n              .get_item(\"Modified\")\r\n              .format(\"MM/dd/yyyy hh:mm tt\");\r\n          responseDocObject[\"modifiedDate\"] = modifiedDate;\r\n\r\n          responseDocObject[\"modifiedBy\"] =\r\n            Audit.Common.Utilities.GetFriendlyDisplayName(oListItem, \"Editor\");\r\n          responseDocObject[\"checkedOutBy\"] =\r\n            Audit.Common.Utilities.GetFriendlyDisplayName(\r\n              oListItem,\r\n              \"CheckoutUser\"\r\n            );\r\n\r\n          oResponse[\"responseDocs\"].push(responseDocObject);\r\n          //bigMapItem[\"responseDocs\"].push( responseDocObject );\r\n        }\r\n      } catch (err) {}\r\n    }\r\n  }\r\n\r\n  function LoadTabStatusReport(arr) {\r\n    if (arr == null) return;\r\n\r\n    var bLoadTest = GetUrlKeyValue(\"LoadTest\");\r\n\r\n    var responseArr = new Array();\r\n\r\n    var arrLength = arr.length;\r\n    while (arrLength--) {\r\n      var oResponse = arr[arrLength];\r\n\r\n      var responseTitle = oResponse.title;\r\n      var requestStatus = oResponse.request.status;\r\n      var responseStatus = oResponse.resStatus;\r\n\r\n      var aResponse = {\r\n        reqNumber: oResponse.request.number,\r\n        requestStatus: requestStatus,\r\n        internalDueDate: oResponse.request.internalDueDate,\r\n        sample: oResponse.sample,\r\n        title: responseTitle,\r\n        status: responseStatus,\r\n        docCount: oResponse.responseDocs.length,\r\n        modified: oResponse.modified,\r\n        visibleRow: ko.observable(true),\r\n      };\r\n\r\n      responseArr.push(aResponse);\r\n\r\n      if (bLoadTest) {\r\n        for (var x = 0; x < 299; x++) {\r\n          responseArr.push(aResponse);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (responseArr.length > 0) {\r\n      DoUpdateModel(responseArr);\r\n    } else {\r\n      Audit.Common.Utilities.OnLoadDisplayTimeStamp();\r\n    }\r\n\r\n    //_myViewModel.addNewData( responseArr );\r\n    //ko.utils.arrayPushAll( _myViewModel.arrResponses(), responseArr );\r\n    //_myViewModel.arrResponses.valueHasMutated();\r\n  }\r\n\r\n  function DoUpdateModel(arrResponsesToAdd) {\r\n    var subArr = [];\r\n\r\n    var bContinue = true;\r\n    var batchSize = 250;\r\n\r\n    if (arrResponsesToAdd.length == 0) {\r\n      //_myViewModel.doSort ( true );\r\n      //_myViewModel.arrResponses.valueHasMutated();\r\n      bContinue = false;\r\n\r\n      //setTimeout( function()\r\n      //{\r\n      Audit.Common.Utilities.OnLoadDisplayTimeStamp();\r\n      BindHandlersOnLoad();\r\n      OnLoadDisplayTabAndRequest();\r\n\r\n      //}, 100 );\r\n    } else if (arrResponsesToAdd.length >= batchSize) {\r\n      subArr = arrResponsesToAdd.slice(0, batchSize);\r\n      arrResponsesToAdd.splice(0, batchSize);\r\n    } else if (arrResponsesToAdd.length > 0) {\r\n      subArr = arrResponsesToAdd.slice(0, arrResponsesToAdd.length);\r\n      arrResponsesToAdd.splice(0, arrResponsesToAdd.length);\r\n    }\r\n\r\n    if (bContinue) {\r\n      ko.utils.arrayPushAll(_myViewModel.arrResponses(), subArr);\r\n      if (arrResponsesToAdd.length == 0) _myViewModel.doSort(true);\r\n\r\n      _myViewModel.arrResponses.valueHasMutated();\r\n\r\n      setTimeout(function () {\r\n        DoUpdateModel(arrResponsesToAdd);\r\n      }, 100);\r\n    }\r\n  }\r\n\r\n  function LoadTabResponseInfoCoverSheets(oResponse) {\r\n    _myViewModel.arrCoverSheets([]);\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var coverSheetLib = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetLibTitleCoverSheets());\r\n    var coverSheetQuery = new SP.CamlQuery();\r\n    coverSheetQuery.set_viewXml(\r\n      '<View Scope=\"RecursiveAll\"><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy><Where><Eq><FieldRef Name=\"ReqNum\"/><Value Type=\"Text\">' +\r\n        oResponse.request.number +\r\n        \"</Value></Eq></Where></Query></View>\"\r\n    );\r\n    var m_subsetCoverSheetItems = coverSheetLib.getItems(coverSheetQuery);\r\n    currCtx.load(\r\n      m_subsetCoverSheetItems,\r\n      \"Include(ID, Title, ReqNum, ActionOffice, FileLeafRef, FileDirRef)\"\r\n    );\r\n\r\n    var data = { oResponse: oResponse };\r\n    function OnSuccess(sender, args) {\r\n      var arrCS = new Array();\r\n\r\n      var listItemEnumerator = m_subsetCoverSheetItems.getEnumerator();\r\n      while (listItemEnumerator.moveNext()) {\r\n        var oListItem = listItemEnumerator.get_current();\r\n\r\n        if (oListItem.get_item(\"ActionOffice\") != null) {\r\n          var arrActionOffice = oListItem.get_item(\"ActionOffice\");\r\n          if (arrActionOffice.length > 0) {\r\n            for (var y = 0; y < arrActionOffice.length; y++) {\r\n              var curActionOffice = arrActionOffice[y].get_lookupValue();\r\n\r\n              if (curActionOffice == this.oResponse.actionOffice) {\r\n                var csFolder = oListItem.get_item(\"FileDirRef\");\r\n                var csTitle = oListItem.get_item(\"FileLeafRef\");\r\n\r\n                var encodedTitle = csTitle.replace(/'/g, \"&#39\");\r\n                arrCS.push({\r\n                  folder: csFolder,\r\n                  title: csTitle,\r\n                  link:\r\n                    \"STSNavigate('../_layouts/download.aspx?SourceUrl=\" +\r\n                    csFolder +\r\n                    \"/\" +\r\n                    encodedTitle +\r\n                    \"')\",\r\n                });\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      ko.utils.arrayPushAll(_myViewModel.arrCoverSheets(), arrCS);\r\n      _myViewModel.arrCoverSheets.valueHasMutated();\r\n    }\r\n    function OnFailure(sender, args) {}\r\n    currCtx.executeQueryAsync(\r\n      Function.createDelegate(data, OnSuccess),\r\n      Function.createDelegate(data, OnFailure)\r\n    );\r\n  }\r\n\r\n  function LoadTabResponseInfoResponseDocs(oResponse) {\r\n    _myViewModel.arrResponseDocs([]);\r\n    _myViewModel.cntResponseDocs(0);\r\n\r\n    if (oResponse == null || oResponse.responseDocs.length == 0) {\r\n      //an open response is selected and there are no documents\r\n      return;\r\n    }\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    for (var z = 0; z < oResponse.responseDocs.length; z++) {\r\n      var oResponseDoc = oResponse.responseDocs[z];\r\n\r\n      //this loads on execute\r\n      oResponseDoc[\"docIcon\"] = web.mapToIcon(\r\n        oResponseDoc.title,\r\n        \"\",\r\n        SP.Utilities.IconSize.Size16\r\n      );\r\n    }\r\n\r\n    function OnSuccess(sender, args) {\r\n      RenderResponses(oResponse);\r\n    }\r\n    function OnFailure(sender, args) {\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n      SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n    }\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n\r\n    function RenderResponses(oResponse) {\r\n      if (oResponse == null || oResponse.responseDocs == null) return;\r\n\r\n      var arrResponseSummary = new Array();\r\n      for (var z = 0; z < oResponse.responseDocs.length; z++) {\r\n        var oResponseDoc = oResponse.responseDocs[z];\r\n\r\n        oResponseDoc.docIcon = oResponseDoc.docIcon.get_value();\r\n        oResponseDoc.styleTag = Audit.Common.Utilities.GetResponseDocStyleTag2(\r\n          oResponseDoc.documentStatus\r\n        );\r\n        oResponseDoc.link =\r\n          \"STSNavigate('../_layouts/download.aspx?SourceUrl=\" +\r\n          oResponseDoc.folder +\r\n          \"/\" +\r\n          oResponseDoc.title +\r\n          \"')\";\r\n\r\n        var bFound = false;\r\n        for (var b = 0; b < arrResponseSummary.length; b++) {\r\n          if (arrResponseSummary[b].responseTitle == oResponse.title) {\r\n            bFound = true;\r\n            arrResponseSummary[b].responseDocs.push(oResponseDoc);\r\n            break;\r\n          }\r\n        }\r\n        if (!bFound) {\r\n          var oObject = new Object();\r\n\r\n          var arrResponseDocs = new Array();\r\n          arrResponseDocs.push(oResponseDoc);\r\n\r\n          oObject[\"responseTitle\"] = oResponse.title;\r\n          oObject[\"responseDocs\"] = arrResponseDocs;\r\n          oObject[\"response\"] = oResponse;\r\n\r\n          arrResponseSummary.push(oObject);\r\n        }\r\n      }\r\n\r\n      ko.utils.arrayPushAll(_myViewModel.arrResponseDocs(), arrResponseSummary);\r\n      _myViewModel.arrResponseDocs.valueHasMutated();\r\n      _myViewModel.cntResponseDocs(oResponse.responseDocs.length);\r\n\r\n      Audit.Common.Utilities.BindHandlerResponseDoc();\r\n    }\r\n  }\r\n\r\n  function m_fnRefresh() {\r\n    var curPath = location.pathname;\r\n\r\n    var tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n    curPath += \"?Tab=\" + tabIndex;\r\n\r\n    if (tabIndex == 1) {\r\n      var responseNum = $(\"#ddlResponses\").val();\r\n      if (responseNum != \"\") curPath += \"&ResNum=\" + responseNum;\r\n    }\r\n\r\n    location.href = curPath;\r\n  }\r\n\r\n  function BindHandlersOnLoad() {\r\n    BindPrintButton(\r\n      \"#btnPrint1\",\r\n      \"#divStatusReportRespones\",\r\n      \"Special Permissions Response Status Report\"\r\n    );\r\n    //////////Note: for the export to work, make sure this is added to the html: <iframe id=\"CsvExpFrame\" style=\"display: none\"></iframe>\r\n    BindExportButton(\r\n      \".export1\",\r\n      \"SPResponseStatusReport_\",\r\n      \"tblStatusReportResponses\"\r\n    );\r\n  }\r\n\r\n  function BindPrintButton(btnPrint, divTbl, pageTitle) {\r\n    $(btnPrint).on(\"click\", function () {\r\n      Audit.Common.Utilities.PrintStatusReport(pageTitle, divTbl);\r\n    });\r\n  }\r\n\r\n  function BindExportButton(btnExport, fileNamePrefix, tbl) {\r\n    $(btnExport).on(\"click\", function (event) {\r\n      var curDate = new Date().format(\"yyyyMMdd_hhmmtt\");\r\n      Audit.Common.Utilities.ExportToCsv(fileNamePrefix + curDate, tbl);\r\n    });\r\n  }\r\n\r\n  var publicMembers = {\r\n    Load: m_fnLoadData,\r\n    Refresh: m_fnRefresh,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n"],
  "mappings": "MAAC,IAAMA,GAAO,OAAO,IAERC,GAAeD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA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",
  "names": ["html", "spDbTemplate", "InitReport", "m_siteUrl", "m_listTitleRequests", "m_listNameRequests", "m_listTitleRequestsInternal", "m_listNameRequestsInternal", "m_listTitleResponses", "m_listNameResponses", "m_libTitleRequestDocs", "m_libNameRequestDocs", "m_libTitleCoverSheet", "m_libNameCoverSheet", "m_libTitleResponseDocs", "m_libNameResponseDocs", "m_libTitleResponseDocsEA", "m_libNameResponseDocsEA", "m_listTitleActionOffices", "m_listNameActionOffices", "m_listTitleEmailHistory", "m_listNameEmailHistory", "m_listTitleBulkResponses", "m_listNameBulkResponses", "m_listTitleBulkPermissions", "m_listNameBulkPermissions", "m_groupNameSpecialPermName1", "m_groupNameSpecialPermName2", "m_groupNameQA", "m_groupNameEA", "m_libResponseDocsLibraryGUID", "m_arrSiteGroups", "m_arrAOs", "m_fnRefresh", "hard", "curPath", "tabIndex", "responseNumOpen", "responseNumProcessed", "m_fnOnLoadDisplayTimeStamp", "curDate", "m_fnOnLoadDisplayTabAndResponse", "paramTabIndex", "bFiltered", "paramResponseNum", "m_fnOnLoadFilterResponses", "responseStatus1", "responseStatus2", "count", "cntOpen", "cntReOpened", "resStatus1", "resStatus2", "eacher", "reqStatus", "resStatus", "m_fnLoadSiteGroups", "itemColl", "listItemEnumerator", "oListItem", "id", "loginName", "title", "groupObject", "m_fnGetSPSiteGroup", "groupName", "userGroup", "x", "m_fnLoadActionOffices", "aoObject", "m_fnGetAOSPGroupName", "oGroup", "m_fnCheckSPItemHasGroupPermission", "item", "permissionLevel", "match", "roleAssignments", "rolesEnumerator", "role", "roleMember", "memberTitleName", "roleDefs", "roleDefsEnumerator", "rd", "rdName", "m_fnGoToResponse", "responseTitle", "isIA", "bFound", "m_fnGetResponseDocStyleTag2", "documentStatus", "styleTag", "m_fnGetResponseDocStyleTag", "m_fnCheckIfEmailFolderExists", "items", "requestNumber", "bFolderExists", "folderItem", "itemName", "m_cntAddToEmailFolder", "m_cntAddedToEmailFolder", "m_fnCreateEmailFolder", "list", "requestItem", "OnComplete", "currCtx", "web", "itemCreateInfo", "roleDefBindingCollAdmin", "roleDefBindingCollContribute", "roleDefBindingCollRestrictedRead", "roleDefBindingCollRestrictedContribute", "spGroupQA", "onUpdatePermsSucceeded", "arrActionOffice", "actionOfficeName", "actionOfficeGroupName", "actionOfficeGroup", "onUpdateAOPermsSucceeded", "onUpdateAOPermsFailed", "sender", "args", "currCtx2", "web2", "data", "onUpdatePermsFailed", "m_fnSortResponseTitleNoCase", "a", "b", "aTitle", "bTitle", "newA", "newB", "aIndex", "subA", "lastA", "intA", "newIntA", "bIndex", "subB", "lastB", "intB", "newIntB", "m_fnSortResponseObjectNoCase", "m_fnSortNoCase", "m_fnSortDate", "m_fnAddOptions", "arr", "ddlID", "dateSort", "responseSort", "rOptions", "j", "arrLength", "option", "thisDDL", "m_fnExistsInArr", "val", "m_fnGetTrueFalseIcon", "m_fnGetFriendlyDisplayName", "fieldName", "user", "m_fnPadDigits", "n", "totalDigits", "pd", "i", "m_fnPreciseRound", "num", "decimals", "sign", "m_fnGetFriendlyFileSize", "fileSize", "m_fnISODateString", "d", "pad", "m_fnBindHandlerResponseDoc", "event", "curIcon", "m_fnGetLookupFormField", "fieldTitle", "m_fnGetLookupDisplayText", "m_fnSetLookupFromFieldNameByText", "text", "theSelect", "m_fnGetTagFromIdentifierAndTitle", "theInput", "opt", "m_fnSetSelectedOptionByText", "select", "opts", "optLength", "tagName", "identifier", "idLength", "tags", "tagID", "m_fnViewUserManuals", "docType", "options", "m_fnPrintPage", "pageTitle", "divTbl", "siteUrl", "cssLink1", "cssLink2", "divOutput", "updatedDivOutput", "printDateString", "cssFile1", "cssFile2", "def1", "def2", "cssFileText", "html", "printWP", "m_fnExportToCsv", "fileName", "tableName", "removeHeader", "m_fnGetCellValues", "csv", "m_fnConvertToCsv", "uri", "downloadLink", "table", "deets", "tableArray", "r", "c", "m", "objArray", "array", "str", "line", "index", "value", "array1", "publicMembers", "libGUID", "spDbTemplate", "paramShowSiteActionsToAnyone", "InitReport", "divVal", "count", "m_bigMap", "m_arrRequests", "m_arrResponses", "m_requestItems", "m_responseItems", "m_ResponseDocsItems", "statusId", "m_bHasAccessToViewPerms", "target", "option", "newValue", "ViewModel", "self", "fieldName", "types", "item", "ddArr", "response", "oResponse", "LoadTabResponseInfoCoverSheets", "LoadTabResponseInfoResponseDocs", "requestID", "requestStatus", "requestIntDueDate", "sampleNum", "responseName", "responseStatus", "result", "hide", "_myViewModel", "LoadInfo", "currCtx", "web", "m_currentUser", "requestList", "requestQuery", "responseList", "responseQuery", "responseDocsLib", "responseDocsQuery", "OnSuccess", "OnFailure", "sender", "args", "m_requestItemsWithPerms", "OnSuccess2", "m_fnLoadData", "OnFailure2", "LoadRequests", "LoadResponses", "LoadResponseDocs", "LoadTabStatusReport", "OnLoadDisplayTabAndRequest", "paramResponseNum", "paramTabIndex", "cnt", "listItemEnumerator", "oListItem", "id", "number", "status", "sample", "emailSent", "subject", "internalDueDate", "closedDate", "arrActionOffice", "actionOffice", "x", "comments", "relatedAudit", "actionItems", "requestObject", "permissionsToCheck", "match1", "match2", "responseObject", "title", "modified", "responseDocID", "requestNumber", "responseID", "bigMapItem", "indexOfArrResponses", "responseDocObject", "fileSize", "receiptDate", "modifiedDate", "arr", "bLoadTest", "responseArr", "arrLength", "responseTitle", "aResponse", "DoUpdateModel", "arrResponsesToAdd", "subArr", "bContinue", "batchSize", "BindHandlersOnLoad", "coverSheetLib", "coverSheetQuery", "m_subsetCoverSheetItems", "data", "arrCS", "y", "curActionOffice", "csFolder", "csTitle", "encodedTitle", "z", "oResponseDoc", "RenderResponses", "arrResponseSummary", "bFound", "b", "oObject", "arrResponseDocs", "m_fnRefresh", "curPath", "tabIndex", "responseNum", "BindPrintButton", "BindExportButton", "btnPrint", "divTbl", "pageTitle", "btnExport", "fileNamePrefix", "tbl", "event", "curDate", "publicMembers"]
}
