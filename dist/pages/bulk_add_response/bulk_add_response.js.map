{
  "version": 3,
  "sources": ["../../../src/pages/bulk_add_response/BulkAddResponse_Template.js", "../../../src/pages/bulk_add_response/bulk_add_response.js"],
  "sourcesContent": ["\uFEFFconst html = String.raw;\r\n\r\nexport const bulkAddResponseTemplate = html`\r\n  <div class=\"audit\">\r\n    <div id=\"divLoading\" style=\"color: green\">Loading...</div>\r\n    <div id=\"divLoadSettings\" style=\"display: none\">\r\n      <fieldset>\r\n        <legend>\r\n          Add Responses to Request Number:\r\n          <span id=\"divRequestNumber\" style=\"font-weight: bold\"></span>\r\n        </legend>\r\n        <div style=\"padding-top: 10px\">\r\n          <a href=\"javascript:void\" id=\"btnUploadResponses\"\r\n            ><span class=\"ui-icon ui-icon-gear\"></span>Upload Responses to be\r\n            Created</a\r\n          >\r\n        </div>\r\n        <div style=\"padding-top: 10px\">\r\n          <a href=\"javascript:void\" id=\"btnLoadResponses\" style=\"display: none\"\r\n            >Click Here to Display Uploaded Responses</a\r\n          >\r\n        </div>\r\n      </fieldset>\r\n    </div>\r\n    <div id=\"divLoadBulkResponsesOutput\" style=\"padding-top: 15px\"></div>\r\n    <div style=\"padding-top: 15px\">\r\n      <a\r\n        href=\"javascript:void\"\r\n        id=\"btnCreateResponses\"\r\n        style=\"display: none\"\r\n        title=\"Click here to Create the Responses\"\r\n        ><span class=\"ui-icon ui-icon-disk\"></span>Create Responses</a\r\n      >\r\n      <div style=\"padding-top: 15px\">\r\n        <input\r\n          id=\"btnCancel\"\r\n          type=\"button\"\r\n          class=\"ms-ButtonHeightWidth\"\r\n          value=\"Close\"\r\n          title=\"Close\"\r\n          onclick=\"SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.cancel)\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n`;\r\n", "\uFEFFimport { bulkAddResponseTemplate } from \"./BulkAddResponse_Template.js\";\r\nvar Audit = window.Audit || {};\r\nAudit.BulkAddResponse = Audit.BulkAddResponse || {};\r\n\r\nif (document.readyState === \"ready\" || document.readyState === \"complete\") {\r\n  InitBulk();\r\n} else {\r\n  document.onreadystatechange = () => {\r\n    if (document.readyState === \"complete\" || document.readyState === \"ready\") {\r\n      ExecuteOrDelayUntilScriptLoaded(function () {\r\n        SP.SOD.executeFunc(\"sp.js\", \"SP.ClientContext\", InitBulk);\r\n      }, \"sp.js\");\r\n    }\r\n  };\r\n}\r\n\r\nfunction InitBulk() {\r\n  document.getElementById(\"app\").innerHTML = bulkAddResponseTemplate;\r\n\r\n  Audit.BulkAddResponse.Report = new Audit.BulkAddResponse.Load();\r\n  Audit.BulkAddResponse.Init();\r\n}\r\n\r\nAudit.BulkAddResponse.Init = function () {};\r\n\r\nAudit.BulkAddResponse.Load = function () {\r\n  var m_reqNum = GetUrlKeyValue(\"ReqNum\");\r\n\r\n  if (m_reqNum == null || m_reqNum == \"\" || m_reqNum == undefined) {\r\n    var statusId = SP.UI.Status.addStatus(\r\n      \"Error: Request Number was not specified. Please verify the URL Parameters or Launch from the IA Dashboard\"\r\n    );\r\n    SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n\r\n    return;\r\n  }\r\n\r\n  $(\"#divRequestNumber\").text(m_reqNum);\r\n\r\n  var m_oRequest = null;\r\n  var m_arrResponses = new Array();\r\n  var m_arrResponseFolders = new Array();\r\n  var m_arrBulkResponses = new Array();\r\n  var m_listViewId = null;\r\n\r\n  var m_requestItems;\r\n  var m_responseItems;\r\n  var m_ResponseDocsFoldersItems;\r\n  var m_aoItems;\r\n  var m_view;\r\n  var m_groupColl;\r\n\r\n  var m_ownerGroupName = null;\r\n  var m_memberGroupName = null;\r\n  var m_visitorGroupName = null;\r\n\r\n  LoadInfo();\r\n\r\n  function LoadInfo() {\r\n    $(\"#divTblOutput\").html(\"\");\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var requestList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleRequests());\r\n    var requestQuery = new SP.CamlQuery();\r\n    requestQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>'\r\n    );\r\n    m_requestItems = requestList.getItems(requestQuery);\r\n    //request status has internal name as response status in the request list\r\n    currCtx.load(\r\n      m_requestItems,\r\n      \"Include(ID, Title, ReqSubject, ReqStatus, IsSample, ReqDueDate, InternalDueDate, ActionOffice)\"\r\n    );\r\n\r\n    var responseList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleResponses());\r\n    var responseQuery = new SP.CamlQuery();\r\n    responseQuery.set_viewXml(\r\n      '<View Scope=\"RecursiveAll\"><Query><OrderBy><FieldRef Name=\"ReqNum\"/></OrderBy></Query></View>'\r\n    );\r\n    m_responseItems = responseList.getItems(responseQuery);\r\n    currCtx.load(\r\n      m_responseItems,\r\n      \"Include(ID, Title, ReqNum, ActionOffice, SampleNumber)\"\r\n    );\r\n\r\n    var responseDocsLibFolderslist = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetLibTitleResponseDocs());\r\n    var responseDocsLibFolderslistQuery = new SP.CamlQuery();\r\n    responseDocsLibFolderslistQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"Name\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\" /><Value Type=\"Lookup\">1</Value></Eq></Where></Query></View>'\r\n    );\r\n    responseDocsLibFolderslistQuery.set_folderServerRelativeUrl(\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n        \"/\" +\r\n        Audit.Common.Utilities.GetLibNameResponseDocs()\r\n    );\r\n    m_ResponseDocsFoldersItems = responseDocsLibFolderslist.getItems(\r\n      responseDocsLibFolderslistQuery\r\n    );\r\n    currCtx.load(\r\n      m_ResponseDocsFoldersItems,\r\n      \"Include( DisplayName, Id, ContentType)\"\r\n    );\r\n\r\n    var aoList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleActionOffices());\r\n    var aoQuery = new SP.CamlQuery();\r\n    aoQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"Title\"/></OrderBy></Query></View>'\r\n    );\r\n    m_aoItems = aoList.getItems(aoQuery);\r\n    currCtx.load(m_aoItems, \"Include(ID, Title, UserGroup)\");\r\n\r\n    var m_bulkResponsesList = currCtx\r\n      .get_web()\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListNameBulkResponses());\r\n    m_view = m_bulkResponsesList.get_views().getByTitle(\"All Items\");\r\n    currCtx.load(m_view);\r\n    //currCtx.load(m_bulkResponsesList , 'Title', 'Id', 'Views');\r\n\r\n    m_groupColl = web.get_siteGroups();\r\n    currCtx.load(m_groupColl);\r\n\r\n    var ownerGroup = web.get_associatedOwnerGroup();\r\n    var memberGroup = web.get_associatedMemberGroup();\r\n    var visitorGroup = web.get_associatedVisitorGroup();\r\n    currCtx.load(ownerGroup);\r\n    currCtx.load(memberGroup);\r\n    currCtx.load(visitorGroup);\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n    function OnSuccess(sender, args) {\r\n      $(\"#divLoadSettings\").show();\r\n      $(\"#divLoading\").hide();\r\n\r\n      m_listViewId = m_view.get_id();\r\n\r\n      Audit.Common.Utilities.LoadSiteGroups(m_groupColl);\r\n      Audit.Common.Utilities.LoadActionOffices(m_aoItems);\r\n\r\n      m_ownerGroupName = ownerGroup.get_title();\r\n      m_memberGroupName = memberGroup.get_title();\r\n      m_visitorGroupName = visitorGroup.get_title();\r\n\r\n      m_fnLoadRequests();\r\n      if (m_oRequest == null || m_oRequest.number == null) {\r\n        statusId = SP.UI.Status.addStatus(\r\n          \"Error: Request Number does not exist in the Request List. Please verify the URL Parameters and that the Request Number already exists\"\r\n        );\r\n        SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n        $(\"#divLoadSettings\").hide();\r\n\r\n        return;\r\n      }\r\n\r\n      m_fnLoadResponses();\r\n      m_fnLoadResponseFolders();\r\n      m_fnBindHandlersOnLoad();\r\n\r\n      var isModalDlg = GetUrlKeyValue(\"IsDlg\");\r\n      if (isModalDlg == null || isModalDlg == \"\" || isModalDlg == false) {\r\n        $(\"#btnRefresh\").show();\r\n      }\r\n    }\r\n    function OnFailure(sender, args) {\r\n      $(\"#divLoading\").hide();\r\n\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Request failed: \" + args.get_message() + \"\\n\" + args.get_stackTrace()\r\n      );\r\n      SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n    }\r\n  }\r\n\r\n  function m_fnRefresh() {\r\n    var curPath = location.pathname;\r\n\r\n    var tabIndex = $(\"#tabs\").tabs(\"option\", \"active\");\r\n    curPath += \"?Tab=\" + tabIndex;\r\n\r\n    location.href = curPath;\r\n  }\r\n\r\n  function m_fnLoadRequests() {\r\n    var currCtx = SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var listItemEnumerator = m_requestItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var id = oListItem.get_item(\"ID\");\r\n      var number = oListItem.get_item(\"Title\");\r\n      if (number != m_reqNum) continue;\r\n      var status = oListItem.get_item(\"ReqStatus\");\r\n\r\n      var sample = oListItem.get_item(\"IsSample\");\r\n      var arrActionOffice = oListItem.get_item(\"ActionOffice\");\r\n      var actionOffice = \"\";\r\n      for (var x = 0; x < arrActionOffice.length; x++) {\r\n        actionOffice +=\r\n          \"<div>\" + arrActionOffice[x].get_lookupValue() + \"</div>\";\r\n      }\r\n\r\n      var requestObject = new Object();\r\n      requestObject[\"ID\"] = id;\r\n      requestObject[\"number\"] = number;\r\n      requestObject[\"status\"] = status;\r\n      requestObject[\"sample\"] = sample;\r\n      requestObject[\"responses\"] = new Array();\r\n      requestObject[\"actionOffice\"] = actionOffice;\r\n      requestObject[\"item\"] = oListItem;\r\n\r\n      m_oRequest = requestObject;\r\n    }\r\n  }\r\n\r\n  function m_fnLoadResponses() {\r\n    m_arrResponses = new Array();\r\n\r\n    var listItemEnumerator = m_responseItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var number = oListItem.get_item(\"ReqNum\");\r\n      if (number != null) {\r\n        number = number.get_lookupValue();\r\n        if (number != m_reqNum) continue;\r\n\r\n        var responseObject = new Object();\r\n        responseObject[\"ID\"] = oListItem.get_item(\"ID\");\r\n        responseObject[\"number\"] = number;\r\n        responseObject[\"title\"] = oListItem.get_item(\"Title\");\r\n        responseObject[\"item\"] = oListItem;\r\n\r\n        responseObject[\"sample\"] = oListItem.get_item(\"SampleNumber\");\r\n        if (responseObject[\"sample\"] == null) responseObject[\"sample\"] = \"\";\r\n\r\n        responseObject[\"actionOffice\"] = oListItem.get_item(\"ActionOffice\");\r\n        if (responseObject[\"actionOffice\"] == null)\r\n          responseObject[\"actionOffice\"] = \"\";\r\n        else\r\n          responseObject[\"actionOffice\"] =\r\n            responseObject[\"actionOffice\"].get_lookupValue();\r\n\r\n        m_arrResponses.push(responseObject);\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnLoadResponseFolders() {\r\n    var m_arrResponseFolders = new Array();\r\n\r\n    var listItemEnumerator = m_ResponseDocsFoldersItems.getEnumerator();\r\n    while (listItemEnumerator.moveNext()) {\r\n      var oListItem = listItemEnumerator.get_current();\r\n\r\n      var folderName = oListItem.get_displayName();\r\n      for (var x = 0; x < m_arrResponses.length; x++) {\r\n        if (m_arrResponses[x].title == folderName) {\r\n          var responseFolderObject = new Object();\r\n          responseFolderObject[\"title\"] = folderName;\r\n          responseFolderObject[\"response\"] = m_arrResponses[x];\r\n\r\n          m_arrResponseFolders.push(responseFolderObject);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnUploadResponses() {\r\n    var formName = \"DispForm.aspx\";\r\n    var options = SP.UI.$create_DialogOptions();\r\n    options.title = \"Upload Responses (\" + m_reqNum + \")\";\r\n    options.dialogReturnValueCallback = OnCallbackForm;\r\n\r\n    var guid = m_listViewId.toString();\r\n    guid = guid.replace(/-/g, \"%2D\");\r\n    guid = guid.toUpperCase();\r\n    options.url =\r\n      Audit.Common.Utilities.GetSiteUrl() +\r\n      \"/Lists/\" +\r\n      Audit.Common.Utilities.GetListNameBulkResponses() +\r\n      \"/AllItems.aspx\" +\r\n      \"?ShowInGrid=True&View=%7B\" +\r\n      guid +\r\n      \"%7D\";\r\n    options.height = 700;\r\n    SP.UI.ModalDialog.showModalDialog(options);\r\n  }\r\n\r\n  var validation = {\r\n    isNotEmpty: function (str) {\r\n      var pattern = /\\S+/;\r\n      return pattern.test(str); // returns a boolean\r\n    },\r\n    isNumber: function (str) {\r\n      var pattern = /^\\d+$/;\r\n      return pattern.test(str); // returns a boolean\r\n    },\r\n  };\r\n\r\n  function m_fnLoadBulkResponses() {\r\n    m_arrBulkResponses = new Array();\r\n\r\n    var currCtx = new SP.ClientContext.get_current();\r\n    var web = currCtx.get_web();\r\n\r\n    var bulkResponesList = web\r\n      .get_lists()\r\n      .getByTitle(Audit.Common.Utilities.GetListTitleBulkResponses());\r\n    var bulkResponseQuery = new SP.CamlQuery();\r\n    bulkResponseQuery.set_viewXml(\r\n      '<View><Query><OrderBy><FieldRef Name=\"ID\"/></OrderBy></Query></View>'\r\n    );\r\n    var bulkResponseItems = bulkResponesList.getItems(bulkResponseQuery);\r\n    currCtx.load(\r\n      bulkResponseItems,\r\n      \"Include(ID, Title, ActionOffice, Comments, POC, POCCC)\"\r\n    );\r\n\r\n    function OnSuccess(sender, args) {\r\n      var listItemEnumerator = bulkResponseItems.getEnumerator();\r\n      while (listItemEnumerator.moveNext()) {\r\n        var oListItem = listItemEnumerator.get_current();\r\n\r\n        var id = oListItem.get_item(\"ID\");\r\n        var sampleNumber = oListItem.get_item(\"Title\");\r\n        var actionOffice = oListItem.get_item(\"ActionOffice\").get_lookupValue();\r\n        var comments = oListItem.get_item(\"Comments\");\r\n        if (comments == null) comments = \"\";\r\n\r\n        var bulkResponseObject = new Object();\r\n        bulkResponseObject[\"ID\"] = id;\r\n        bulkResponseObject[\"sampleNumber\"] = sampleNumber;\r\n        bulkResponseObject[\"actionOffice\"] = actionOffice;\r\n        bulkResponseObject[\"comments\"] = comments;\r\n        var newResponseTitle =\r\n          m_reqNum + \"-\" + actionOffice + \"-\" + sampleNumber;\r\n        bulkResponseObject[\"responseTitle\"] = newResponseTitle;\r\n        bulkResponseObject[\"item\"] = oListItem;\r\n\r\n        if (actionOffice && actionOffice.toLowerCase().indexOf(\"fpra\") < 0) {\r\n          bulkResponseObject[\"poc\"] = \"\";\r\n          bulkResponseObject[\"poccc\"] = \"\";\r\n          bulkResponseObject[\"pocID\"] = \"\";\r\n          bulkResponseObject[\"pocccID\"] = \"\";\r\n        } else {\r\n          bulkResponseObject[\"poc\"] = \"\";\r\n          bulkResponseObject[\"poccc\"] = \"\";\r\n          bulkResponseObject[\"pocID\"] = \"\";\r\n          bulkResponseObject[\"pocccID\"] = \"\";\r\n\r\n          if (\r\n            oListItem.get_item(\"POC\") != null &&\r\n            oListItem.get_item(\"POC\").get_lookupValue() != null\r\n          ) {\r\n            bulkResponseObject[\"poc\"] = oListItem\r\n              .get_item(\"POC\")\r\n              .get_lookupValue();\r\n            bulkResponseObject[\"pocID\"] = oListItem\r\n              .get_item(\"POC\")\r\n              .get_lookupId();\r\n          }\r\n\r\n          if (\r\n            oListItem.get_item(\"POCCC\") != null &&\r\n            oListItem.get_item(\"POCCC\").get_lookupValue() != null\r\n          ) {\r\n            bulkResponseObject[\"poccc\"] = oListItem\r\n              .get_item(\"POCCC\")\r\n              .get_lookupValue();\r\n            bulkResponseObject[\"pocccID\"] = oListItem\r\n              .get_item(\"POCCC\")\r\n              .get_lookupId();\r\n          }\r\n        }\r\n\r\n        var bIsValid = true;\r\n        var sInvalidReason = null;\r\n\r\n        if (\r\n          !validation.isNotEmpty(sampleNumber) ||\r\n          !validation.isNumber(sampleNumber)\r\n        ) {\r\n          bIsValid = false;\r\n          sInvalidReason = \"Invalid sample number\";\r\n        }\r\n        if (bIsValid) {\r\n          for (var x = 0; x < m_arrResponses.length; x++) {\r\n            if (m_arrResponses[x].title == newResponseTitle) {\r\n              bIsValid = false;\r\n              sInvalidReason = \"Response with this name exists\";\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (bIsValid) {\r\n          for (var x = 0; x < m_arrResponseFolders.length; x++) {\r\n            if (m_arrResponseFolders[x].title == newResponseTitle) {\r\n              bIsValid = false;\r\n              sInvalidReason = \"Response Folder with this name exists\";\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (bIsValid) {\r\n          var bFound = false;\r\n          for (\r\n            var x = 0;\r\n            x < Audit.Common.Utilities.GetActionOffices().length;\r\n            x++\r\n          ) {\r\n            if (\r\n              Audit.Common.Utilities.GetActionOffices()[x].title == actionOffice\r\n            ) {\r\n              bulkResponseObject[\"actionOfficeID\"] =\r\n                Audit.Common.Utilities.GetActionOffices()[x].ID;\r\n              bFound = true;\r\n            }\r\n          }\r\n          if (!bFound) {\r\n            bIsValid = false;\r\n            sInvalidReason = \"Action Office not found\";\r\n          }\r\n        }\r\n\r\n        bulkResponseObject[\"isValid\"] = bIsValid;\r\n        bulkResponseObject[\"invalidReason\"] = sInvalidReason;\r\n        m_arrBulkResponses.push(bulkResponseObject);\r\n      }\r\n\r\n      var hasOneValid = false;\r\n\r\n      m_arrBulkResponses.sort(function (a, b) {\r\n        a = parseInt(a.sampleNumber, 10);\r\n        b = parseInt(b.sampleNumber, 10);\r\n        return a - b;\r\n      });\r\n\r\n      var output =\r\n        \"<table class='tablesorter report'><tr><thead><th>Request Number</th><th>Action Office</th><th>Sample Number</th><th>Response Title</th><th>Comments</th><th>POC</th><th>POC CC</th></thead></tr>\";\r\n      for (var x = 0; x < m_arrBulkResponses.length; x++) {\r\n        var oBulkItem = m_arrBulkResponses[x];\r\n        if (oBulkItem.isValid) {\r\n          output +=\r\n            \"<tr id='tableRow\" +\r\n            x +\r\n            \"'><td id='tdReq\" +\r\n            x +\r\n            \"'>\" +\r\n            m_reqNum +\r\n            \"</td><td>\" +\r\n            oBulkItem.actionOffice +\r\n            \"</td><td>\" +\r\n            oBulkItem.sampleNumber +\r\n            \"</td><td>\" +\r\n            oBulkItem.responseTitle +\r\n            \"</td><td>\" +\r\n            oBulkItem.comments +\r\n            \"</td><td>\" +\r\n            oBulkItem.poc +\r\n            \"</td><td>\" +\r\n            oBulkItem.poccc +\r\n            \"</td></tr>\";\r\n          hasOneValid = true;\r\n        } else {\r\n          output +=\r\n            \"<tr style='background-color:lightsalmon; font-style:italic;' title='\" +\r\n            oBulkItem.invalidReason +\r\n            \"'><td>\" +\r\n            m_reqNum +\r\n            \"</td><td>\" +\r\n            oBulkItem.actionOffice +\r\n            \"</td><td>\" +\r\n            oBulkItem.sampleNumber +\r\n            \"</td><td>\" +\r\n            oBulkItem.responseTitle +\r\n            \" - \" +\r\n            oBulkItem.invalidReason +\r\n            \"</td><td>\" +\r\n            oBulkItem.comments +\r\n            \"</td><td>\" +\r\n            oBulkItem.poc +\r\n            \"</td><td>\" +\r\n            oBulkItem.poccc +\r\n            \"</td></tr>\";\r\n        }\r\n      }\r\n      $(\"#divLoadBulkResponsesOutput\").html(\r\n        (output +=\r\n          \"<tfoot><tr><th colspan='7'>Total: \" +\r\n          m_arrBulkResponses.length +\r\n          \"</tr></tfoot></table>\")\r\n      );\r\n\r\n      if (m_arrBulkResponses.length == 0) {\r\n        $(\"#divLoadBulkResponsesOutput\").html(\"\");\r\n      }\r\n\r\n      if (hasOneValid) {\r\n        $(\"#btnCreateResponses\").show().focus();\r\n      } else {\r\n        $(\"#btnCreateResponses\").hide();\r\n      }\r\n    }\r\n    function OnFailure(sender, args) {\r\n      statusId = SP.UI.Status.addStatus(\r\n        \"Unable to load from the Bulk Response List: \" +\r\n          args.get_message() +\r\n          \"\\n\" +\r\n          args.get_stackTrace()\r\n      );\r\n      SP.UI.Status.setStatusPriColor(statusId, \"red\");\r\n    }\r\n\r\n    currCtx.executeQueryAsync(OnSuccess, OnFailure);\r\n  }\r\n\r\n  var m_countToCreate = 0;\r\n  var m_countCreated = 0;\r\n  var m_waitDialog = null;\r\n  var m_bCreateRequestFolder = true;\r\n  function m_fnCreateResponses() {\r\n    m_bCreateRequestFolder = true;\r\n\r\n    if (confirm(\"Are you sure you would like to Create the Responses?\")) {\r\n      $(\"#btnUploadResponses\").hide();\r\n      $(\"#btnCreateResponses\").hide();\r\n      $(\"#divLoadSettings\").hide();\r\n      $(\"#btnCancel\").hide();\r\n\r\n      document.body.style.cursor = \"wait\";\r\n\r\n      if (\r\n        window.parent != null &&\r\n        window.parent.document.getElementById(\"divRanBulkUpdate\") != null\r\n      )\r\n        window.parent.document.getElementById(\"divRanBulkUpdate\").innerText = 1;\r\n\r\n      m_waitDialog = SP.UI.ModalDialog.showWaitScreenWithNoClose(\r\n        \"Creating Responses\",\r\n        \"Please wait... Creating Responses\",\r\n        200,\r\n        400\r\n      );\r\n\r\n      for (var x = 0; x < m_arrBulkResponses.length; x++) {\r\n        var oBulkItem = m_arrBulkResponses[x];\r\n        if (oBulkItem.isValid) {\r\n          m_countToCreate++;\r\n\r\n          var currCtx = new SP.ClientContext.get_current();\r\n          var currentUser = currCtx.get_web().get_currentUser();\r\n          var ownerGroup = currCtx.get_web().get_associatedOwnerGroup();\r\n          var memberGroup = currCtx.get_web().get_associatedMemberGroup();\r\n          var visitorGroup = currCtx.get_web().get_associatedVisitorGroup();\r\n\r\n          var responseTitle = oBulkItem.responseTitle;\r\n\r\n          /************************/\r\n          //Create item in response list\r\n          var responseList = currCtx\r\n            .get_web()\r\n            .get_lists()\r\n            .getByTitle(Audit.Common.Utilities.GetListTitleResponses());\r\n          var itemCreateInfo = new SP.ListItemCreationInformation();\r\n          var oListItem = responseList.addItem(itemCreateInfo);\r\n          oListItem.set_item(\"Title\", responseTitle);\r\n          oListItem.set_item(\"ReqNum\", m_oRequest.ID);\r\n          oListItem.set_item(\"SampleNumber\", oBulkItem.sampleNumber);\r\n          oListItem.set_item(\"ActionOffice\", oBulkItem.actionOfficeID);\r\n\r\n          if (oBulkItem.poc != \"\") {\r\n            var assignedToVal = new SP.FieldUserValue();\r\n            assignedToVal.set_lookupId(oBulkItem.pocID); //specify User Id\r\n            oListItem.set_item(\"POC\", assignedToVal);\r\n          }\r\n\r\n          if (oBulkItem.poccc != \"\") {\r\n            var assignedToVal = new SP.FieldUserValue();\r\n            assignedToVal.set_lookupId(oBulkItem.pocccID); //specify User Id\r\n            oListItem.set_item(\"POCCC\", assignedToVal);\r\n          }\r\n\r\n          oListItem.update();\r\n\r\n          oListItem.breakRoleInheritance(false, false);\r\n\r\n          var roleDefBindingCollAdmin =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingCollAdmin.add(\r\n            currCtx\r\n              .get_web()\r\n              .get_roleDefinitions()\r\n              .getByType(SP.RoleType.administrator)\r\n          );\r\n\r\n          var roleDefBindingCollContribute =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingCollContribute.add(\r\n            currCtx\r\n              .get_web()\r\n              .get_roleDefinitions()\r\n              .getByType(SP.RoleType.contributor)\r\n          );\r\n\r\n          var roleDefBindingCollRestrictedRead =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingCollRestrictedRead.add(\r\n            currCtx.get_web().get_roleDefinitions().getByName(\"Restricted Read\")\r\n          );\r\n\r\n          var roleDefBindingCollRestrictedContribute =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingCollRestrictedContribute.add(\r\n            currCtx\r\n              .get_web()\r\n              .get_roleDefinitions()\r\n              .getByName(\"Restricted Contribute\")\r\n          );\r\n\r\n          //add owner group\r\n          oListItem\r\n            .get_roleAssignments()\r\n            .add(ownerGroup, roleDefBindingCollAdmin);\r\n\r\n          //add member group\r\n          oListItem\r\n            .get_roleAssignments()\r\n            .add(memberGroup, roleDefBindingCollContribute);\r\n\r\n          //add visitor group\r\n          oListItem\r\n            .get_roleAssignments()\r\n            .add(visitorGroup, roleDefBindingCollRestrictedRead);\r\n\r\n          //add action offices\r\n          var actionOffice = oListItem.get_item(\"ActionOffice\");\r\n          if (actionOffice != null) {\r\n            var actionOfficeName = oBulkItem.actionOffice; //actionOffice.get_lookupValue();\r\n            var actionOfficeGroupName =\r\n              Audit.Common.Utilities.GetAOSPGroupName(actionOfficeName);\r\n            var actionOfficeGroup = Audit.Common.Utilities.GetSPSiteGroup(\r\n              actionOfficeGroupName\r\n            );\r\n\r\n            if (actionOfficeGroup != null) {\r\n              oListItem\r\n                .get_roleAssignments()\r\n                .add(actionOfficeGroup, roleDefBindingCollRestrictedContribute);\r\n            } else return;\r\n          }\r\n          oListItem\r\n            .get_roleAssignments()\r\n            .getByPrincipal(currentUser)\r\n            .deleteObject();\r\n\r\n          /************************/\r\n          //Create response folder\r\n          var responseDocLib = currCtx\r\n            .get_web()\r\n            .get_lists()\r\n            .getByTitle(Audit.Common.Utilities.GetLibTitleResponseDocs());\r\n          var itemCreateInfo = new SP.ListItemCreationInformation();\r\n          itemCreateInfo.set_underlyingObjectType(\r\n            SP.FileSystemObjectType.folder\r\n          );\r\n          itemCreateInfo.set_leafName(responseTitle);\r\n          var oListFolderItem = responseDocLib.addItem(itemCreateInfo);\r\n          oListFolderItem.set_item(\"Title\", responseTitle);\r\n          oListFolderItem.update();\r\n\r\n          oListFolderItem.breakRoleInheritance(false, false);\r\n\r\n          //add owner group\r\n          var roleDefBindingColl =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingColl.add(\r\n            currCtx\r\n              .get_web()\r\n              .get_roleDefinitions()\r\n              .getByType(SP.RoleType.administrator)\r\n          );\r\n          oListFolderItem\r\n            .get_roleAssignments()\r\n            .add(ownerGroup, roleDefBindingColl);\r\n\r\n          //add member group\r\n          var roleDefBindingColl2 =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingColl2.add(\r\n            currCtx\r\n              .get_web()\r\n              .get_roleDefinitions()\r\n              .getByType(SP.RoleType.contributor)\r\n          );\r\n          oListFolderItem\r\n            .get_roleAssignments()\r\n            .add(memberGroup, roleDefBindingColl2);\r\n\r\n          //add visitor group\r\n          var roleDefBindingColl3 =\r\n            SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n          roleDefBindingColl3.add(\r\n            currCtx.get_web().get_roleDefinitions().getByName(\"Restricted Read\")\r\n          );\r\n          oListFolderItem\r\n            .get_roleAssignments()\r\n            .add(visitorGroup, roleDefBindingColl3);\r\n\r\n          //add action office\r\n          var actionOfficeGroupName = Audit.Common.Utilities.GetAOSPGroupName(\r\n            oBulkItem.actionOffice\r\n          );\r\n          var actionOfficeGroupObj = Audit.Common.Utilities.GetSPSiteGroup(\r\n            actionOfficeGroupName\r\n          );\r\n          if (actionOfficeGroupObj != null) {\r\n            var roleDefBindingColl4 =\r\n              SP.RoleDefinitionBindingCollection.newObject(currCtx);\r\n            roleDefBindingColl4.add(\r\n              currCtx\r\n                .get_web()\r\n                .get_roleDefinitions()\r\n                .getByName(\"Restricted Contribute\")\r\n            );\r\n            oListFolderItem\r\n              .get_roleAssignments()\r\n              .add(actionOfficeGroupObj, roleDefBindingColl4);\r\n          }\r\n\r\n          //delete current logged in user from permissions because it gets added by default\r\n          oListFolderItem\r\n            .get_roleAssignments()\r\n            .getByPrincipal(currentUser)\r\n            .deleteObject();\r\n\r\n          var emailList = currCtx\r\n            .get_web()\r\n            .get_lists()\r\n            .getByTitle(Audit.Common.Utilities.GetListTitleEmailHistory());\r\n          var emailListQuery = new SP.CamlQuery();\r\n          emailListQuery.set_viewXml(\r\n            '<View><Query><OrderBy><FieldRef Name=\"ID\"/></OrderBy><Where><Eq><FieldRef Name=\"FSObjType\"/><Value Type=\"Text\">1</Value></Eq></Where></Query></View>'\r\n          );\r\n          var emailListFolderItems = emailList.getItems(emailListQuery);\r\n          currCtx.load(\r\n            emailListFolderItems,\r\n            \"Include(ID, FSObjType, Title, DisplayName)\"\r\n          );\r\n\r\n          function OnSuccess(sender, args) {\r\n            if (m_bCreateRequestFolder) {\r\n              if (\r\n                !Audit.Common.Utilities.CheckIfEmailFolderExists(\r\n                  this.emailListFolderItems,\r\n                  this.requestNumber\r\n                )\r\n              ) {\r\n                Audit.Common.Utilities.CreateEmailFolder(\r\n                  this.emailList,\r\n                  this.requestNumber\r\n                );\r\n              }\r\n              m_bCreateRequestFolder = false;\r\n            }\r\n\r\n            $(\"#tableRow\" + this.tableRowId).attr(\r\n              \"style\",\r\n              \"background-color:palegreen\"\r\n            );\r\n            $(\"#tableRow\" + this.tableRowId).attr(\"title\", \"Created\");\r\n            $(\"#tdReq\" + this.tableRowId).html(\r\n              \"<span class='ui-icon ui-icon-check'></span> \" +\r\n                $(\"#tdReq\" + this.tableRowId).text()\r\n            );\r\n\r\n            var currCtx2 = new SP.ClientContext.get_current();\r\n            var itemId = m_arrBulkResponses[this.tableRowId].ID;\r\n            if (itemId != null && itemId >= 0) {\r\n              //console.log( itemId );\r\n              var targetList = currCtx2\r\n                .get_web()\r\n                .get_lists()\r\n                .getByTitle(Audit.Common.Utilities.GetListTitleBulkResponses());\r\n              var targetListItem = targetList.getItemById(itemId);\r\n              targetListItem.deleteObject();\r\n            }\r\n\r\n            //$(\"#divCntrResponses\").text( m_countCreated + \" of \" + m_countToCreate + \" Responses created\");\r\n\r\n            currCtx2.executeQueryAsync(\r\n              function () {\r\n                m_countCreated++;\r\n                if (m_countToCreate == m_countCreated) {\r\n                  document.body.style.cursor = \"default\";\r\n                  m_waitDialog.close();\r\n                  var notifyId = SP.UI.Notify.addNotification(\r\n                    \"Completed\",\r\n                    false\r\n                  );\r\n                  $(\"#btnCancel\").show();\r\n                }\r\n              },\r\n              function () {\r\n                //alert.log(\"Request failed: \"  + args.get_message() + \"\\n\" + args.get_stackTrace());\r\n\r\n                m_countCreated++;\r\n                if (m_countToCreate == m_countCreated) {\r\n                  document.body.style.cursor = \"default\";\r\n                  m_waitDialog.close();\r\n                  var notifyId = SP.UI.Notify.addNotification(\r\n                    \"Completed\",\r\n                    false\r\n                  );\r\n                  $(\"#btnCancel\").show();\r\n                }\r\n              }\r\n            );\r\n          }\r\n          function OnFailure(sender, args) {\r\n            $(\"#tableRow\" + this.tableRowId).attr(\r\n              \"style\",\r\n              \"background-color:salmon\"\r\n            );\r\n            $(\"#tableRow\" + this.tableRowId).attr(\"title\", args.get_message());\r\n\r\n            //statusId = SP.UI.Status.addStatus(\"Unable to : \"  + args.get_message() + \"\\n\" + args.get_stackTrace());\r\n            m_countCreated++;\r\n            if (m_countToCreate == m_countCreated) {\r\n              document.body.style.cursor = \"default\";\r\n              m_waitDialog.close();\r\n              notifyId = SP.UI.Notify.addNotification(\"Completed\", false);\r\n              $(\"#btnCancel\").show();\r\n            }\r\n          }\r\n\r\n          var data = {\r\n            responseTitle: responseTitle,\r\n            requestNumber: m_oRequest.number,\r\n            tableRowId: x,\r\n            emailList: emailList,\r\n            emailListFolderItems: emailListFolderItems,\r\n          };\r\n          currCtx.executeQueryAsync(\r\n            Function.createDelegate(data, OnSuccess),\r\n            Function.createDelegate(data, OnFailure)\r\n          );\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function m_fnBindHandlersOnLoad() {\r\n    $(\"#btnUploadResponses\").click(function () {\r\n      m_fnUploadResponses();\r\n    });\r\n    $(\"#btnLoadResponses\").click(function () {\r\n      m_fnLoadBulkResponses();\r\n    });\r\n    $(\"#btnCreateResponses\").click(function () {\r\n      m_fnCreateResponses();\r\n    });\r\n  }\r\n\r\n  function OnCallbackForm(result, value) {\r\n    m_fnLoadBulkResponses();\r\n  }\r\n\r\n  var publicMembers = {\r\n    Refresh: m_fnRefresh,\r\n  };\r\n\r\n  return publicMembers;\r\n};\r\n"],
  "mappings": "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",
  "names": ["html", "bulkAddResponseTemplate", "Audit", "InitBulk", "bulkAddResponseTemplate", "m_reqNum", "statusId", "m_oRequest", "m_arrResponses", "m_arrResponseFolders", "m_arrBulkResponses", "m_listViewId", "m_requestItems", "m_responseItems", "m_ResponseDocsFoldersItems", "m_aoItems", "m_view", "m_groupColl", "m_ownerGroupName", "m_memberGroupName", "m_visitorGroupName", "LoadInfo", "currCtx", "web", "requestList", "requestQuery", "responseList", "responseQuery", "responseDocsLibFolderslist", "responseDocsLibFolderslistQuery", "aoList", "aoQuery", "m_bulkResponsesList", "ownerGroup", "memberGroup", "visitorGroup", "OnSuccess", "OnFailure", "sender", "args", "m_fnLoadRequests", "m_fnLoadResponses", "m_fnLoadResponseFolders", "m_fnBindHandlersOnLoad", "isModalDlg", "m_fnRefresh", "curPath", "tabIndex", "listItemEnumerator", "oListItem", "id", "number", "status", "sample", "arrActionOffice", "actionOffice", "x", "requestObject", "responseObject", "folderName", "responseFolderObject", "m_fnUploadResponses", "formName", "options", "OnCallbackForm", "guid", "validation", "str", "pattern", "m_fnLoadBulkResponses", "bulkResponesList", "bulkResponseQuery", "bulkResponseItems", "sampleNumber", "comments", "bulkResponseObject", "newResponseTitle", "bIsValid", "sInvalidReason", "bFound", "hasOneValid", "a", "b", "output", "oBulkItem", "m_countToCreate", "m_countCreated", "m_waitDialog", "m_bCreateRequestFolder", "m_fnCreateResponses", "currCtx2", "itemId", "targetList", "targetListItem", "notifyId", "currentUser", "responseTitle", "itemCreateInfo", "assignedToVal", "roleDefBindingCollAdmin", "roleDefBindingCollContribute", "roleDefBindingCollRestrictedRead", "roleDefBindingCollRestrictedContribute", "actionOfficeName", "actionOfficeGroupName", "actionOfficeGroup", "responseDocLib", "oListFolderItem", "roleDefBindingColl", "roleDefBindingColl2", "roleDefBindingColl3", "actionOfficeGroupObj", "roleDefBindingColl4", "emailList", "emailListQuery", "emailListFolderItems", "data", "result", "value", "publicMembers"]
}
